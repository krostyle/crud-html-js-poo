/*! For license information please see index.8e56dc34f1da7ecf7f60.js.LICENSE.txt */
(()=>{var t={99:(t,e,n)=>{"use strict";n.d(e,{Z:()=>w});var r,i,o=n(655),a=n(589),s=n(909),u=n(594),c=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),h=new a.LL("app","Firebase",c),l="@firebase/app",f="[DEFAULT]",d=((i={})[l]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),p=new u.Yd("@firebase/app"),v=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=(0,a.p$)(t),this.container=new s.H0(e.name),this._addComponent(new s.wA("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){return void 0===e&&(e=f),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=f),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){p.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw h.create("app-deleted",{appName:this.name_})},t}();v.prototype.name&&v.prototype.options||v.prototype.delete||console.log("dc");var g=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name=f);var s=o.name;if("string"!=typeof s||!s)throw h.create("bad-app-name",{appName:String(s)});if((0,a.r3)(e,s))throw h.create("duplicate-app",{appName:s});var u=new t(n,o,r);return e[s]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=d[t])&&void 0!==r?r:t;n&&(i+="-"+n);var a=i.match(/\s|\//),u=e.match(/\s|\//);if(a||u){var c=['Unable to register library "'+i+'" with version "'+e+'":'];return a&&c.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),a&&u&&c.push("and"),u&&c.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void p.warn(c.join(" "))}o(new s.wA(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:u.Ub,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw h.create("invalid-log-argument");(0,u.Am)(t,e)},apps:null,SDK_VERSION:"8.4.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(t=t||f,!(0,a.r3)(e,t))throw h.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return p.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var u=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw h.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&(0,a.ZB)(u,o.serviceProps),r[s]=u,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,s).apply(this,o.multipleInstances?t:[])}}for(var c=0,l=Object.keys(e);c<l.length;c++){var f=l[c];e[f]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(v);return e.INTERNAL=(0,o.pi)((0,o.pi)({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){(0,a.ZB)(e,t)},createSubscribe:a.ne,ErrorFactory:a.LL,deepExtend:a.ZB}),e}(),m=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if((0,a.jU)()&&void 0!==self.firebase){p.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var y=self.firebase.SDK_VERSION;y&&y.indexOf("LITE")>=0&&p.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var b=g.initializeApp;g.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,a.UG)()&&p.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),b.apply(void 0,t)};var _=g;!function(t,e){t.INTERNAL.registerComponent(new s.wA("platform-logger",(function(t){return new m(t)}),"PRIVATE")),t.registerVersion(l,"0.6.20",void 0),t.registerVersion("fire-js","")}(_);const w=_},909:(t,e,n)=>{"use strict";n.d(e,{wA:()=>o,H0:()=>u,zt:()=>s});var r=n(655),i=n(589),o=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),a="[DEFAULT]",s=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=a);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.BH;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=(0,r.pi)({identifier:a,optional:!1},t),n=e.identifier,i=e.optional,o=this.normalizeInstanceIdentifier(n);if(!this.isInitialized(o)&&!this.shouldAutoInitialize()){if(i)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:o})}catch(t){if(i)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:a})}catch(t){}try{for(var i=(0,r.XA)(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var s=(0,r.CR)(o.value,2),u=s[0],c=s[1],h=this.normalizeInstanceIdentifier(u);try{var l=this.getOrInitializeService({instanceIdentifier:h});c.resolve(l)}catch(t){}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=a),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return(0,r.mG)(this,void 0,void 0,(function(){var t;return(0,r.Jh)(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all((0,r.ev)((0,r.ev)([],(0,r.CR)(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),(0,r.CR)(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=a),this.instances.has(t)},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var i=t.instanceIdentifier,o=void 0===i?a:i,s=t.options,u=void 0===s?{}:s,c=this.normalizeInstanceIdentifier(o);if(this.isInitialized(c))throw Error(this.name+"("+c+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var h=this.getOrInitializeService({instanceIdentifier:c,options:u});try{for(var l=(0,r.XA)(this.instancesDeferred.entries()),f=l.next();!f.done;f=l.next()){var d=(0,r.CR)(f.value,2),p=d[0],v=d[1];c===this.normalizeInstanceIdentifier(p)&&v.resolve(h)}}catch(t){e={error:t}}finally{try{f&&!f.done&&(n=l.return)&&n.call(l)}finally{if(e)throw e.error}}return h},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===a?void 0:e),options:i}),this.instances.set(n,o),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:a:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}(),u=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new s(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},446:(t,e,n)=>{"use strict";var r=n(99),i=n(909),o=n(589),a=n(655),s=n(594);t=n.hmd(t);var u,c=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),(0,o.Pz)(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:(0,o.cI)(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),h=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return(0,o.r3)(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),l=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new c(e)}}catch(t){}return new h},f=l("localStorage"),d=l("sessionStorage"),p=new s.Yd("@firebase/database"),v=(u=1,function(){return u++}),g=function(t){var e=(0,o.dS)(t),n=new o.gQ;n.update(e);var r=n.digest();return o.US.encodeByteArray(r)},m=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++){var i=t[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=m.apply(null,i):n+="object"==typeof i?(0,o.Pz)(i):i,n+=" "}return n},y=null,b=!0,_=function(t,e){(0,o.hu)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(p.logLevel=s.in.VERBOSE,y=p.log.bind(p),e&&d.set("logging_enabled",!0)):"function"==typeof t?y=t:(y=null,d.remove("logging_enabled"))},w=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===b&&(b=!1,null===y&&!0===d.get("logging_enabled")&&_(!0)),y){var n=m.apply(null,t);y(n)}},I=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];w.apply(void 0,(0,a.ev)([t],(0,a.CR)(e)))}},T=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+m.apply(void 0,(0,a.ev)([],(0,a.CR)(t)));p.error(n)},E=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+m.apply(void 0,(0,a.ev)([],(0,a.CR)(t)));throw p.error(n),new Error(n)},S=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+m.apply(void 0,(0,a.ev)([],(0,a.CR)(t)));p.warn(n)},C=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},k="[MIN_NAME]",N="[MAX_NAME]",A=function(t,e){if(t===e)return 0;if(t===k||e===N)return-1;if(e===k||t===N)return 1;var n=F(t),r=F(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},D=function(t,e){return t===e?0:t<e?-1:1},P=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,o.Pz)(e))},R=function(t){if("object"!=typeof t||null===t)return(0,o.Pz)(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=(0,o.Pz)(e[i]),r+=":",r+=R(t[e[i]]);return r+"}"},O=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function x(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var L=function(t){(0,o.hu)(!C(t),"Invalid JSON number");var e,n,r,i,a;0===t?(n=0,r=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074))));var s=[];for(a=52;a;a-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(e?1:0),s.reverse();var u=s.join(""),c="";for(a=0;a<64;a+=8){var h=parseInt(u.substr(a,8),2).toString(16);1===h.length&&(h="0"+h),c+=h}return c.toLowerCase()},M=new RegExp("^-?(0*)\\d{1,10}$"),F=function(t){if(M.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},U=function(t){try{t()}catch(t){setTimeout((function(){var e=t.stack||"";throw S("Exception was thrown by user callback.",e),t}),Math.floor(0))}},q=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},j=function(){function t(t,e,n){var r=this;this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.get().then((function(t){return r.auth_=t}))}return t.prototype.getToken=function(t){return this.auth_?this.auth_.getToken(t).catch((function(t){return t&&"auth/token-not-initialized"===t.code?(w("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})):Promise.resolve(null)},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):(setTimeout((function(){return t(null)}),0),this.authProvider_.get().then((function(e){return e.addAuthTokenListener(t)})))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then((function(e){return e.removeAuthTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',S(t)},t}(),V=function(){function t(){}return t.prototype.getToken=function(e){return Promise.resolve({accessToken:t.EMULATOR_AUTH_TOKEN})},t.prototype.addTokenChangeListener=function(e){e(t.EMULATOR_AUTH_TOKEN)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.EMULATOR_AUTH_TOKEN="owner",t}(),B=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,G="websocket",K="long_polling",W=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=f.get("host:"+t)||this._host}return t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&f.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){var t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+t+this.host+"/"+e},t}();function H(t,e,n){var r;if((0,o.hu)("string"==typeof e,"typeof type must == string"),(0,o.hu)("object"==typeof n,"typeof params must == object"),e===G)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==K)throw new Error("Unknown connection type: "+e);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);var i=[];return x(n,(function(t,e){i.push(t+"="+e)})),r+i.join("&")}var z=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),(0,o.r3)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return(0,o.p$)(this.counters_)},t}(),J={},Q={};function Y(t){var e=t.toString();return J[e]||(J[e]=new z),J[e]}var X=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&U((function(){n.onMessage_(t[e])}))},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==r(););},t}(),Z="start",$="close",tt=function(){function t(t,e,n,r,i){this.connId=t,this.repoInfo=e,this.applicationId=n,this.transportSessionId=r,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=I(t),this.stats_=Y(e),this.urlFn=function(t){return H(e,K,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new X(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if((0,o.Yr)()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new et((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=(0,a.CR)(t,5),i=r[0],o=r[1],s=r[2];if(r[3],r[4],n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===Z)n.id=o,n.password=s;else{if(i!==$)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=(0,a.CR)(t,2),i=r[0],o=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,o)}),(function(){n.onClosed_()}),n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),"undefined"!=typeof location&&location.hostname&&B.test(location.hostname)&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!((0,o.Yr)()||!t.forceAllow_&&(t.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=(0,o.Pz)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=(0,o.h$)(e),r=O(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!(0,o.Yr)()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=(0,o.Pz)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),et=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,o.Yr)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=v(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(a='<script>document.domain="'+document.domain+'";<\/script>');var s="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(t){w("frame writing exception"),t.stack&&w(t.stack),w(t)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||w("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,(function(){clearTimeout(i),r()}))},t.prototype.addTag=function(t,e){var n=this;(0,o.Yr)()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){w("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(t){}}),Math.floor(1))},t}(),nt="";function rt(t){nt=t}var it=null;"undefined"!=typeof MozWebSocket?it=MozWebSocket:"undefined"!=typeof WebSocket&&(it=WebSocket);var ot=function(){function t(e,n,r,i,o){this.connId=e,this.applicationId=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=I(this.connId),this.stats_=Y(n),this.connURL=t.connectionURL_(n,i,o),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n){var r={v:"5"};return!(0,o.Yr)()&&"undefined"!=typeof location&&location.hostname&&B.test(location.hostname)&&(r.r="f"),e&&(r.s=e),n&&(r.ls=n),H(t,G,r)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,f.set("previous_websocket_failure",!0);try{if((0,o.Yr)()){var r=this.nodeAdmin?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/5/"+nt+"/"+process.platform+"/"+r,"X-Firebase-GMPID":this.applicationId||""}},a=process.env,s=0===this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;s&&(i.proxy={origin:s}),this.mySock=new it(this.connURL,[],i)}else i={headers:{"X-Firebase-GMPID":this.applicationId||""}},this.mySock=new it(this.connURL,[],i)}catch(t){this.log_("Error instantiating WebSocket.");var u=t.message||t.data;return u&&this.log_(u),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==it&&!t.forceDisallow_},t.previouslyFailed=function(){return f.isInMemoryStorage||!0===f.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){f.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=(0,o.cI)(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if((0,o.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=(0,o.Pz)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=O(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),at=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[tt,ot]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,i=ot&&ot.isAvailable(),o=i&&!ot.previouslyFailed();if(e.webSocketOnly&&(i||S("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[ot];else{var s=this.transports_=[];try{for(var u=(0,a.XA)(t.ALL_TRANSPORTS),c=u.next();!c.done;c=u.next()){var h=c.value;h&&h.isAvailable()&&s.push(h)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),st=function(){function t(t,e,n,r,i,o,a,s){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.onMessage_=r,this.onReady_=i,this.onDisconnect_=o,this.onKill_=a,this.lastSessionId=s,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=I("c:"+this.id+":"),this.transportManager_=new at(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,r)}),Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=q((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=P("t",t),n=P("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=P("t",t),n=P("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=P("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?T("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):T("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&S("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),q((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):q((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(f.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),ut=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),ct=function(){function t(t){this.allowedEvents_=t,this.listeners_={},(0,o.hu)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=(0,a.ev)([],(0,a.CR)(this.listeners_[t])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){(0,o.hu)(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),ht=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||(0,o.uI)()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return(0,a.ZT)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,o.hu)("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(ct),lt=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t}();function ft(){return new lt("")}function dt(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function pt(t){return t.pieces_.length-t.pieceNum_}function vt(t){var e=t.pieceNum_;return e<t.pieces_.length&&e++,new lt(t.pieces_,e)}function gt(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function mt(t,e){return void 0===e&&(e=0),t.pieces_.slice(t.pieceNum_+e)}function yt(t){if(t.pieceNum_>=t.pieces_.length)return null;for(var e=[],n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new lt(e,0)}function bt(t,e){for(var n=[],r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof lt)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new lt(n,0)}function _t(t){return t.pieceNum_>=t.pieces_.length}function wt(t,e){var n=dt(t),r=dt(e);if(null===n)return e;if(n===r)return wt(vt(t),vt(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function It(t,e){for(var n=mt(t,0),r=mt(e,0),i=0;i<n.length&&i<r.length;i++){var o=A(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function Tt(t,e){if(pt(t)!==pt(e))return!1;for(var n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Et(t,e){var n=t.pieceNum_,r=e.pieceNum_;if(pt(t)>pt(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var St=function(t,e){this.errorPrefix_=e,this.parts_=mt(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=(0,o.ug)(this.parts_[n]);Ct(this)};function Ct(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+kt(t))}function kt(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}var Nt,At,Dt=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))}),!1),r}return(0,a.ZT)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,o.hu)("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(ct),Pt=1e3,Rt=function(t){function e(n,r,i,a,s,u,c){var h=t.call(this)||this;if(h.repoInfo_=n,h.applicationId_=r,h.onDataUpdate_=i,h.onConnectStatus_=a,h.onServerInfoUpdate_=s,h.authTokenProvider_=u,h.authOverride_=c,h.id=e.nextPersistentConnectionId_++,h.log_=I("p:"+h.id+":"),h.interruptReasons_={},h.listens=new Map,h.outstandingPuts_=[],h.outstandingGets_=[],h.outstandingPutCount_=0,h.outstandingGetCount_=0,h.onDisconnectRequestQueue_=[],h.connected_=!1,h.reconnectDelay_=Pt,h.maxReconnectDelay_=3e5,h.securityDebugCallback_=null,h.lastSessionId=null,h.establishConnectionTimer_=null,h.visible_=!1,h.requestCBHash_={},h.requestNumber_=0,h.realtime_=null,h.authToken_=null,h.forceTokenRefresh_=!1,h.invalidAuthTokenCount_=0,h.firstConnection_=!0,h.lastConnectionAttemptTime_=null,h.lastConnectionEstablishedTime_=null,c&&!(0,o.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return h.scheduleConnect_(0),Dt.getInstance().on("visible",h.onVisible_,h),-1===n.host.indexOf("fblocal")&&ht.getInstance().on("online",h.onOnline_,h),h}return(0,a.ZT)(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r,a:t,b:e};this.log_((0,o.Pz)(i)),(0,o.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.get=function(t){var e=this,n=new o.BH,r={p:t._path.toString(),q:t._queryObject},i={action:"g",request:r,onComplete:function(t){var i=t.d;"ok"===t.s?(e.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var a=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var t=e.outstandingGets_[a];void 0!==t&&i===t&&(delete e.outstandingGets_[a],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),e.log_("get "+a+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(a),n.promise},e.prototype.listen=function(t,e,n,r){var i=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),(0,o.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,o.hu)(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(a).set(i,s),this.connected_&&this.sendListen_(s)},e.prototype.sendGet_=function(t){var e=this,n=this.outstandingGets_[t];this.sendRequest("g",n.request,(function(r){delete e.outstandingGets_[t],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);var a={p:i};t.tag&&(a.q=r._queryObject,a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,(function(a){var s=a.d,u=a.s;e.warnOnListenWarnings_(s,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&(0,o.r3)(t,"w")){var n=(0,o.DV)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e._queryParams.getIndex().toString()+'"',i=e._path.toString();S("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||(0,o.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=(0,o.w9)(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))}))}},e.prototype.unlisten=function(t,e){var n=t._path.toString(),r=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),(0,o.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t._queryObject,e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(function(t){r&&setTimeout((function(){r(t.s,t.d)}),Math.floor(0))}))},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,(function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+(0,o.Pz)(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):T("Unrecognized action received from server: "+(0,o.Pz)(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;(0,o.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Pt,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Pt,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Pt),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){var t=this;if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+e.nextConnectionId_++,s=this,u=this.lastSessionId,c=!1,h=null,l=function(){h?h.close():(c=!0,i())};this.realtime_={close:l,sendRequest:function(t){(0,o.hu)(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(t)}};var f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(f).then((function(t){c?w("getToken() completed but was canceled"):(w("getToken() completed. Creating connection."),s.authToken_=t&&t.accessToken,h=new st(a,s.repoInfo_,s.applicationId_,n,r,i,(function(t){S(t+" ("+s.repoInfo_.toString()+")"),s.interrupt("server_kill")}),u))})).then(null,(function(e){s.log_("Failed to get token: "+e),c||(t.repoInfo_.nodeAdmin&&S(e),l())}))}},e.prototype.interrupt=function(t){w("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){w("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,o.xb)(this.interruptReasons_)&&(this.reconnectDelay_=Pt,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return R(t)})).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new lt(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){w("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth();try{for(var i=(0,a.XA)(this.listens.values()),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var u=(n=void 0,(0,a.XA)(s.values())),c=u.next();!c.done;c=u.next()){var h=c.value;this.sendListen_(h)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var l=0;l<this.outstandingPuts_.length;l++)this.outstandingPuts_[l]&&this.sendPut_(l);for(;this.onDisconnectRequestQueue_.length;){var f=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(f.action,f.pathString,f.data,f.onComplete)}for(l=0;l<this.outstandingGets_.length;l++)this.outstandingGets_[l]&&this.sendGet_(l)},e.prototype.sendConnectStats_=function(){var t={},e="js";(0,o.Yr)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+nt.replace(/\./g,"-")]=1,(0,o.uI)()?t["framework.cordova"]=1:(0,o.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=ht.getInstance().currentlyOnline();return(0,o.xb)(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(ut),Ot=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),xt=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new Ot(k,t),r=new Ot(k,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return Ot.MIN},t}(),Lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.ZT)(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return Nt},set:function(t){Nt=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return A(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw(0,o.g5)("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return Ot.MIN},e.prototype.maxPost=function(){return new Ot(N,Nt)},e.prototype.makePost=function(t,e){return(0,o.hu)("string"==typeof t,"KeyIndex indexValue must always be a string."),new Ot(t,Nt)},e.prototype.toString=function(){return".key"},e}(xt),Mt=new Lt,Ft=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),Ut=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:jt.EMPTY_NODE,this.right=null!=o?o:jt.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return jt.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return jt.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),qt=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Ut(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),jt=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Ut.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Ut.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new Ft(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new Ft(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new Ft(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new Ft(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new qt,t}();function Vt(t,e){return A(t.name,e.name)}function Bt(t,e){return A(t,e)}var Gt,Kt,Wt,Ht,zt,Jt=function(t){return"number"==typeof t?"number:"+L(t):"string:"+t},Qt=function(t){if(t.isLeafNode()){var e=t.val();(0,o.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,o.r3)(e,".sv"),"Priority must be a string or number.")}else(0,o.hu)(t===At||t.isEmpty(),"priority of unexpected type.");(0,o.hu)(t===At||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Yt=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,(0,o.hu)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Qt(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return Gt},set:function(t){Gt=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return _t(e)?this:".priority"===dt(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=dt(e);return null===r?n:n.isEmpty()&&".priority"!==r?this:((0,o.hu)(".priority"!==r||1===pt(e),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(vt(e),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Jt(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?L(this.value_):this.value_,this.lazyHash_=g(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:((0,o.hu)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),a=t.VALUE_TYPE_ORDER.indexOf(r);return(0,o.hu)(i>=0,"Unknown leaf type: "+n),(0,o.hu)(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}(),Xt=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.ZT)(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?A(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return Ot.MIN},e.prototype.maxPost=function(){return new Ot(N,new Yt("[PRIORITY-POST]",Wt))},e.prototype.makePost=function(t,e){var n=Kt(t);return new Ot(e,new Yt("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(xt)),Zt=Math.log(2),$t=function(){function t(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/Zt,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),te=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,a,s=r-e;if(0===s)return null;if(1===s)return o=t[e],a=n?n(o):o,new Ut(a,o.node,Ut.BLACK,null,null);var u=parseInt(s/2,10)+e,c=i(e,u),h=i(u+1,r);return o=t[u],a=n?n(o):o,new Ut(a,o.node,Ut.BLACK,c,h)},o=function(e){for(var r=null,o=null,a=t.length,s=function(e,r){var o=a-e,s=a;a-=e;var c=i(o+1,s),h=t[o],l=n?n(h):h;u(new Ut(l,h.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var h=e.nextBitIsOne(),l=Math.pow(2,e.count-(c+1));h?s(l,Ut.BLACK):(s(l,Ut.BLACK),s(l,Ut.RED))}return o}(new $t(t.length));return new jt(r||e,o)},ee={},ne=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return(0,o.hu)(ee&&Xt,"ChildrenNode.ts has not been loaded"),Ht=Ht||new t({".priority":ee},{".priority":Xt})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=(0,o.DV)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof jt?e:null},t.prototype.hasIndex=function(t){return(0,o.r3)(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){(0,o.hu)(e!==Mt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],s=!1,u=n.getIterator(Ot.Wrap),c=u.getNext();c;)s=s||e.isDefinedOn(c.node),i.push(c),c=u.getNext();r=s?te(i,e.getCompare()):ee;var h=e.toString(),l=(0,a.pi)({},this.indexSet_);l[h]=e;var f=(0,a.pi)({},this.indexes_);return f[h]=r,new t(f,l)},t.prototype.addToIndexes=function(e,n){var r=this;return new t((0,o.UI)(this.indexes_,(function(t,i){var a=(0,o.DV)(r.indexSet_,i);if((0,o.hu)(a,"Missing index implementation for "+i),t===ee){if(a.isDefinedOn(e.node)){for(var s=[],u=n.getIterator(Ot.Wrap),c=u.getNext();c;)c.name!==e.name&&s.push(c),c=u.getNext();return s.push(e),te(s,a.getCompare())}return ee}var h=n.get(e.name),l=t;return h&&(l=l.remove(new Ot(e.name,h))),l.insert(e,e.node)})),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t((0,o.UI)(this.indexes_,(function(t){if(t===ee)return t;var r=n.get(e.name);return r?t.remove(new Ot(e.name,r)):t})),this.indexSet_)},t}(),re=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Qt(this.priorityNode_),this.children_.isEmpty()&&(0,o.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return zt||(zt=new t(new jt(Bt),null,ne.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||zt},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?zt:e},t.prototype.getChild=function(t){var e=dt(t);return null===e?this:this.getImmediateChild(e).getChild(vt(t))},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if((0,o.hu)(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new Ot(e,n),i=void 0,a=void 0;n.isEmpty()?(i=this.children_.remove(e),a=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),a=this.indexMap_.addToIndexes(r,this.children_));var s=i.isEmpty()?zt:this.priorityNode_;return new t(i,s,a)},t.prototype.updateChild=function(t,e){var n=dt(t);if(null===n)return e;(0,o.hu)(".priority"!==dt(t)||1===pt(t),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(vt(t),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(Xt,(function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+Jt(this.getPriority().val())+":"),this.forEachChild(Xt,(function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":g(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Ot(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new Ot(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new Ot(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getIteratorFrom(t.name,Ot.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getReverseIteratorFrom(t.name,Ot.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===ie?-1:0},t.prototype.withIndex=function(e){if(e===Mt||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===Mt||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(Xt),r=e.getIterator(Xt),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===Mt?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),ie=new(function(t){function e(){return t.call(this,new jt(Bt),re.EMPTY_NODE,ne.Default)||this}return(0,a.ZT)(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return re.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(re));function oe(t,e){if(void 0===e&&(e=null),null===t)return re.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),(0,o.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new Yt(t,oe(e));if(t instanceof Array){var n=re.EMPTY_NODE;return x(t,(function(e,r){if((0,o.r3)(t,e)&&"."!==e.substring(0,1)){var i=oe(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(e,i))}})),n.updatePriority(oe(e))}var r=[],i=!1;if(x(t,(function(t,e){if("."!==t.substring(0,1)){var n=oe(e);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new Ot(t,n)))}})),0===r.length)return re.EMPTY_NODE;var a=te(r,Vt,(function(t){return t.name}),Bt);if(i){var s=te(r,Xt.getCompare());return new re(a,oe(e),new ne({".priority":s},{".priority":Xt}))}return new re(a,oe(e),ne.Default)}Object.defineProperties(Ot,{MIN:{value:new Ot(k,re.EMPTY_NODE)},MAX:{value:new Ot(N,ie)}}),Lt.__EMPTY_NODE=re.EMPTY_NODE,Yt.__childrenNodeConstructor=re,At=ie,Wt=ie,function(t){Kt=t}(oe);var ae,se,ue=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,(0,o.hu)(!_t(e)&&".priority"!==dt(e),"Can't create PathIndex with empty path or .priority key"),n}return(0,a.ZT)(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?A(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=oe(t),r=re.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ot(e,r)},e.prototype.maxPost=function(){var t=re.EMPTY_NODE.updateChild(this.indexPath_,ie);return new Ot(N,t)},e.prototype.toString=function(){return mt(this.indexPath_,0).join("/")},e}(xt),ce=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.ZT)(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?A(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return Ot.MIN},e.prototype.maxPost=function(){return Ot.MAX},e.prototype.makePost=function(t,e){var n=oe(t);return new Ot(e,n)},e.prototype.toString=function(){return".value"},e}(xt)),he="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",le=(ae=0,se=[],function(t){var e,n=t===ae;ae=t;var r=new Array(8);for(e=7;e>=0;e--)r[e]=he.charAt(t%64),t=Math.floor(t/64);(0,o.hu)(0===t,"Cannot push at time == 0");var i=r.join("");if(n){for(e=11;e>=0&&63===se[e];e--)se[e]=0;se[e]++}else for(e=0;e<12;e++)se[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)i+=he.charAt(se[e]);return(0,o.hu)(20===i.length,"nextPushId: Length should be 20."),i}),fe=function(t){if("2147483647"===t)return"-";var e=F(t);if(null!=e)return""+(e+1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;i>=0&&"z"===n[i];)i--;if(-1===i)return N;var o=n[i],a=he.charAt(he.indexOf(o)+1);return n[i]=a,n.slice(0,i+1).join("")},de=function(t){if("-2147483648"===t)return k;var e=F(t);if(null!=e)return""+(e-1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=he.charAt(he.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function pe(t){return{type:"value",snapshotNode:t}}function ve(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function ge(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function me(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}var ye=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,a){(0,o.hu)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=t.getImmediateChild(e);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?t:(null!=a&&(n.isEmpty()?t.hasChild(e)?a.trackChildChange(ge(e,s)):(0,o.hu)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?a.trackChildChange(ve(e,n)):a.trackChildChange(me(e,n,s))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(Xt,(function(t,r){e.hasChild(t)||n.trackChildChange(ge(t,r))})),e.isLeafNode()||e.forEachChild(Xt,(function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(me(e,r,i))}else n.trackChildChange(ve(e,r))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?re.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),be=function(){function t(e){this.indexedFilter_=new ye(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new Ot(e,n))||(n=re.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=re.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(re.EMPTY_NODE);var i=this;return e.forEachChild(Xt,(function(t,e){i.matches(new Ot(t,e))||(r=r.updateImmediateChild(t,re.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),_e=function(){function t(t){this.rangedFilter_=new be(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new Ot(e,n))||(n=re.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=re.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=re.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(re.EMPTY_NODE);var s=void 0,u=void 0,c=void 0;if(i=void 0,this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();c=function(t,e){return h(e,t)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var l=!1;i.hasNext();)a=i.getNext(),!l&&c(s,a)<=0&&(l=!0),l&&o<this.limit_&&c(a,u)<=0?o++:r=r.updateImmediateChild(a.name,re.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var a;if(this.reverse_){var s=this.index_.getCompare();a=function(t,e){return s(e,t)}}else a=this.index_.getCompare();var u=t;(0,o.hu)(u.numChildren()===this.limit_,"");var c=new Ot(e,n),h=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),l=this.rangedFilter_.matches(c);if(u.hasChild(e)){for(var f=u.getImmediateChild(e),d=r.getChildAfterChild(this.index_,h,this.reverse_);null!=d&&(d.name===e||u.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);var p=null==d?1:a(d,c);if(l&&!n.isEmpty()&&p>=0)return null!=i&&i.trackChildChange(me(e,n,f)),u.updateImmediateChild(e,n);null!=i&&i.trackChildChange(ge(e,f));var v=u.updateImmediateChild(e,re.EMPTY_NODE);return null!=d&&this.rangedFilter_.matches(d)?(null!=i&&i.trackChildChange(ve(d.name,d.node)),v.updateImmediateChild(d.name,d.node)):v}return n.isEmpty()?t:l&&a(h,c)>=0?(null!=i&&(i.trackChildChange(ge(h.name,h.node)),i.trackChildChange(ve(e,n))),u.updateImmediateChild(e,n).updateImmediateChild(h.name,re.EMPTY_NODE)):t},t}(),we=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Xt}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.hasStartAfter=function(){return this.startAfterSet_},t.prototype.hasEndBefore=function(){return this.endBeforeSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},t.prototype.getIndexStartValue=function(){return(0,o.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return(0,o.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:k},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return(0,o.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return(0,o.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:N},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return(0,o.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===Xt},t.prototype.copy=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t}();function Ie(t,e,n){var r=t.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function Te(t,e,n){var r=t.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function Ee(t,e){var n=t.copy();return n.index_=e,n}function Se(t){var e,n={};return t.isDefault()||(t.index_===Xt?e="$priority":t.index_===ce?e="$value":t.index_===Mt?e="$key":((0,o.hu)(t.index_ instanceof ue,"Unrecognized index type!"),e=t.index_.toString()),n.orderBy=(0,o.Pz)(e),t.startSet_&&(n.startAt=(0,o.Pz)(t.indexStartValue_),t.startNameSet_&&(n.startAt+=","+(0,o.Pz)(t.indexStartName_))),t.endSet_&&(n.endAt=(0,o.Pz)(t.indexEndValue_),t.endNameSet_&&(n.endAt+=","+(0,o.Pz)(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?n.limitToFirst=t.limit_:n.limitToLast=t.limit_)),n}function Ce(t){var e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;var n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==Xt&&(e.i=t.index_.toString()),e}var ke=function(t){function e(e,n,r){var i=t.call(this)||this;return i.repoInfo_=e,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=I("p:rest:"),i.listens_={},i}return(0,a.ZT)(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:((0,o.hu)(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())},e.prototype.listen=function(t,n,r,i){var a=this,s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var h=Se(t._queryParams);this.restRequest_(s+".json",h,(function(t,e){var n=e;404===t&&(n=null,t=null),null===t&&a.onDataUpdate_(s,n,!1,r),(0,o.DV)(a.listens_,u)===c&&i(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)}))},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.get=function(t){var e=this,n=Se(t._queryParams),r=t._path.toString(),i=new o.BH;return this.restRequest_(r+".json",n,(function(t,n){var o=n;404===t&&(o=null,t=null),null===t?(e.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(new Error(o))})),i.promise},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;void 0===e&&(e={}),e.format="export",this.authTokenProvider_.getToken(!1).then((function(i){var a=i&&i.accessToken;a&&(e.auth=a);var s=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+(0,o.xO)(e);r.log_("Sending REST request for "+s);var u=new XMLHttpRequest;u.onreadystatechange=function(){if(n&&4===u.readyState){r.log_("REST Response for "+s+" received. status:",u.status,"response:",u.responseText);var t=null;if(u.status>=200&&u.status<300){try{t=(0,o.cI)(u.responseText)}catch(t){S("Failed to parse JSON response for "+s+": "+u.responseText)}n(null,t)}else 401!==u.status&&404!==u.status&&S("Got unsuccessful REST response for "+s+" Status: "+u.status),n(u.status);n=null}},u.open("GET",s,!0),u.send()}))},e}(ut),Ne=function(){function t(){this.rootNode_=re.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}();function Ae(){return{value:null,children:new Map}}function De(t,e,n){if(_t(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{var r=dt(e);t.children.has(r)||t.children.set(r,Ae()),De(t.children.get(r),e=vt(e),n)}}function Pe(t,e){if(_t(e))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;var n=t.value;return t.value=null,n.forEachChild(Xt,(function(e,n){De(t,new lt(e),n)})),Pe(t,e)}if(t.children.size>0){var r=dt(e);return e=vt(e),t.children.has(r)&&Pe(t.children.get(r),e)&&t.children.delete(r),0===t.children.size}return!0}function Re(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach((function(t,n){e(n,t)}))}(t,(function(t,r){Re(r,new lt(e.toString()+"/"+t),n)}))}var Oe,xe=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=(0,a.pi)({},t);return this.last_&&x(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),Le=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new xe(t);var n=1e4+2e4*Math.random();q(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;x(e,(function(e,i){i>0&&(0,o.r3)(t.statsToReport_,e)&&(n[e]=i,r=!0)})),r&&this.server_.reportStats(n),q(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}();function Me(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Oe||(Oe={}));var Fe,Ue=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=Oe.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return t.prototype.operationForChild=function(e){if(_t(this.path)){if(null!=this.affectedTree.value)return(0,o.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new lt(e));return new t(ft(),n,this.revert)}return(0,o.hu)(dt(this.path)===e,"operationForChild called for unrelated child."),new t(vt(this.path),this.affectedTree,this.revert)},t}(),qe=function(){function t(t,e){this.source=t,this.path=e,this.type=Oe.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return _t(this.path)?new t(this.source,ft()):new t(this.source,vt(this.path))},t}(),je=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=Oe.OVERWRITE}return t.prototype.operationForChild=function(e){return _t(this.path)?new t(this.source,ft(),this.snap.getImmediateChild(e)):new t(this.source,vt(this.path),this.snap)},t}(),Ve=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=Oe.MERGE}return t.prototype.operationForChild=function(e){if(_t(this.path)){var n=this.children.subtree(new lt(e));return n.isEmpty()?null:n.value?new je(this.source,ft(),n.value):new t(this.source,ft(),n)}return(0,o.hu)(dt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,vt(this.path),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),Be=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(_t(t))return this.isFullyInitialized()&&!this.filtered_;var e=dt(t);return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),Ge=function(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()};function Ke(t,e,n,r,i,a){var s=r.filter((function(t){return t.type===n}));s.sort((function(e,n){return function(t,e,n){if(null==e.childName||null==n.childName)throw(0,o.g5)("Should only compare child_ events.");var r=new Ot(e.childName,e.snapshotNode),i=new Ot(n.childName,n.snapshotNode);return t.index_.compare(r,i)}(t,e,n)})),s.forEach((function(n){var r=function(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,n,a);i.forEach((function(i){i.respondsTo(n.type)&&e.push(i.createEvent(r,t.query_))}))}))}function We(t,e){return{eventCache:t,serverCache:e}}function He(t,e,n,r){return We(new Be(e,n,r),t.serverCache)}function ze(t,e,n,r){return We(t.eventCache,new Be(e,n,r))}function Je(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Qe(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var Ye=function(){function t(t,e){void 0===e&&(Fe||(Fe=new jt(D)),e=Fe),this.value=t,this.children=e}return t.fromObject=function(e){var n=new t(null);return x(e,(function(t,e){n=n.set(new lt(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:ft(),value:this.value};if(_t(t))return null;var n=dt(t),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(vt(t),e);return null!=i?{path:bt(new lt(n),i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(_t(e))return this;var n=dt(e),r=this.children.get(n);return null!==r?r.subtree(vt(e)):new t(null)},t.prototype.set=function(e,n){if(_t(e))return new t(n,this.children);var r=dt(e),i=(this.children.get(r)||new t(null)).set(vt(e),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(_t(e))return this.children.isEmpty()?new t(null):new t(null,this.children);var n=dt(e),r=this.children.get(n);if(r){var i=r.remove(vt(e)),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new t(null):new t(this.value,o)}return this},t.prototype.get=function(t){if(_t(t))return this.value;var e=dt(t),n=this.children.get(e);return n?n.get(vt(t)):null},t.prototype.setTree=function(e,n){if(_t(e))return n;var r,i=dt(e),o=(this.children.get(i)||new t(null)).setTree(vt(e),n);return r=o.isEmpty()?this.children.remove(i):this.children.insert(i,o),new t(this.value,r)},t.prototype.fold=function(t){return this.fold_(ft(),t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(bt(t,r),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,ft(),e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(_t(t))return null;var i=dt(t),o=this.children.get(i);return o?o.findOnPath_(vt(t),bt(e,i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,ft(),e)},t.prototype.foreachOnPath_=function(e,n,r){if(_t(e))return this;this.value&&r(n,this.value);var i=dt(e),o=this.children.get(i);return o?o.foreachOnPath_(vt(e),bt(n,i),r):new t(null)},t.prototype.foreach=function(t){this.foreach_(ft(),t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,r){r.foreach_(bt(t,n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t}(),Xe=function(){function t(t){this.writeTree_=t}return t.empty=function(){return new t(new Ye(null))},t}();function Ze(t,e,n){if(_t(e))return new Xe(new Ye(n));var r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,a=wt(i,e);return o=o.updateChild(a,n),new Xe(t.writeTree_.set(i,o))}var s=new Ye(n),u=t.writeTree_.setTree(e,s);return new Xe(u)}function $e(t,e,n){var r=t;return x(n,(function(t,n){r=Ze(r,bt(e,t),n)})),r}function tn(t,e){if(_t(e))return Xe.empty();var n=t.writeTree_.setTree(e,new Ye(null));return new Xe(n)}function en(t,e){return null!=nn(t,e)}function nn(t,e){var n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(wt(n.path,e)):null}function rn(t){var e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Xt,(function(t,n){e.push(new Ot(t,n))})):t.writeTree_.children.inorderTraversal((function(t,n){null!=n.value&&e.push(new Ot(t,n.value))})),e}function on(t,e){if(_t(e))return t;var n=nn(t,e);return new Xe(null!=n?new Ye(n):t.writeTree_.subtree(e))}function an(t){return t.writeTree_.isEmpty()}function sn(t,e){return un(ft(),t.writeTree_,e)}function un(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);var r=null;return e.children.inorderTraversal((function(e,i){".priority"===e?((0,o.hu)(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=un(bt(t,e),i,n)})),n.getChild(t).isEmpty()||null===r||(n=n.updateChild(bt(t,".priority"),r)),n}function cn(t,e){return _n(e,t)}function hn(t,e){if(t.snap)return Et(t.path,e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&Et(bt(t.path,n),e))return!0;return!1}function ln(t){return t.visible}function fn(t,e,n){for(var r=Xe.empty(),i=0;i<t.length;++i){var a=t[i];if(e(a)){var s=a.path,u=void 0;if(a.snap)Et(n,s)?r=Ze(r,u=wt(n,s),a.snap):Et(s,n)&&(u=wt(s,n),r=Ze(r,ft(),a.snap.getChild(u)));else{if(!a.children)throw(0,o.g5)("WriteRecord should have .snap or .children");if(Et(n,s))r=$e(r,u=wt(n,s),a.children);else if(Et(s,n))if(_t(u=wt(s,n)))r=$e(r,ft(),a.children);else{var c=(0,o.DV)(a.children,dt(u));if(c){var h=c.getChild(vt(u));r=Ze(r,ft(),h)}}}}}return r}function dn(t,e,n,r,i){if(r||i){var o=on(t.visibleWrites,e);return!i&&an(o)?n:i||null!=n||en(o,ft())?sn(fn(t.allWrites,(function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(Et(t.path,e)||Et(e,t.path))}),e),n||re.EMPTY_NODE):null}var a=nn(t.visibleWrites,e);if(null!=a)return a;var s=on(t.visibleWrites,e);return an(s)?n:null!=n||en(s,ft())?sn(s,n||re.EMPTY_NODE):null}function pn(t,e,n,r){return dn(t.writeTree,t.treePath,e,n,r)}function vn(t,e){return function(t,e,n){var r=re.EMPTY_NODE,i=nn(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Xt,(function(t,e){r=r.updateImmediateChild(t,e)})),r;if(n){var o=on(t.visibleWrites,e);return n.forEachChild(Xt,(function(t,e){var n=sn(on(o,new lt(t)),e);r=r.updateImmediateChild(t,n)})),rn(o).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}return rn(on(t.visibleWrites,e)).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}(t.writeTree,t.treePath,e)}function gn(t,e,n,r){return function(t,e,n,r,i){(0,o.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=bt(e,n);if(en(t.visibleWrites,a))return null;var s=on(t.visibleWrites,a);return an(s)?i.getChild(n):sn(s,i.getChild(n))}(t.writeTree,t.treePath,e,n,r)}function mn(t,e){return function(t,e){return nn(t.visibleWrites,e)}(t.writeTree,bt(t.treePath,e))}function yn(t,e,n){return function(t,e,n,r){var i=bt(e,n),o=nn(t.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?sn(on(t.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function bn(t,e){return _n(bt(t.treePath,e),t.writeTree)}function _n(t,e){return{treePath:t,writeTree:e}}var wn=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;(0,o.hu)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),(0,o.hu)(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===e&&"child_removed"===i)this.changeMap.set(n,me(n,t.snapshotNode,r.snapshotNode));else if("child_removed"===e&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===i)this.changeMap.set(n,ge(n,r.oldSnap));else if("child_changed"===e&&"child_added"===i)this.changeMap.set(n,ve(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==i)throw(0,o.g5)("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,me(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),In=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),Tn=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new Be(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return yn(this.writes_,t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Qe(this.viewCache_),i=function(t,e,n,r,i,o){return function(t,e,n,r,i,o,a){var s,u=on(t.visibleWrites,e),c=nn(u,ft());if(null!=c)s=c;else{if(null==n)return[];s=sn(u,n)}if((s=s.withIndex(a)).isEmpty()||s.isLeafNode())return[];for(var h=[],l=a.getCompare(),f=o?s.getReverseIteratorFrom(r,a):s.getIteratorFrom(r,a),d=f.getNext();d&&h.length<i;)0!==l(d,r)&&h.push(d),d=f.getNext();return h}(t.writeTree,t.treePath,e,n,r,i,o)}(this.writes_,r,e,1,n,t);return 0===i.length?null:i[0]},t}();function En(t,e,n,r,i,a){var s=e.eventCache;if(null!=mn(r,n))return e;var u=void 0,c=void 0;if(_t(n))if((0,o.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){var h=Qe(e),l=vn(r,h instanceof re?h:re.EMPTY_NODE);u=t.filter.updateFullNode(e.eventCache.getNode(),l,a)}else{var f=pn(r,Qe(e));u=t.filter.updateFullNode(e.eventCache.getNode(),f,a)}else{var d=dt(n);if(".priority"===d){(0,o.hu)(1===pt(n),"Can't have a priority with additional path components");var p=s.getNode(),v=gn(r,n,p,c=e.serverCache.getNode());u=null!=v?t.filter.updatePriority(p,v):s.getNode()}else{var g=vt(n),m=void 0;if(s.isCompleteForChild(d)){c=e.serverCache.getNode();var y=gn(r,n,s.getNode(),c);m=null!=y?s.getNode().getImmediateChild(d).updateChild(g,y):s.getNode().getImmediateChild(d)}else m=yn(r,d,e.serverCache);u=null!=m?t.filter.updateChild(s.getNode(),d,m,g,i,a):s.getNode()}}return He(e,u,s.isFullyInitialized()||_t(n),t.filter.filtersNodes())}function Sn(t,e,n,r,i,o,a,s){var u,c=e.serverCache,h=a?t.filter:t.filter.getIndexedFilter();if(_t(n))u=h.updateFullNode(c.getNode(),r,null);else if(h.filtersNodes()&&!c.isFiltered()){var l=c.getNode().updateChild(n,r);u=h.updateFullNode(c.getNode(),l,null)}else{var f=dt(n);if(!c.isCompleteForPath(n)&&pt(n)>1)return e;var d=vt(n),p=c.getNode().getImmediateChild(f).updateChild(d,r);u=".priority"===f?h.updatePriority(c.getNode(),p):h.updateChild(c.getNode(),f,p,d,In,null)}var v=ze(e,u,c.isFullyInitialized()||_t(n),h.filtersNodes());return En(t,v,n,i,new Tn(i,v,o),s)}function Cn(t,e,n,r,i,o,a){var s,u,c=e.eventCache,h=new Tn(i,e,o);if(_t(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,a),s=He(e,u,!0,t.filter.filtersNodes());else{var l=dt(n);if(".priority"===l)u=t.filter.updatePriority(e.eventCache.getNode(),r),s=He(e,u,c.isFullyInitialized(),c.isFiltered());else{var f=vt(n),d=c.getNode().getImmediateChild(l),p=void 0;if(_t(f))p=r;else{var v=h.getCompleteChild(l);p=null!=v?".priority"===gt(f)&&v.getChild(yt(f)).isEmpty()?v:v.updateChild(f,r):re.EMPTY_NODE}s=d.equals(p)?e:He(e,t.filter.updateChild(c.getNode(),l,p,f,h,a),c.isFullyInitialized(),t.filter.filtersNodes())}}return s}function kn(t,e){return t.eventCache.isCompleteForChild(e)}function Nn(t,e,n){return n.foreach((function(t,n){e=e.updateChild(t,n)})),e}function An(t,e,n,r,i,o,a,s){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;var u,c=e;u=_t(n)?r:new Ye(null).setTree(n,r);var h=e.serverCache.getNode();return u.children.inorderTraversal((function(n,r){if(h.hasChild(n)){var u=Nn(0,e.serverCache.getNode().getImmediateChild(n),r);c=Sn(t,c,new lt(n),u,i,o,a,s)}})),u.children.inorderTraversal((function(n,r){var u=!e.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!h.hasChild(n)&&!u){var l=Nn(0,e.serverCache.getNode().getImmediateChild(n),r);c=Sn(t,c,new lt(n),l,i,o,a,s)}})),c}var Dn,Pn=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n,r=this.query_._queryParams,i=new ye(r.getIndex()),o=(n=r).loadsAllData()?new ye(n.getIndex()):n.hasLimit()?new _e(n):new be(n);this.processor_=function(t){return{filter:t}}(o);var a=e.serverCache,s=e.eventCache,u=i.updateFullNode(re.EMPTY_NODE,a.getNode(),null),c=o.updateFullNode(re.EMPTY_NODE,s.getNode(),null),h=new Be(u,a.isFullyInitialized(),i.filtersNodes()),l=new Be(c,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=We(l,h),this.eventGenerator_=new Ge(this.query_)}return Object.defineProperty(t.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),t}();function Rn(t,e){var n=Qe(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!_t(e)&&!n.getImmediateChild(dt(e)).isEmpty())?n.getChild(e):null}function On(t){return 0===t.eventRegistrations_.length}function xn(t,e,n){var r=[];if(n){(0,o.hu)(null==e,"A cancel should cancel all event registrations.");var i=t.query._path;t.eventRegistrations_.forEach((function(t){var e=t.createCancelEvent(n,i);e&&r.push(e)}))}if(e){for(var a=[],s=0;s<t.eventRegistrations_.length;++s){var u=t.eventRegistrations_[s];if(u.matches(e)){if(e.hasAnyCallback()){a=a.concat(t.eventRegistrations_.slice(s+1));break}}else a.push(u)}t.eventRegistrations_=a}else t.eventRegistrations_=[];return r}function Ln(t,e,n,r){e.type===Oe.MERGE&&null!==e.source.queryId&&((0,o.hu)(Qe(t.viewCache_),"We should always have a full cache before handling merges"),(0,o.hu)(Je(t.viewCache_),"Missing event cache, even though we have a server cache"));var i,a,s=t.viewCache_,u=function(t,e,n,r,i){var a,s,u=new wn;if(n.type===Oe.OVERWRITE){var c=n;c.source.fromUser?a=Cn(t,e,c.path,c.snap,r,i,u):((0,o.hu)(c.source.fromServer,"Unknown source."),s=c.source.tagged||e.serverCache.isFiltered()&&!_t(c.path),a=Sn(t,e,c.path,c.snap,r,i,s,u))}else if(n.type===Oe.MERGE){var h=n;h.source.fromUser?a=function(t,e,n,r,i,o,a){var s=e;return r.foreach((function(r,u){var c=bt(n,r);kn(e,dt(c))&&(s=Cn(t,s,c,u,i,o,a))})),r.foreach((function(r,u){var c=bt(n,r);kn(e,dt(c))||(s=Cn(t,s,c,u,i,o,a))})),s}(t,e,h.path,h.children,r,i,u):((0,o.hu)(h.source.fromServer,"Unknown source."),s=h.source.tagged||e.serverCache.isFiltered(),a=An(t,e,h.path,h.children,r,i,s,u))}else if(n.type===Oe.ACK_USER_WRITE){var l=n;a=l.revert?function(t,e,n,r,i,a){var s;if(null!=mn(r,n))return e;var u=new Tn(r,e,i),c=e.eventCache.getNode(),h=void 0;if(_t(n)||".priority"===dt(n)){var l=void 0;if(e.serverCache.isFullyInitialized())l=pn(r,Qe(e));else{var f=e.serverCache.getNode();(0,o.hu)(f instanceof re,"serverChildren would be complete if leaf node"),l=vn(r,f)}l=l,h=t.filter.updateFullNode(c,l,a)}else{var d=dt(n),p=yn(r,d,e.serverCache);null==p&&e.serverCache.isCompleteForChild(d)&&(p=c.getImmediateChild(d)),(h=null!=p?t.filter.updateChild(c,d,p,vt(n),u,a):e.eventCache.getNode().hasChild(d)?t.filter.updateChild(c,d,re.EMPTY_NODE,vt(n),u,a):c).isEmpty()&&e.serverCache.isFullyInitialized()&&(s=pn(r,Qe(e))).isLeafNode()&&(h=t.filter.updateFullNode(h,s,a))}return s=e.serverCache.isFullyInitialized()||null!=mn(r,ft()),He(e,h,s,t.filter.filtersNodes())}(t,e,l.path,r,i,u):function(t,e,n,r,i,o,a){if(null!=mn(i,n))return e;var s=e.serverCache.isFiltered(),u=e.serverCache;if(null!=r.value){if(_t(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return Sn(t,e,n,u.getNode().getChild(n),i,o,s,a);if(_t(n)){var c=new Ye(null);return u.getNode().forEachChild(Mt,(function(t,e){c=c.set(new lt(t),e)})),An(t,e,n,c,i,o,s,a)}return e}var h=new Ye(null);return r.foreach((function(t,e){var r=bt(n,t);u.isCompleteForPath(r)&&(h=h.set(t,u.getNode().getChild(r)))})),An(t,e,n,h,i,o,s,a)}(t,e,l.path,l.affectedTree,r,i,u)}else{if(n.type!==Oe.LISTEN_COMPLETE)throw(0,o.g5)("Unknown operation type: "+n.type);a=function(t,e,n,r,i){var o=e.serverCache;return En(t,ze(e,o.getNode(),o.isFullyInitialized()||_t(n),o.isFiltered()),n,r,In,i)}(t,e,n.path,r,u)}var f=u.getChanges();return function(t,e,n){var r=e.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Je(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(pe(Je(e)))}}(e,a,f),{viewCache:a,changes:f}}(t.processor_,s,e,n,r);return i=t.processor_,a=u.viewCache,(0,o.hu)(a.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),(0,o.hu)(a.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),(0,o.hu)(u.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=u.viewCache,Mn(t,u.changes,u.viewCache.eventCache.getNode(),null)}function Mn(t,e,n,r){var i=r?[r]:t.eventRegistrations_;return function(t,e,n,r){var i=[],o=[];return e.forEach((function(e){var n;"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push((n=e.childName,{type:"child_moved",snapshotNode:e.snapshotNode,childName:n}))})),Ke(t,i,"child_removed",e,r,n),Ke(t,i,"child_added",e,r,n),Ke(t,i,"child_moved",o,r,n),Ke(t,i,"child_changed",e,r,n),Ke(t,i,"value",e,r,n),i}(t.eventGenerator_,e,n,i)}var Fn,Un=function(){this.views=new Map};function qn(t,e,n,r){var i,s,u=e.source.queryId;if(null!==u){var c=t.views.get(u);return(0,o.hu)(null!=c,"SyncTree gave us an op for an invalid query."),Ln(c,e,n,r)}var h=[];try{for(var l=(0,a.XA)(t.views.values()),f=l.next();!f.done;f=l.next())c=f.value,h=h.concat(Ln(c,e,n,r))}catch(t){i={error:t}}finally{try{f&&!f.done&&(s=l.return)&&s.call(l)}finally{if(i)throw i.error}}return h}function jn(t,e,n,r,i){var o=e._queryIdentifier,a=t.views.get(o);if(!a){var s=pn(n,i?r:null),u=!1;s?u=!0:r instanceof re?(s=vn(n,r),u=!1):(s=re.EMPTY_NODE,u=!1);var c=We(new Be(s,u,!1),new Be(r,i,!1));return new Pn(e,c)}return a}function Vn(t){var e,n,r=[];try{for(var i=(0,a.XA)(t.views.values()),o=i.next();!o.done;o=i.next()){var s=o.value;s.query._queryParams.loadsAllData()||r.push(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function Bn(t,e){var n,r,i=null;try{for(var o=(0,a.XA)(t.views.values()),s=o.next();!s.done;s=o.next()){var u=s.value;i=i||Rn(u,e)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function Gn(t,e){if(e._queryParams.loadsAllData())return Hn(t);var n=e._queryIdentifier;return t.views.get(n)}function Kn(t,e){return null!=Gn(t,e)}function Wn(t){return null!=Hn(t)}function Hn(t){var e,n;try{for(var r=(0,a.XA)(t.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.query._queryParams.loadsAllData())return o}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return null}var zn=1,Jn=function(t){this.listenProvider_=t,this.syncPointTree_=new Ye(null),this.pendingWriteTree_={visibleWrites:Xe.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function Qn(t,e,n,r,i){return function(t,e,n,r,i){(0,o.hu)(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Ze(t.visibleWrites,e,n)),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r,i),i?er(t,new je({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function Yn(t,e,n){void 0===n&&(n=!1);var r=function(t,e){for(var n=0;n<t.allWrites.length;n++){var r=t.allWrites[n];if(r.writeId===e)return r}return null}(t.pendingWriteTree_,e);if(function(t,e){var n=t.allWrites.findIndex((function(t){return t.writeId===e}));(0,o.hu)(n>=0,"removeWrite called with nonexistent writeId.");var r=t.allWrites[n];t.allWrites.splice(n,1);for(var i=r.visible,a=!1,s=t.allWrites.length-1;i&&s>=0;){var u=t.allWrites[s];u.visible&&(s>=n&&hn(u,r.path)?i=!1:Et(r.path,u.path)&&(a=!0)),s--}return!!i&&(a?(function(t){t.visibleWrites=fn(t.allWrites,ln,ft()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}(t),!0):(r.snap?t.visibleWrites=tn(t.visibleWrites,r.path):x(r.children,(function(e){t.visibleWrites=tn(t.visibleWrites,bt(r.path,e))})),!0))}(t.pendingWriteTree_,e)){var i=new Ye(null);return null!=r.snap?i=i.set(ft(),!0):x(r.children,(function(t){i=i.set(new lt(t),!0)})),er(t,new Ue(r.path,i,n))}return[]}function Xn(t,e,n){return er(t,new je({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function Zn(t,e,n,r){var i=e._path,s=t.syncPointTree_.get(i),u=[];if(s&&("default"===e._queryIdentifier||Kn(s,e))){var c=function(t,e,n,r){var i,s,u=e._queryIdentifier,c=[],h=[],l=Wn(t);if("default"===u)try{for(var f=(0,a.XA)(t.views.entries()),d=f.next();!d.done;d=f.next()){var p=(0,a.CR)(d.value,2),v=p[0],g=p[1];h=h.concat(xn(g,n,r)),On(g)&&(t.views.delete(v),g.query._queryParams.loadsAllData()||c.push(g.query))}}catch(t){i={error:t}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(i)throw i.error}}else(g=t.views.get(u))&&(h=h.concat(xn(g,n,r)),On(g)&&(t.views.delete(u),g.query._queryParams.loadsAllData()||c.push(g.query)));return l&&!Wn(t)&&c.push(new((0,o.hu)(Dn,"Reference.ts has not been loaded"),Dn)(e._repo,e._path)),{removed:c,events:h}}(s,e,n,r);0===s.views.size&&(t.syncPointTree_=t.syncPointTree_.remove(i));var h=c.removed;u=c.events;var l=-1!==h.findIndex((function(t){return t._queryParams.loadsAllData()})),f=t.syncPointTree_.findOnPath(i,(function(t,e){return Wn(e)}));if(l&&!f){var d=t.syncPointTree_.subtree(i);if(!d.isEmpty())for(var p=function(t){return t.fold((function(t,e,n){if(e&&Wn(e))return[Hn(e)];var r=[];return e&&(r=Vn(e)),x(n,(function(t,e){r=r.concat(e)})),r}))}(d),v=0;v<p.length;++v){var g=p[v],m=g.query,y=ir(t,g);t.listenProvider_.startListening(hr(m),or(t,m),y.hashFn,y.onComplete)}}!f&&h.length>0&&!r&&(l?t.listenProvider_.stopListening(hr(e),null):h.forEach((function(e){var n=t.queryToTagMap.get(ar(e));t.listenProvider_.stopListening(hr(e),n)}))),function(t,e){for(var n=0;n<e.length;++n){var r=e[n];if(!r._queryParams.loadsAllData()){var i=ar(r),o=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(o)}}}(t,h)}return u}function $n(t,e,n){var r=e._path,i=null,a=!1;t.syncPointTree_.foreachOnPath(r,(function(t,e){var n=wt(t,r);i=i||Bn(e,n),a=a||Wn(e)}));var s,u=t.syncPointTree_.get(r);u?(a=a||Wn(u),i=i||Bn(u,ft())):(u=new Un,t.syncPointTree_=t.syncPointTree_.set(r,u)),null!=i?s=!0:(s=!1,i=re.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((function(t,e){var n=Bn(e,ft());n&&(i=i.updateImmediateChild(t,n))})));var c=Kn(u,e);if(!c&&!e._queryParams.loadsAllData()){var h=ar(e);(0,o.hu)(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");var l=zn++;t.queryToTagMap.set(h,l),t.tagToQueryMap.set(l,h)}var f=function(t,e,n,r,i,o){var a=jn(t,e,r,i,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),function(t,e){t.eventRegistrations_.push(e)}(a,n),function(t,e){var n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Xt,(function(t,e){r.push(ve(t,e))})),n.isFullyInitialized()&&r.push(pe(n.getNode())),Mn(t,r,n.getNode(),e)}(a,n)}(u,e,n,cn(t.pendingWriteTree_,r),i,s);if(!c&&!a){var d=Gn(u,e);f=f.concat(function(t,e,n){var r=e._path,i=or(t,e),a=ir(t,n),s=t.listenProvider_.startListening(hr(e),i,a.hashFn,a.onComplete),u=t.syncPointTree_.subtree(r);if(i)(0,o.hu)(!Wn(u.value),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold((function(t,e,n){if(!_t(t)&&e&&Wn(e))return[Hn(e).query];var r=[];return e&&(r=r.concat(Vn(e).map((function(t){return t.query})))),x(n,(function(t,e){r=r.concat(e)})),r})),h=0;h<c.length;++h){var l=c[h];t.listenProvider_.stopListening(hr(l),or(t,l))}return s}(t,e,d))}return f}function tr(t,e,n){var r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(function(t,n){var r=Bn(n,wt(t,e));if(r)return r}));return dn(r,e,i,n,!0)}function er(t,e){return nr(e,t.syncPointTree_,null,cn(t.pendingWriteTree_,ft()))}function nr(t,e,n,r){if(_t(t.path))return rr(t,e,n,r);var i=e.get(ft());null==n&&null!=i&&(n=Bn(i,ft()));var o=[],a=dt(t.path),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,h=bn(r,a);o=o.concat(nr(s,u,c,h))}return i&&(o=o.concat(qn(i,t,r,n))),o}function rr(t,e,n,r){var i=e.get(ft());null==n&&null!=i&&(n=Bn(i,ft()));var o=[];return e.children.inorderTraversal((function(e,i){var a=n?n.getImmediateChild(e):null,s=bn(r,e),u=t.operationForChild(e);u&&(o=o.concat(rr(u,i,a,s)))})),i&&(o=o.concat(qn(i,t,r,n))),o}function ir(t,e){var n=e.query,r=or(t,n);return{hashFn:function(){return(function(t){return t.viewCache_.serverCache.getNode()}(e)||re.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return r?function(t,e,n){var r=sr(t,n);if(r){var i=ur(r),o=i.path,a=i.queryId,s=wt(o,e);return cr(t,o,new qe(Me(a),s))}return[]}(t,n._path,r):function(t,e){return er(t,new qe({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}(e,n);return Zn(t,n,null,i)}}}function or(t,e){var n=ar(e);return t.queryToTagMap.get(n)}function ar(t){return t._path.toString()+"$"+t._queryIdentifier}function sr(t,e){return t.tagToQueryMap.get(e)}function ur(t){var e=t.indexOf("$");return(0,o.hu)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new lt(t.substr(0,e))}}function cr(t,e,n){var r=t.syncPointTree_.get(e);return(0,o.hu)(r,"Missing sync point for query tag that we're tracking"),qn(r,n,cn(t.pendingWriteTree_,e),null)}function hr(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new((0,o.hu)(Fn,"Reference.ts has not been loaded"),Fn)(t._repo,t._path):t}var lr=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){return new t(this.node_.getImmediateChild(e))},t.prototype.node=function(){return this.node_},t}(),fr=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=bt(this.path_,e);return new t(this.syncTree_,n)},t.prototype.node=function(){return tr(this.syncTree_,this.path_)},t}(),dr=function(t,e,n){return t&&"object"==typeof t?((0,o.hu)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?pr(t[".sv"],e,n):"object"==typeof t[".sv"]?vr(t[".sv"],e):void(0,o.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},pr=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:(0,o.hu)(!1,"Unexpected server value: "+t)}},vr=function(t,e,n){t.hasOwnProperty("increment")||(0,o.hu)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;"number"!=typeof r&&(0,o.hu)(!1,"Unexpected increment value: "+r);var i=e.node();if((0,o.hu)(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!=typeof a?r:a+r},gr=function(t,e,n,r){return yr(e,new fr(n,t),r)},mr=function(t,e,n){return yr(t,new lr(e),n)};function yr(t,e,n){var r,i=t.getPriority().val(),o=dr(i,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var a=t,s=dr(a.getValue(),e,n);return s!==a.getValue()||o!==a.getPriority().val()?new Yt(s,oe(o)):t}var u=t;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new Yt(o))),u.forEachChild(Xt,(function(t,i){var o=yr(i,e.getImmediateChild(t),n);o!==i&&(r=r.updateImmediateChild(t,o))})),r}var br=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n={children:{},childCount:0}),this.name=t,this.parent=e,this.node=n};function _r(t,e){for(var n=e instanceof lt?e:new lt(e),r=t,i=dt(n);null!==i;){var a=(0,o.DV)(r.node.children,i)||{children:{},childCount:0};r=new br(i,r,a),i=dt(n=vt(n))}return r}function wr(t){return t.node.value}function Ir(t,e){t.node.value=e,kr(t)}function Tr(t){return t.node.childCount>0}function Er(t,e){x(t.node.children,(function(n,r){e(new br(n,t,r))}))}function Sr(t,e,n,r){n&&!r&&e(t),Er(t,(function(t){Sr(t,e,!0,r)})),n&&r&&e(t)}function Cr(t){return new lt(null===t.parent?t.name:Cr(t.parent)+"/"+t.name)}function kr(t){null!==t.parent&&function(t,e,n){var r=function(t){return void 0===wr(t)&&!Tr(t)}(n),i=(0,o.r3)(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,kr(t)):r||i||(t.node.children[e]=n.node,t.node.childCount++,kr(t))}(t.parent,t.name,t)}var Nr=/[\[\].#$\/\u0000-\u001F\u007F]/,Ar=/[\[\].#$\u0000-\u001F\u007F]/,Dr=10485760,Pr=function(t){return"string"==typeof t&&0!==t.length&&!Nr.test(t)},Rr=function(t){return"string"==typeof t&&0!==t.length&&!Ar.test(t)},Or=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!C(t)||t&&"object"==typeof t&&(0,o.r3)(t,".sv")},xr=function(t,e,n,r){r&&void 0===e||Lr((0,o.gK)(t,"value"),e,n)},Lr=function(t,e,n){var r=n instanceof lt?new St(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+kt(r));if("function"==typeof e)throw new Error(t+"contains a function "+kt(r)+" with contents = "+e.toString());if(C(e))throw new Error(t+"contains "+e.toString()+" "+kt(r));if("string"==typeof e&&e.length>Dr/3&&(0,o.ug)(e)>Dr)throw new Error(t+"contains a string greater than 10485760 utf8 bytes "+kt(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var i=!1,a=!1;if(x(e,(function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(a=!0,!Pr(e)))throw new Error(t+" contains an invalid key ("+e+") "+kt(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var s,u;!function(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=(0,o.ug)(e),Ct(t)}(r,e),Lr(t,n,r),u=(s=r).parts_.pop(),s.byteLength_-=(0,o.ug)(u),s.parts_.length>0&&(s.byteLength_-=1)})),i&&a)throw new Error(t+' contains ".value" child '+kt(r)+" in addition to actual children.")}},Mr=function(t,e,n,r){if(!r||void 0!==e){var i=(0,o.gK)(t,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");var a=[];x(e,(function(t,e){var r=new lt(t);if(Lr(i,e,bt(n,r)),".priority"===gt(r)&&!Or(e))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)})),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=mt(r=e[n]),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!Pr(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(It);var a=null;for(n=0;n<e.length;n++){if(r=e[n],null!==a&&Et(a,r))throw new Error(t+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(i,a)}},Fr=function(t,e,n){if(!n||void 0!==e){if(C(e))throw new Error((0,o.gK)(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Or(e))throw new Error((0,o.gK)(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Ur=function(t,e,n){if(!n||void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,o.gK)(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},qr=function(t,e,n,r){if(!(r&&void 0===n||Pr(n)))throw new Error((0,o.gK)(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},jr=function(t,e,n,r){if(!(r&&void 0===n||Rr(n)))throw new Error((0,o.gK)(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Vr=function(t,e){if(".info"===dt(e))throw new Error(t+" failed = Can't modify data under /.info/")},Br=function(t,e){var n=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!Pr(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Rr(t)}(n))throw new Error((0,o.gK)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Gr=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error((0,o.gK)(t,e)+"must be a boolean.")},Kr=function(){this.eventLists_=[],this.recursionDepth_=0};function Wr(t,e){for(var n=null,r=0;r<e.length;r++){var i=e[r],o=i.getPath();null===n||Tt(o,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&t.eventLists_.push(n)}function Hr(t,e,n){Wr(t,n),Jr(t,(function(t){return Tt(t,e)}))}function zr(t,e,n){Wr(t,n),Jr(t,(function(t){return Et(t,e)||Et(e,t)}))}function Jr(t,e){t.recursionDepth_++;for(var n=!0,r=0;r<t.eventLists_.length;r++){var i=t.eventLists_[r];i&&(e(i.path)?(Qr(t.eventLists_[r]),t.eventLists_[r]=null):n=!1)}n&&(t.eventLists_=[]),t.recursionDepth_--}function Qr(t){for(var e=0;e<t.events.length;e++){var n=t.events[e];if(null!==n){t.events[e]=null;var r=n.getEventRunner();y&&w("event: "+n.toString()),U(r)}}}var Yr="repo_interrupt",Xr=function(){function t(t,e,n){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Kr,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ae(),this.transactionQueueTree_=new br,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t}();function Zr(t){var e=t.infoData_.getNode(new lt(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function $r(t){return(e=(e={timestamp:Zr(t)})||{}).timestamp=e.timestamp||(new Date).getTime(),e;var e}function ti(t,e,n,r,i){t.dataUpdateCount++;var a=new lt(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;var s=[];if(i)if(r){var u=(0,o.UI)(n,(function(t){return oe(t)}));s=function(t,e,n,r){var i=sr(t,r);if(i){var o=ur(i),a=o.path,s=o.queryId,u=wt(a,e),c=Ye.fromObject(n);return cr(t,a,new Ve(Me(s),u,c))}return[]}(t.serverSyncTree_,a,u,i)}else{var c=oe(n);s=function(t,e,n,r){var i=sr(t,r);if(null!=i){var o=ur(i),a=o.path,s=o.queryId,u=wt(a,e);return cr(t,a,new je(Me(s),u,n))}return[]}(t.serverSyncTree_,a,c,i)}else if(r){var h=(0,o.UI)(n,(function(t){return oe(t)}));s=function(t,e,n){var r=Ye.fromObject(n);return er(t,new Ve({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,a,h)}else{var l=oe(n);s=Xn(t.serverSyncTree_,a,l)}var f=a;s.length>0&&(f=di(t,a)),zr(t.eventQueue_,f,s)}function ei(t,e){ni(t,"connected",e),!1===e&&function(t){ci(t,"onDisconnectEvents");var e=$r(t),n=Ae();Re(t.onDisconnect_,ft(),(function(r,i){var o=gr(r,i,t.serverSyncTree_,e);De(n,r,o)}));var r=[];Re(n,ft(),(function(e,n){r=r.concat(Xn(t.serverSyncTree_,e,n));var i=yi(t,e);di(t,i)})),t.onDisconnect_=Ae(),zr(t.eventQueue_,ft(),r)}(t)}function ni(t,e,n){var r=new lt("/.info/"+e),i=oe(n);t.infoData_.updateSnapshot(r,i);var o=Xn(t.infoSyncTree_,r,i);zr(t.eventQueue_,r,o)}function ri(t){return t.nextWriteId_++}function ii(t,e,n,r,i){ci(t,"set",{path:e.toString(),value:n,priority:r});var o=$r(t),a=oe(n,r),s=tr(t.serverSyncTree_,e),u=mr(a,s,o),c=ri(t),h=Qn(t.serverSyncTree_,e,u,c,!0);Wr(t.eventQueue_,h),t.server_.put(e.toString(),a.val(!0),(function(n,r){var o="ok"===n;o||S("set at "+e+" failed: "+n);var a=Yn(t.serverSyncTree_,c,!o);zr(t.eventQueue_,e,a),hi(0,i,n,r)}));var l=yi(t,e);di(t,l),zr(t.eventQueue_,l,[])}function oi(t,e,n){t.server_.onDisconnectCancel(e.toString(),(function(r,i){"ok"===r&&Pe(t.onDisconnect_,e),hi(0,n,r,i)}))}function ai(t,e,n,r){var i=oe(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(function(n,o){"ok"===n&&De(t.onDisconnect_,e,i),hi(0,r,n,o)}))}function si(t,e,n){var r;r=".info"===dt(e._path)?Zn(t.infoSyncTree_,e,n):Zn(t.serverSyncTree_,e,n),Hr(t.eventQueue_,e._path,r)}function ui(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Yr)}function ci(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r="";t.persistentConnection_&&(r=t.persistentConnection_.id+":"),w.apply(void 0,(0,a.ev)([r],(0,a.CR)(e)))}function hi(t,e,n,r){e&&U((function(){if("ok"===n)e(null);else{var t=(n||"error").toUpperCase(),i=t;r&&(i+=": "+r);var o=new Error(i);o.code=t,e(o)}}))}function li(t,e,n){return tr(t.serverSyncTree_,e,n)||re.EMPTY_NODE}function fi(t,e){if(void 0===e&&(e=t.transactionQueueTree_),e||mi(t,e),wr(e)){var n=vi(t,e);(0,o.hu)(n.length>0,"Sending zero length transaction queue"),n.every((function(t){return 0===t.status}))&&function(t,e,n){for(var r=n.map((function(t){return t.currentWriteId})),i=li(t,e,r),a=i,s=i.hash(),u=0;u<n.length;u++){var c=n[u];(0,o.hu)(0===c.status,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=1,c.retryCount++;var h=wt(e,c.path);a=a.updateChild(h,c.currentOutputSnapshotRaw)}var l=a.val(!0),f=e;t.server_.put(f.toString(),l,(function(r){ci(t,"transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=function(e){n[e].status=2,i=i.concat(Yn(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&o.push((function(){return n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved)})),n[e].unwatcher()},s=0;s<n.length;s++)a(s);for(mi(t,_r(t.transactionQueueTree_,e)),fi(t,t.transactionQueueTree_),zr(t.eventQueue_,e,i),s=0;s<o.length;s++)U(o[s])}else{if("datastale"===r)for(s=0;s<n.length;s++)3===n[s].status?n[s].status=4:n[s].status=0;else for(S("transaction at "+f.toString()+" failed: "+r),s=0;s<n.length;s++)n[s].status=4,n[s].abortReason=r;di(t,e)}}),s)}(t,Cr(e),n)}else Tr(e)&&Er(e,(function(e){fi(t,e)}))}function di(t,e){var n=pi(t,e),r=Cr(n);return function(t,e,n){if(0!==e.length){for(var r=[],i=[],a=e.filter((function(t){return 0===t.status})).map((function(t){return t.currentWriteId})),s=function(s){var u,c,h=e[s],l=wt(n,h.path),f=!1;if((0,o.hu)(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===h.status)f=!0,u=h.abortReason,i=i.concat(Yn(t.serverSyncTree_,h.currentWriteId,!0));else if(0===h.status)if(h.retryCount>=25)f=!0,u="maxretry",i=i.concat(Yn(t.serverSyncTree_,h.currentWriteId,!0));else{var d=li(t,h.path,a);h.currentInputSnapshot=d;var p=e[s].update(d.val());if(void 0!==p){Lr("transaction failed: Data returned ",p,h.path);var v=oe(p);"object"==typeof p&&null!=p&&(0,o.r3)(p,".priority")||(v=v.updatePriority(d.getPriority()));var g=h.currentWriteId,m=$r(t),y=mr(v,d,m);h.currentOutputSnapshotRaw=v,h.currentOutputSnapshotResolved=y,h.currentWriteId=ri(t),a.splice(a.indexOf(g),1),i=(i=i.concat(Qn(t.serverSyncTree_,h.path,y,h.currentWriteId,h.applyLocally))).concat(Yn(t.serverSyncTree_,g,!0))}else f=!0,u="nodata",i=i.concat(Yn(t.serverSyncTree_,h.currentWriteId,!0))}zr(t.eventQueue_,n,i),i=[],f&&(e[s].status=2,c=e[s].unwatcher,setTimeout(c,Math.floor(0)),e[s].onComplete&&("nodata"===u?r.push((function(){return e[s].onComplete(null,!1,e[s].currentInputSnapshot)})):r.push((function(){return e[s].onComplete(new Error(u),!1,null)}))))},u=0;u<e.length;u++)s(u);for(mi(t,t.transactionQueueTree_),u=0;u<r.length;u++)U(r[u]);fi(t,t.transactionQueueTree_)}}(t,vi(t,n),r),r}function pi(t,e){var n,r=t.transactionQueueTree_;for(n=dt(e);null!==n&&void 0===wr(r);)r=_r(r,n),n=dt(e=vt(e));return r}function vi(t,e){var n=[];return gi(t,e,n),n.sort((function(t,e){return t.order-e.order})),n}function gi(t,e,n){var r=wr(e);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);Er(e,(function(e){gi(t,e,n)}))}function mi(t,e){var n=wr(e);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,Ir(e,n.length>0?n:void 0)}Er(e,(function(e){mi(t,e)}))}function yi(t,e){var n=Cr(pi(t,e)),r=_r(t.transactionQueueTree_,e);return function(t,e,n){for(var r=t.parent;null!==r;){if(e(r))return!0;r=r.parent}}(r,(function(e){bi(t,e)})),bi(t,r),Sr(r,(function(e){bi(t,e)})),n}function bi(t,e){var n=wr(e);if(n){for(var r=[],i=[],a=-1,s=0;s<n.length;s++)3===n[s].status||(1===n[s].status?((0,o.hu)(a===s-1,"All SENT items should be at beginning of queue."),a=s,n[s].status=3,n[s].abortReason="set"):((0,o.hu)(0===n[s].status,"Unexpected transaction status in abort"),n[s].unwatcher(),i=i.concat(Yn(t.serverSyncTree_,n[s].currentWriteId,!0)),n[s].onComplete&&r.push(n[s].onComplete.bind(null,new Error("set"),!1,null))));for(-1===a?Ir(e,void 0):n.length=a+1,zr(t.eventQueue_,Cr(e),i),s=0;s<r.length;s++)U(r[s])}}var _i=function(t,e){var n=wi(t),r=n.namespace;"firebase.com"===n.domain&&E(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||E("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&S("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new W(n.host,n.secure,r,e,i,"",r!==n.subdomain),path:new lt(n.pathString)}},wi=function(t){var e="",n="",r="",i="",o="",s=!0,u="https",c=443;if("string"==typeof t){var h=t.indexOf("//");h>=0&&(u=t.substring(0,h-1),t=t.substring(h+2));var l=t.indexOf("/");-1===l&&(l=t.length);var f=t.indexOf("?");-1===f&&(f=t.length),e=t.substring(0,Math.min(l,f)),l<f&&(i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(l,f)));var d=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var i=(0,a.XA)(t.split("&")),o=i.next();!o.done;o=i.next()){var s=o.value;if(0!==s.length){var u=s.split("=");2===u.length?r[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):S("Invalid query segment '"+s+"' in query '"+t+"'")}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,f)));(h=e.indexOf(":"))>=0?(s="https"===u||"wss"===u,c=parseInt(e.substring(h+1),10)):h=e.length;var p=e.slice(0,h);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),n=e.substring(v+1),o=r}"ns"in d&&(o=d.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:s,scheme:u,pathString:i,namespace:o}},Ii=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+(0,o.Pz)(this.snapshot.exportVal())},t}(),Ti=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),Ei=function(){function t(t,e){this.snapshotCallback=t,this.cancelCallback=e}return t.prototype.onValue=function(t,e){this.snapshotCallback.call(null,t,e)},t.prototype.onCancel=function(t){return(0,o.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)},Object.defineProperty(t.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),t.prototype.matches=function(t){return this.snapshotCallback===t.snapshotCallback||this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context},t}(),Si=function(){function t(t,e){this._repo=t,this._path=e}return t.prototype.cancel=function(){var t=new o.BH;return oi(this._repo,this._path,t.wrapCallback((function(){}))),t.promise},t.prototype.remove=function(){Vr("OnDisconnect.remove",this._path);var t=new o.BH;return ai(this._repo,this._path,null,t.wrapCallback((function(){}))),t.promise},t.prototype.set=function(t){Vr("OnDisconnect.set",this._path),xr("OnDisconnect.set",t,this._path,!1);var e=new o.BH;return ai(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t.prototype.setWithPriority=function(t,e){Vr("OnDisconnect.setWithPriority",this._path),xr("OnDisconnect.setWithPriority",t,this._path,!1),Fr("OnDisconnect.setWithPriority",e,!1);var n=new o.BH;return function(t,e,n,r,i){var o=oe(n,r);t.server_.onDisconnectPut(e.toString(),o.val(!0),(function(n,r){"ok"===n&&De(t.onDisconnect_,e,o),hi(0,i,n,r)}))}(this._repo,this._path,t,e,n.wrapCallback((function(){}))),n.promise},t.prototype.update=function(t){Vr("OnDisconnect.update",this._path),Mr("OnDisconnect.update",t,this._path,!1);var e=new o.BH;return function(t,e,n,r){if((0,o.xb)(n))return w("onDisconnect().update() called with empty data.  Don't do anything."),void hi(0,r,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,(function(i,o){"ok"===i&&x(n,(function(n,r){var i=oe(r);De(t.onDisconnect_,bt(e,n),i)})),hi(0,r,i,o)}))}(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t}(),Ci=function(){function t(t,e,n,r){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=r}return Object.defineProperty(t.prototype,"key",{get:function(){return _t(this._path)?null:gt(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Di(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryIdentifier",{get:function(){var t=Ce(this._queryParams),e=R(t);return"{}"===e?"default":e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryObject",{get:function(){return Ce(this._queryParams)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!((e=(0,o.m9)(e))instanceof t))return!1;var n=this._repo===e._repo,r=Tt(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i},t.prototype.toJSON=function(){return this.toString()},t.prototype.toString=function(){return this._repo.toString()+function(t){for(var e="",n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)},t}();function ki(t,e){if(!0===t._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function Ni(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Mt){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==k)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==N)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===Xt){if(null!=e&&!Or(e)||null!=n&&!Or(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,o.hu)(t.getIndex()instanceof ue||t.getIndex()===ce,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Ai(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Di=function(t){function e(e,n){return t.call(this,e,n,new we,!1)||this}return(0,a.ZT)(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){var t=yt(this._path);return null===t?null:new e(this._repo,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){for(var t=this;null!==t.parent;)t=t.parent;return t},enumerable:!1,configurable:!0}),e}(Ci),Pi=function(){function t(t,e,n){this._node=t,this.ref=e,this._index=n}return Object.defineProperty(t.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),t.prototype.child=function(e){var n=new lt(e),r=xi(this.ref,e);return new t(this._node.getChild(n),r,Xt)},t.prototype.exists=function(){return!this._node.isEmpty()},t.prototype.exportVal=function(){return this._node.val(!0)},t.prototype.forEach=function(e){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return e(new t(i,xi(n.ref,r),Xt))}))},t.prototype.hasChild=function(t){var e=new lt(t);return!this._node.getChild(e).isEmpty()},t.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},t.prototype.toJSON=function(){return this.exportVal()},t.prototype.val=function(){return this._node.val()},t}();function Ri(t,e){return(t=(0,o.m9)(t))._checkNotDeleted("ref"),void 0!==e?xi(t._root,e):t._root}function Oi(t,e){(t=(0,o.m9)(t))._checkNotDeleted("refFromURL");var n=_i(e,t._repo.repoInfo_.nodeAdmin);Br("refFromURL",n);var r=n.repoInfo;return t._repo.repoInfo_.isCustomHost()||r.host===t._repo.repoInfo_.host||E("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),Ri(t,n.path.toString())}function xi(t,e){var n;return null===dt((t=(0,o.m9)(t))._path)?("child","path",!1,(n=e)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),jr("child","path",n,false)):jr("child","path",e,!1),new Di(t._repo,bt(t._path,e))}function Li(t,e){t=(0,o.m9)(t),Vr("push",t._path),xr("push",e,t._path,!0);var n,r=Zr(t._repo),i=le(r),a=xi(t,i),s=xi(t,i);return n=null!=e?Fi(s,e).then((function(){return s})):Promise.resolve(s),a.then=n.then.bind(n),a.catch=n.then.bind(n,void 0),a}function Mi(t){return Vr("remove",t._path),Fi(t,null)}function Fi(t,e){t=(0,o.m9)(t),Vr("set",t._path),xr("set",e,t._path,!1);var n=new o.BH;return ii(t._repo,t._path,e,null,n.wrapCallback((function(){}))),n.promise}function Ui(t,e){t=(0,o.m9)(t),Vr("setPriority",t._path),Fr("setPriority",e,!1);var n=new o.BH;return ii(t._repo,bt(t._path,".priority"),e,null,n.wrapCallback((function(){}))),n.promise}function qi(t,e,n){if(Vr("setWithPriority",t._path),xr("setWithPriority",e,t._path,!1),Fr("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";var r=new o.BH;return ii(t._repo,t._path,e,n,r.wrapCallback((function(){}))),r.promise}function ji(t,e){Mr("update",e,t._path,!1);var n=new o.BH;return function(t,e,n,r){ci(t,"update",{path:e.toString(),value:n});var i=!0,a=$r(t),s={};if(x(n,(function(n,r){i=!1,s[n]=gr(bt(e,n),oe(r),t.serverSyncTree_,a)})),i)w("update() called with empty data.  Don't do anything."),hi(0,r,"ok",void 0);else{var u=ri(t),c=function(t,e,n,r){!function(t,e,n,r){(0,o.hu)(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=$e(t.visibleWrites,e,n),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r);var i=Ye.fromObject(n);return er(t,new Ve({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(t.serverSyncTree_,e,s,u);Wr(t.eventQueue_,c),t.server_.merge(e.toString(),n,(function(n,i){var o="ok"===n;o||S("update at "+e+" failed: "+n);var a=Yn(t.serverSyncTree_,u,!o),s=a.length>0?di(t,e):e;zr(t.eventQueue_,s,a),hi(0,r,n,i)})),x(n,(function(n){var r=yi(t,bt(e,n));di(t,r)})),zr(t.eventQueue_,e,[])}}(t._repo,t._path,e,n.wrapCallback((function(){}))),n.promise}function Vi(t){return function(t,e){var n=function(t,e){var n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(function(t,e){var i=wt(t,n);r=r||Bn(e,i)}));var i=t.syncPointTree_.get(n);i?r=r||Bn(i,ft()):(i=new Un,t.syncPointTree_=t.syncPointTree_.set(n,i));var o=null!=r,a=o?new Be(r,!0,!1):null;return Je(jn(i,e,cn(t.pendingWriteTree_,e._path),o?a.getNode():re.EMPTY_NODE,o).viewCache_)}(t.serverSyncTree_,e);return null!=n?Promise.resolve(n):t.server_.get(e).then((function(n){var r=oe(n),i=Xn(t.serverSyncTree_,e._path,r);return Hr(t.eventQueue_,e._path,i),Promise.resolve(r)}),(function(n){return ci(t,"get for query "+(0,o.Pz)(e)+" failed: "+n),Promise.reject(new Error(n))}))}((t=(0,o.m9)(t))._repo,t).then((function(e){return new Pi(e,new Di(t._repo,t._path),t._queryParams.getIndex())}))}var Bi=function(){function t(t){this.callbackContext=t}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e._queryParams.getIndex();return new Ii("value",this,new Pi(t.snapshotNode,new Di(e._repo,e._path),n))},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,null)}},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new Ti(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))},t.prototype.hasAnyCallback=function(){return null!==this.callbackContext},t}(),Gi=function(){function t(t){this.callbacks=t}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,(0,o.r3)(this.callbacks,e)},t.prototype.createCancelEvent=function(t,e){return this.callbacks.cancel.hasCancelCallback?new Ti(this,t,e):null},t.prototype.createEvent=function(t,e){(0,o.hu)(null!=t.childName,"Child events should have a childName.");var n=xi(new Di(e._repo,e._path),t.childName),r=e._queryParams.getIndex();return new Ii(t.type,this,new Pi(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){if("cancel"===t.getEventType()){var e=this.callbacks.cancel;return function(){return e.onCancel(t.error)}}var n=this.callbacks[t.eventType];return function(){return n.onValue(t.snapshot,t.prevName)}},t.prototype.matches=function(e){var n=this;if(e instanceof t){if(!this.callbacks||!e.callbacks)return!0;var r=Object.keys(e.callbacks),i=Object.keys(this.callbacks),o=r.length;if(o===i.length){if(1===o){var a=r[0],s=i[0];return s===a&&(!e.callbacks[a]||!this.callbacks[s]||e.callbacks[a].matches(this.callbacks[s]))}return i.every((function(t){return e.callbacks[t].matches(n.callbacks[t])}))}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks},t}();function Ki(t,e,n,r,i){var o,a;if("object"==typeof r&&(a=void 0,i=r),"function"==typeof r&&(a=r),i&&i.onlyOnce){var s=n,u=function(e,n){s(e,n),si(t._repo,t,h)};u.userCallback=n.userCallback,u.context=n.context,n=u}var c=new Ei(n,a||void 0),h="value"===e?new Bi(c):new Gi(((o={})[e]=c,o));return function(t,e,n){var r;r=".info"===dt(e._path)?$n(t.infoSyncTree_,e,n):$n(t.serverSyncTree_,e,n),Hr(t.eventQueue_,e._path,r)}(t._repo,t,h),function(){return si(t._repo,t,h)}}function Wi(t,e,n,r){return Ki(t,"value",e,n,r)}function Hi(t,e,n,r){return Ki(t,"child_added",e,n,r)}function zi(t,e,n,r){return Ki(t,"child_changed",e,n,r)}function Ji(t,e,n,r){return Ki(t,"child_moved",e,n,r)}function Qi(t,e,n,r){return Ki(t,"child_removed",e,n,r)}function Yi(t,e,n){var r=null,i=null,o=n?new Ei(n):null;"value"===e?r=new Bi(o):e&&(n&&((i={})[e]=o),r=new Gi(i)),si(t._repo,t,r)}var Xi=function(){},Zi=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.ZT)(e,t),e.prototype._apply=function(t){xr("endAt",this._value,t._path,!0);var e=Te(t._queryParams,this._value,this._key);if(Ai(e),Ni(e),t._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ci(t._repo,t._path,e,t._orderByCalled)},e}(Xi);function $i(t,e){return qr("endAt","key",e,!0),new Zi(t,e)}var to=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.ZT)(e,t),e.prototype._apply=function(t){xr("endBefore",this._value,t._path,!1);var e,n,r,i,o=(e=t._queryParams,n=this._value,r=this._key,e.index_===Mt?("string"==typeof n&&(n=de(n)),i=Te(e,n,r)):i=Te(e,n,null==r?k:de(r)),i.endBeforeSet_=!0,i);if(Ai(o),Ni(o),t._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ci(t._repo,t._path,o,t._orderByCalled)},e}(Xi);function eo(t,e){return qr("endBefore","key",e,!0),new to(t,e)}var no=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.ZT)(e,t),e.prototype._apply=function(t){xr("startAt",this._value,t._path,!0);var e=Ie(t._queryParams,this._value,this._key);if(Ai(e),Ni(e),t._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Ci(t._repo,t._path,e,t._orderByCalled)},e}(Xi);function ro(t,e){return void 0===t&&(t=null),qr("startAt","key",e,!0),new no(t,e)}var io=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.ZT)(e,t),e.prototype._apply=function(t){xr("startAfter",this._value,t._path,!1);var e,n,r,i,o=(e=t._queryParams,n=this._value,r=this._key,e.index_===Mt?("string"==typeof n&&(n=fe(n)),i=Ie(e,n,r)):i=Ie(e,n,null==r?N:fe(r)),i.startAfterSet_=!0,i);if(Ai(o),Ni(o),t._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Ci(t._repo,t._path,o,t._orderByCalled)},e}(Xi);function oo(t,e){return qr("startAfter","key",e,!0),new io(t,e)}var ao=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return(0,a.ZT)(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ci(t._repo,t._path,(e=t._queryParams,n=this._limit,(r=e.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="l",r),t._orderByCalled);var e,n,r},e}(Xi);function so(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new ao(t)}var uo=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return(0,a.ZT)(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ci(t._repo,t._path,(e=t._queryParams,n=this._limit,(r=e.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="r",r),t._orderByCalled);var e,n,r},e}(Xi);function co(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new uo(t)}var ho=function(t){function e(e){var n=t.call(this)||this;return n._path=e,n}return(0,a.ZT)(e,t),e.prototype._apply=function(t){ki(t,"orderByChild");var e=new lt(this._path);if(_t(e))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new ue(e),r=Ee(t._queryParams,n);return Ni(r),new Ci(t._repo,t._path,r,!0)},e}(Xi);function lo(t){if("$key"===t)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return jr("orderByChild","path",t,!1),new ho(t)}var fo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.ZT)(e,t),e.prototype._apply=function(t){ki(t,"orderByKey");var e=Ee(t._queryParams,Mt);return Ni(e),new Ci(t._repo,t._path,e,!0)},e}(Xi);function po(){return new fo}var vo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.ZT)(e,t),e.prototype._apply=function(t){ki(t,"orderByPriority");var e=Ee(t._queryParams,Xt);return Ni(e),new Ci(t._repo,t._path,e,!0)},e}(Xi);function go(){return new vo}var mo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.ZT)(e,t),e.prototype._apply=function(t){ki(t,"orderByValue");var e=Ee(t._queryParams,ce);return Ni(e),new Ci(t._repo,t._path,e,!0)},e}(Xi);function yo(){return new mo}var bo=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.ZT)(e,t),e.prototype._apply=function(t){if(xr("equalTo",this._value,t._path,!1),t._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(t._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Zi(this._value,this._key)._apply(new no(this._value,this._key)._apply(t))},e}(Xi);function _o(t,e){return qr("equalTo","key",e,!0),new bo(t,e)}function wo(t){for(var e,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var s=(0,o.m9)(t);try{for(var u=(0,a.XA)(r),c=u.next();!c.done;c=u.next()){var h=c.value;s=h._apply(s)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return s}!function(t){(0,o.hu)(!Dn,"__referenceConstructor has already been defined"),Dn=t}(Di),function(t){(0,o.hu)(!Fn,"__referenceConstructor has already been defined"),Fn=t}(Di);var Io={},To=!1;function Eo(t,e,n,r){var i=n||t.options.databaseURL;void 0===i&&(t.options.projectId||E("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),w("Using default host for project ",t.options.projectId),i=t.options.projectId+"-default-rtdb.firebaseio.com");var o,a=_i(i,r),s=a.repoInfo,u=void 0;"undefined"!=typeof process&&(u=process.env.FIREBASE_DATABASE_EMULATOR_HOST),u?(o=!0,i="http://"+u+"?ns="+s.namespace,s=(a=_i(i,r)).repoInfo):o=!a.repoInfo.secure;var c=r&&o?new V:new j(t.name,t.options,e);Br("Invalid Firebase Database URL",a),_t(a.path)||E("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(t,e,n){var r=Io[e.name];r||(r={},Io[e.name]=r);var i=r[t.toURLString()];return i&&E("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new Xr(t,To,n),r[t.toURLString()]=i,i}(s,t,c);return new So(h,t)}var So=function(){function t(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}return Object.defineProperty(t.prototype,"_repo",{get:function(){return this._instanceStarted||(function(t,e,n){if(t.stats_=Y(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new ke(t.repoInfo_,(function(e,n,r,i){ti(t,e,n,r,i)}),t.authTokenProvider_),setTimeout((function(){return ei(t,!0)}),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,o.Pz)(n)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}t.persistentConnection_=new Rt(t.repoInfo_,e,(function(e,n,r,i){ti(t,e,n,r,i)}),(function(e){ei(t,e)}),(function(e){!function(t,e){x(e,(function(e,n){ni(t,e,n)}))}(t,e)}),t.authTokenProvider_,n),t.server_=t.persistentConnection_}var r,i;t.authTokenProvider_.addTokenChangeListener((function(e){t.server_.refreshAuthToken(e)})),t.statsReporter_=(r=function(){return new Le(t.stats_,t.server_)},i=t.repoInfo_.toString(),Q[i]||(Q[i]=r()),Q[i]),t.infoData_=new Ne,t.infoSyncTree_=new Jn({startListening:function(e,n,r,i){var o=[],a=t.infoData_.getNode(e._path);return a.isEmpty()||(o=Xn(t.infoSyncTree_,e._path,a),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),ni(t,"connected",!1),t.serverSyncTree_=new Jn({startListening:function(e,n,r,i){return t.server_.listen(e,r,n,(function(n,r){var o=i(n,r);zr(t.eventQueue_,e._path,o)})),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new Di(this._repo,ft())),this._rootInternal},enumerable:!1,configurable:!0}),t.prototype._delete=function(){var t,e,n;return this._checkNotDeleted("delete"),t=this._repo,e=this.app.name,(n=Io[e])&&n[t.key]===t||E("Database "+e+"("+t.repoInfo_+") has already been deleted."),ui(t),delete n[t.key],this._repoInternal=null,this._rootInternal=null,Promise.resolve()},t.prototype._checkNotDeleted=function(t){null===this._rootInternal&&E("Cannot call "+t+" on a deleted database.")},t}();function Co(t){(t=(0,o.m9)(t))._checkNotDeleted("goOffline"),ui(t._repo)}function ko(t){var e;(t=(0,o.m9)(t))._checkNotDeleted("goOnline"),(e=t._repo).persistentConnection_&&e.persistentConnection_.resume(Yr)}function No(t,e){_(t,e)}var Ao={".sv":"timestamp"},Do=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}();function Po(t,e,n){var r;if(t=(0,o.m9)(t),Vr("Reference.transaction",t._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";var i=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,a=new o.BH,s=Wi(t,(function(){}));return function(e,n,r,i,s,u){ci(e,"transaction on "+n);var c={path:n,update:r,onComplete:function(e,n,r){var i=null;e?a.reject(e):(i=new Pi(r,new Di(t._repo,t._path),Xt),a.resolve(new Do(n,i)))},status:null,order:v(),applyLocally:u,retryCount:0,unwatcher:s,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},h=li(e,n,void 0);c.currentInputSnapshot=h;var l=c.update(h.val());if(void 0===l)c.unwatcher(),c.currentOutputSnapshotRaw=null,c.currentOutputSnapshotResolved=null,c.onComplete&&c.onComplete(null,!1,c.currentInputSnapshot);else{Lr("transaction failed: Data returned ",l,c.path),c.status=0;var f=_r(e.transactionQueueTree_,n),d=wr(f)||[];d.push(c),Ir(f,d);var p=void 0;"object"==typeof l&&null!==l&&(0,o.r3)(l,".priority")?(p=(0,o.DV)(l,".priority"),(0,o.hu)(Or(p),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):p=(tr(e.serverSyncTree_,n)||re.EMPTY_NODE).getPriority().val();var g=$r(e),m=oe(l,p),y=mr(m,h,g);c.currentOutputSnapshotRaw=m,c.currentOutputSnapshotResolved=y,c.currentWriteId=ri(e);var b=Qn(e.serverSyncTree_,n,y,c.currentWriteId,c.applyLocally);zr(e.eventQueue_,n,b),fi(e,e.transactionQueueTree_)}}(t._repo,t._path,e,0,s,i),a.promise}var Ro=function(){function t(t){this._delegate=t}return t.prototype.cancel=function(t){(0,o.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,o.Wj)("OnDisconnect.cancel","onComplete",t,!0);var e=this._delegate.cancel();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.remove=function(t){(0,o.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,o.Wj)("OnDisconnect.remove","onComplete",t,!0);var e=this._delegate.remove();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.set=function(t,e){(0,o.Dv)("OnDisconnect.set",1,2,arguments.length),(0,o.Wj)("OnDisconnect.set","onComplete",e,!0);var n=this._delegate.set(t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},t.prototype.setWithPriority=function(t,e,n){(0,o.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,o.Wj)("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},t.prototype.update=function(t,e){if((0,o.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,S("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,o.Wj)("OnDisconnect.update","onComplete",e,!0);var i=this._delegate.update(t);return e&&i.then((function(){return e(null)}),(function(t){return e(t)})),i},t}(),Oo=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return(0,o.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),xo=function(){function t(t,e){this._database=t,this._delegate=e}return t.prototype.val=function(){return(0,o.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},t.prototype.exportVal=function(){return(0,o.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},t.prototype.toJSON=function(){return(0,o.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.exists=function(){return(0,o.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},t.prototype.child=function(e){return(0,o.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),jr("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))},t.prototype.hasChild=function(t){return(0,o.Dv)("DataSnapshot.hasChild",1,1,arguments.length),jr("DataSnapshot.hasChild","path",t,!1),this._delegate.hasChild(t)},t.prototype.getPriority=function(){return(0,o.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},t.prototype.forEach=function(e){var n=this;return(0,o.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,o.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((function(r){return e(new t(n._database,r))}))},t.prototype.hasChildren=function(){return(0,o.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(t.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return(0,o.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},t.prototype.getRef=function(){return(0,o.Dv)("DataSnapshot.ref",0,0,arguments.length),new Mo(this._database,this._delegate.ref)},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),Lo=function(){function t(t,e){this.database=t,this._delegate=e}return t.prototype.on=function(e,n,r,i){var a,s=this;(0,o.Dv)("Query.on",2,4,arguments.length),(0,o.Wj)("Query.on","callback",n,!1);var u=t.getCancelAndContextArgs_("Query.on",r,i),c=function(t,e){n.call(u.context,new xo(s.database,t),e)};c.userCallback=n,c.context=u.context;var h=null===(a=u.cancel)||void 0===a?void 0:a.bind(u.context);switch(e){case"value":return Wi(this._delegate,c,h),n;case"child_added":return Hi(this._delegate,c,h),n;case"child_removed":return Qi(this._delegate,c,h),n;case"child_changed":return zi(this._delegate,c,h),n;case"child_moved":return Ji(this._delegate,c,h),n;default:throw new Error((0,o.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},t.prototype.off=function(t,e,n){if((0,o.Dv)("Query.off",0,3,arguments.length),Ur("Query.off",t,!0),(0,o.Wj)("Query.off","callback",e,!0),(0,o.lb)("Query.off","context",n,!0),e){var r=function(){};r.userCallback=e,r.context=n,Yi(this._delegate,t,r)}else Yi(this._delegate,t)},t.prototype.get=function(){var t=this;return Vi(this._delegate).then((function(e){return new xo(t.database,e)}))},t.prototype.once=function(e,n,r,i){var a=this;(0,o.Dv)("Query.once",1,4,arguments.length),(0,o.Wj)("Query.once","callback",n,!0);var s=t.getCancelAndContextArgs_("Query.on",r,i),u=new o.BH,c=function(t,e){var r=new xo(a.database,t);n&&n.call(s.context,r,e),u.resolve(r)};c.userCallback=n,c.context=s.context;var h=function(t){s.cancel&&s.cancel.call(s.context,t),u.reject(t)};switch(e){case"value":Wi(this._delegate,c,h,{onlyOnce:!0});break;case"child_added":Hi(this._delegate,c,h,{onlyOnce:!0});break;case"child_removed":Qi(this._delegate,c,h,{onlyOnce:!0});break;case"child_changed":zi(this._delegate,c,h,{onlyOnce:!0});break;case"child_moved":Ji(this._delegate,c,h,{onlyOnce:!0});break;default:throw new Error((0,o.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return u.promise},t.prototype.limitToFirst=function(e){return(0,o.Dv)("Query.limitToFirst",1,1,arguments.length),new t(this.database,wo(this._delegate,so(e)))},t.prototype.limitToLast=function(e){return(0,o.Dv)("Query.limitToLast",1,1,arguments.length),new t(this.database,wo(this._delegate,co(e)))},t.prototype.orderByChild=function(e){return(0,o.Dv)("Query.orderByChild",1,1,arguments.length),new t(this.database,wo(this._delegate,lo(e)))},t.prototype.orderByKey=function(){return(0,o.Dv)("Query.orderByKey",0,0,arguments.length),new t(this.database,wo(this._delegate,po()))},t.prototype.orderByPriority=function(){return(0,o.Dv)("Query.orderByPriority",0,0,arguments.length),new t(this.database,wo(this._delegate,go()))},t.prototype.orderByValue=function(){return(0,o.Dv)("Query.orderByValue",0,0,arguments.length),new t(this.database,wo(this._delegate,yo()))},t.prototype.startAt=function(e,n){return void 0===e&&(e=null),(0,o.Dv)("Query.startAt",0,2,arguments.length),new t(this.database,wo(this._delegate,ro(e,n)))},t.prototype.startAfter=function(e,n){return void 0===e&&(e=null),(0,o.Dv)("Query.startAfter",0,2,arguments.length),new t(this.database,wo(this._delegate,oo(e,n)))},t.prototype.endAt=function(e,n){return void 0===e&&(e=null),(0,o.Dv)("Query.endAt",0,2,arguments.length),new t(this.database,wo(this._delegate,$i(e,n)))},t.prototype.endBefore=function(e,n){return void 0===e&&(e=null),(0,o.Dv)("Query.endBefore",0,2,arguments.length),new t(this.database,wo(this._delegate,eo(e,n)))},t.prototype.equalTo=function(e,n){return(0,o.Dv)("Query.equalTo",1,2,arguments.length),new t(this.database,wo(this._delegate,_o(e,n)))},t.prototype.toString=function(){return(0,o.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()},t.prototype.toJSON=function(){return(0,o.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.isEqual=function(e){if((0,o.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:void 0,context:void 0};if(e&&n)r.cancel=e,(0,o.Wj)(t,"cancel",r.cancel,!0),r.context=n,(0,o.lb)(t,"context",r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error((0,o.gK)(t,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return new Mo(this.database,new Di(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),t}(),Mo=function(t){function e(e,n){var r=t.call(this,e,new Ci(n._repo,n._path,new we,!1))||this;return r.database=e,r._delegate=n,r}return(0,a.ZT)(e,t),e.prototype.getKey=function(){return(0,o.Dv)("Reference.key",0,0,arguments.length),this._delegate.key},e.prototype.child=function(t){return(0,o.Dv)("Reference.child",1,1,arguments.length),"number"==typeof t&&(t=String(t)),new e(this.database,xi(this._delegate,t))},e.prototype.getParent=function(){(0,o.Dv)("Reference.parent",0,0,arguments.length);var t=this._delegate.parent;return t?new e(this.database,t):null},e.prototype.getRoot=function(){return(0,o.Dv)("Reference.root",0,0,arguments.length),new e(this.database,this._delegate.root)},e.prototype.set=function(t,e){(0,o.Dv)("Reference.set",1,2,arguments.length),(0,o.Wj)("Reference.set","onComplete",e,!0);var n=Fi(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.update=function(t,e){if((0,o.Dv)("Reference.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,S("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Vr("Reference.update",this._delegate._path),(0,o.Wj)("Reference.update","onComplete",e,!0);var i=ji(this._delegate,t);return e&&i.then((function(){return e(null)}),(function(t){return e(t)})),i},e.prototype.setWithPriority=function(t,e,n){(0,o.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,o.Wj)("Reference.setWithPriority","onComplete",n,!0);var r=qi(this._delegate,t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},e.prototype.remove=function(t){(0,o.Dv)("Reference.remove",0,1,arguments.length),(0,o.Wj)("Reference.remove","onComplete",t,!0);var e=Mi(this._delegate);return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},e.prototype.transaction=function(t,e,n){var r=this;(0,o.Dv)("Reference.transaction",1,3,arguments.length),(0,o.Wj)("Reference.transaction","transactionUpdate",t,!1),(0,o.Wj)("Reference.transaction","onComplete",e,!0),Gr("Reference.transaction","applyLocally",n,!0);var i=Po(this._delegate,t,{applyLocally:n}).then((function(t){return new Oo(t.committed,new xo(r.database,t.snapshot))}));return e&&i.then((function(t){return e(null,t.committed,t.snapshot)}),(function(t){return e(t,!1,null)})),i},e.prototype.setPriority=function(t,e){(0,o.Dv)("Reference.setPriority",1,2,arguments.length),(0,o.Wj)("Reference.setPriority","onComplete",e,!0);var n=Ui(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.push=function(t,n){var r=this;(0,o.Dv)("Reference.push",0,2,arguments.length),(0,o.Wj)("Reference.push","onComplete",n,!0);var i=Li(this._delegate,t),a=i.then((function(t){return new e(r.database,t)}));n&&a.then((function(){return n(null)}),(function(t){return n(t)}));var s=new e(this.database,i);return s.then=a.then.bind(a),s.catch=a.catch.bind(a,void 0),s},e.prototype.onDisconnect=function(){return Vr("Reference.onDisconnect",this._delegate._path),new Ro(new Si(this._delegate._repo,this._delegate._path))},Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(Lo),Fo=function(){function t(t,e){var n=this;this._delegate=t,this.app=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return t.prototype.useEmulator=function(t,e){!function(t,e,n){(t=(0,o.m9)(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&E("Cannot call useEmulator() after instance has already been initialized."),function(t,e,n){t.repoInfo_=new W(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),t.repoInfo_.nodeAdmin&&(t.authTokenProvider_=new V)}(t._repo,e,n)}(this._delegate,t,e)},t.prototype.ref=function(t){if((0,o.Dv)("database.ref",0,1,arguments.length),t instanceof Mo){var e=Oi(this._delegate,t.toString());return new Mo(this,e)}return e=Ri(this._delegate,t),new Mo(this,e)},t.prototype.refFromURL=function(t){var e="database.refFromURL";(0,o.Dv)(e,1,1,arguments.length);var n=Oi(this._delegate,t);return new Mo(this,n)},t.prototype.goOffline=function(){return(0,o.Dv)("database.goOffline",0,0,arguments.length),Co(this._delegate)},t.prototype.goOnline=function(){return(0,o.Dv)("database.goOnline",0,0,arguments.length),ko(this._delegate)},t.ServerValue={TIMESTAMP:Ao,increment:function(t){return function(t){return{".sv":{increment:t}}}(t)}},t}(),Uo=Object.freeze({__proto__:null,forceLongPolling:function(){ot.forceDisallow(),tt.forceAllow()},forceWebSockets:function(){tt.forceDisallow()},isWebSocketsAvailable:function(){return ot.isAvailable()},setSecurityDebugCallback:function(t,e){t._delegate._repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){!function(t,e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var n;e?(t.statsListener_||(t.statsListener_=new xe(t.stats_)),n=t.statsListener_.get()):n=t.stats_.get();var r=Object.keys(n).reduce((function(t,e){return Math.max(e.length,t)}),0);x(n,(function(t,e){for(var n=t,i=t.length;i<r+2;i++)n+=" ";console.log(n+e)}))}}(t._delegate._repo,e)},statsIncrementCounter:function(t,e){!function(t,e){var n;t.stats_.incrementCounter(e),n=e,t.statsReporter_.statsToReport_[n]=!0}(t._delegate._repo,e)},dataUpdateCount:function(t){return t._delegate._repo.dataUpdateCount},interceptServerData:function(t,e){return function(t,e){t.interceptServerDataCallback_=e}(t._delegate._repo,e)},initStandalone:function(t){var e=t.app,n=t.url,r=t.version,o=t.customAuthImpl,a=t.namespace,s=t.nodeAdmin,u=void 0!==s&&s;rt(r);var c=new i.zt("auth-internal",new i.H0("database-standalone"));return c.setComponent(new i.wA("auth-internal",(function(){return o}),"PRIVATE")),{instance:new Fo(Eo(e,c,n,u),e),namespace:a}}}),qo=Rt;Rt.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},Rt.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var jo=st,Vo=W,Bo=Object.freeze({__proto__:null,DataConnection:qo,RealTimeConnection:jo,hijackHash:function(t){var e=Rt.prototype.put;return Rt.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){Rt.prototype.put=e}},ConnectionTarget:Vo,queryIdentifier:function(t){return t._delegate._queryIdentifier},forceRestClient:function(t){!function(t){To=t}(t)}}),Go=Fo.ServerValue;!function(e){rt(e.SDK_VERSION);var n=e.INTERNAL.registerComponent(new i.wA("database",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal");return new Fo(Eo(r,i,n),r)}),"PUBLIC").setServiceProps({Reference:Mo,Query:Lo,Database:Fo,DataSnapshot:xo,enableLogging:No,INTERNAL:Uo,ServerValue:Go,TEST_ACCESS:Bo}).setMultipleInstances(!0));e.registerVersion("@firebase/database","0.9.11"),(0,o.Yr)()&&(t.exports=n)}(r.Z)},594:(t,e,n)=>{"use strict";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var i;n.d(e,{in:()=>o,Yd:()=>l,Ub:()=>f,Am:()=>d});var o,a=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(o||(o={}));var s={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},u=o.INFO,c=((i={})[o.DEBUG]="log",i[o.VERBOSE]="log",i[o.INFO]="info",i[o.WARN]="warn",i[o.ERROR]="error",i),h=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),a=c[e];if(!a)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[a].apply(console,r(["["+o+"]  "+t.name+":"],n))}},l=function(){function t(t){this.name=t,this._logLevel=u,this._logHandler=h,this._userLogHandler=null,a.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in o))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?s[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.DEBUG],t)),this._logHandler.apply(this,r([this,o.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.VERBOSE],t)),this._logHandler.apply(this,r([this,o.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.INFO],t)),this._logHandler.apply(this,r([this,o.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.WARN],t)),this._logHandler.apply(this,r([this,o.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.ERROR],t)),this._logHandler.apply(this,r([this,o.ERROR],t))},t}();function f(t){a.forEach((function(e){e.setLogLevel(t)}))}function d(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=s[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:o[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=a;r<i.length;r++)n(i[r])}},589:(t,e,n)=>{"use strict";n.d(e,{BH:()=>f,LL:()=>k,ZR:()=>C,gQ:()=>j,zI:()=>S,hu:()=>i,g5:()=>o,US:()=>s,h$:()=>u,$s:()=>Y,r3:()=>L,ne:()=>V,p$:()=>h,ZB:()=>l,gK:()=>W,m9:()=>X,z$:()=>d,GJ:()=>x,jU:()=>g,ru:()=>m,d:()=>b,xb:()=>F,w1:()=>_,hl:()=>T,uI:()=>p,UG:()=>v,Yr:()=>I,b$:()=>y,Mn:()=>w,w9:()=>O,cI:()=>D,UI:()=>U,xO:()=>q,DV:()=>M,ug:()=>Q,dS:()=>J,Pz:()=>P,Dv:()=>K,Wj:()=>H,lb:()=>z,eu:()=>E});var r=n(655),i=function(t,e){if(!t)throw o(e)},o=function(t){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+t)},a=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,d=63&c;u||(d=64,a||(f=64)),r.push(n[h],n[l],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(a(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!==s){var h=a<<4&240|s>>2;if(r.push(h),64!==u){var l=s<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},u=function(t){var e=a(t);return s.encodeByteArray(e,!0)},c=function(t){try{return s.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function h(t){return l(void 0,t)}function l(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=l(t[n],e[n]));return t}var f=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function d(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function p(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(d())}function v(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}function g(){return"object"==typeof self&&self.self===self}function m(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function y(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function b(){return d().indexOf("Electron/")>=0}function _(){var t=d();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function w(){return d().indexOf("MSAppHost/")>=0}function I(){return!1}function T(){return"indexedDB"in self&&null!=indexedDB}function E(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}function S(){return!(!navigator||!navigator.cookieEnabled)}var C=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,k.prototype.create),o}return(0,r.ZT)(e,t),e}(Error),k=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?N(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new C(i,s,r);return u},t}();function N(t,e){return t.replace(A,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var A=/\{\$([^}]+)}/g;function D(t){return JSON.parse(t)}function P(t){return JSON.stringify(t)}var R=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=D(c(o[0])||""),n=D(c(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}},O=function(t){var e=R(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},x=function(t){var e=R(t).claims;return"object"==typeof e&&!0===e.admin};function L(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function M(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function F(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function U(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function q(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""}var j=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++)r<40?r<20?(o=h^u&(c^h),a=1518500249):(o=u^c^h,a=1859775393):r<60?(o=u&c|h&(u|c),a=2400959708):(o=u^c^h,a=3395469782),i=(s<<5|s>>>27)+o+l+a+n[r]&4294967295,l=h,h=c,c=4294967295&(u<<30|u>>>2),u=s,s=i;this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function V(t,e){var n=new B(t,e);return n.subscribe.bind(n)}var B=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t)?t:{next:t,error:e,complete:n}).next&&(r.next=G),void 0===r.error&&(r.error=G),void 0===r.complete&&(r.complete=G);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function G(){}var K=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function W(t,e){return t+" failed: "+e+" argument "}function H(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(W(t,e)+"must be a valid function.")}function z(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(W(t,e)+"must be a valid context object.")}var J=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var o=t.charCodeAt(r);if(o>=55296&&o<=56319){var a=o-55296;r++,i(r<t.length,"Surrogate pair missing trail surrogate."),o=65536+(a<<10)+(t.charCodeAt(r)-56320)}o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=63&o|128):o<65536?(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=63&o|128):(e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=63&o|128)}return e},Q=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};function Y(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=2);var r=e*Math.pow(n,t),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function X(t){return t&&t._delegate?t._delegate:t}},676:function(t,e){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i,o=new Promise((function(o,a){n(i=t[e].apply(t,r)).then(o,a)}));return o.request=i,o}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(t)return new h(t,i.request)}))}function o(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function a(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function s(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})}))}function u(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function c(t){this._index=t}function h(t,e){this._cursor=t,this._request=e}function l(t){this._store=t}function f(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function d(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new f(n)}function p(t){this._db=t}o(c,"_index",["name","keyPath","multiEntry","unique"]),a(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(h,"_cursor",["direction","key","primaryKey","value"]),a(h,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(h.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then((function(t){if(t)return new h(t,e._request)}))}))})})),l.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},l.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},o(l,"_store",["name","keyPath","indexNames","autoIncrement"]),a(l,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(l,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(l,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new l(this._tx.objectStore.apply(this._tx,arguments))},o(f,"_tx",["objectStoreNames","mode"]),s(f,"_tx",IDBTransaction,["abort"]),d.prototype.createObjectStore=function(){return new l(this._db.createObjectStore.apply(this._db,arguments))},o(d,"_db",["name","version","objectStoreNames"]),s(d,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},o(p,"_db",["name","version","objectStoreNames"]),s(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[l,c].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[c,l].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)}))}))})})),t.openDb=function(t,e,n){var i=r(indexedDB,"open",[t,e]),o=i.request;return o&&(o.onupgradeneeded=function(t){n&&n(new d(o.result,t.oldVersion,o.transaction))}),i.then((function(t){return new p(t)}))},t.deleteDb=function(t){return r(indexedDB,"deleteDatabase",[t])},Object.defineProperty(t,"__esModule",{value:!0})}(e)},655:(t,e,n)=>{"use strict";n.d(e,{ZT:()=>i,pi:()=>o,mG:()=>a,Jh:()=>s,XA:()=>u,CR:()=>c,ev:()=>h});var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function a(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function s(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function u(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function h(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}Object.create,Object.create}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.hmd=t=>((t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=n(99);(function(){var e,r="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)},i=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g,t];for(var e=0;e<t.length;++e){var r=t[e];if(r&&r.Math==Math)return r}return globalThis}(this);function o(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function a(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:o(t)}}!function(t,e){if(e){var n=i;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in n||(n[a]={}),n=n[a]}(e=e(o=n[t=t[t.length-1]]))!=o&&null!=e&&r(n,t,{configurable:!0,writable:!0,value:e})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function n(){this.a=null}function r(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var o=i.setTimeout;n.prototype.c=function(t){o(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},n.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.v(t):this.h(t)}},e.prototype.v=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new n;return e.prototype.s=function(t){var e=this.f();t.Qa(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(t){o(t)}}:e}var i,o,a=new e((function(t,e){i=t,o=e}));return this.Qa(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Qa=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=r,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var i=a(t),o=i.next();!o.done;o=i.next())r(o.value).Qa(e,n)}))},e.all=function(t){var n=a(t),i=n.next();return i.done?r([]):new e((function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).Qa(o(a.length-1),e),i=n.next()}while(!i.done)}))},e}));var s=s||{},u=this||self,c=/^[\w+/_-]+[=]{0,2}$/,h=null;function l(t){return(t=t.querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&c.test(t)?t:""}function f(){}function d(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function p(t){var e=d(t);return"array"==e||"object"==e&&"number"==typeof t.length}function v(t){return"function"==d(t)}function g(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function m(t){return Object.prototype.hasOwnProperty.call(t,y)&&t[y]||(t[y]=++b)}var y="closure_uid_"+(1e9*Math.random()>>>0),b=0;function _(t,e,n){return t.call.apply(t.bind,arguments)}function w(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function I(t,e,n){return(I=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?_:w).apply(null,arguments)}function T(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var E=Date.now;function S(t,e){function n(){}n.prototype=e.prototype,t.ab=e.prototype,t.prototype=new n,t.prototype.constructor=t}function C(t){return t}function k(t,e,n){this.code=D+t,this.message=e||P[t]||"",this.a=n||null}function N(t){var e=t&&t.code;return e?new k(e.substring(D.length),t.message,t.serverResponse):null}S(k,Error),k.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},k.prototype.toJSON=function(){return this.w()};var A,D="auth/",P={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},R={ld:{Ta:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ta:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://securetoken.googleapis.com/v1/token",Wa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ta:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ta:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Za:"https://test-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function O(t){for(var e in R)if(R[e].id===t)return{firebaseEndpoint:(t=R[e]).Ta,secureTokenEndpoint:t.Za,identityPlatformEndpoint:t.Wa};return null}function x(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function L(t){if(Error.captureStackTrace)Error.captureStackTrace(this,L);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function M(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");L.call(this,n+t[r])}function F(t,e){throw new M("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function U(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function q(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function j(){this.b=this.a=null}A=O("__EID__")?"__EID__":void 0,S(L,Error),L.prototype.name="CustomError",S(M,L),M.prototype.name="AssertionError",U.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var V=new U((function(){return new G}),(function(t){t.reset()}));function B(){var t=_e,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function G(){this.next=this.b=this.a=null}j.prototype.add=function(t,e){var n=V.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},G.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},G.prototype.reset=function(){this.next=this.b=this.a=null};var K=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},W=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},H=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,o="string"==typeof t?t.split(""):t,a=0;a<n;a++)if(a in o){var s=o[a];e.call(void 0,s,a,t)&&(r[i++]=s)}return r},z=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},J=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function Q(t,e){return 0<=K(t,e)}function Y(t,e){var n;return(n=0<=(e=K(t,e)))&&Array.prototype.splice.call(t,e,1),n}function X(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&Array.prototype.splice.call(t,r,1).length}))}function Z(t){return Array.prototype.concat.apply([],arguments)}function $(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var tt,et=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},nt=/&/g,rt=/</g,it=/>/g,ot=/"/g,at=/'/g,st=/\x00/g,ut=/[\x00&<>"']/;function ct(t,e){return-1!=t.indexOf(e)}function ht(t,e){return t<e?-1:t>e?1:0}t:{var lt=u.navigator;if(lt){var ft=lt.userAgent;if(ft){tt=ft;break t}}tt=""}function dt(t){return ct(tt,t)}function pt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function vt(t){for(var e in t)return!1;return!0}function gt(t){var e,n={};for(e in t)n[e]=t[e];return n}var mt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function yt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<mt.length;o++)n=mt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function bt(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||u).Element&&r.Location){var i=r;break t}}catch(t){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(g(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(t){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;F("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function _t(t,e){this.a=t===Et&&e||"",this.b=Tt}function wt(t){return t instanceof _t&&t.constructor===_t&&t.b===Tt?t.a:(F("expected object of type Const, got '"+t+"'"),"type_error:Const")}_t.prototype.sa=!0,_t.prototype.ra=function(){return this.a},_t.prototype.toString=function(){return"Const{"+this.a+"}"};var It,Tt={},Et={};function St(){if(void 0===It){var t=null,e=u.trustedTypes;if(e&&e.createPolicy){try{t=e.createPolicy("goog#html",{createHTML:C,createScript:C,createScriptURL:C})}catch(t){u.console&&u.console.error(t.message)}It=t}else It=t}return It}function Ct(t,e){this.a=e===Pt?t:""}function kt(t){return t instanceof Ct&&t.constructor===Ct?t.a:(F("expected object of type TrustedResourceUrl, got '"+t+"' of type "+d(t)),"type_error:TrustedResourceUrl")}function Nt(t,e){var n=wt(t);if(!Dt.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(t){var e=St();return new Ct(t=e?e.createScriptURL(t):t,Pt)}(t=n.replace(At,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof _t?wt(t):encodeURIComponent(String(t))})))}Ct.prototype.sa=!0,Ct.prototype.ra=function(){return this.a.toString()},Ct.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var At=/%{(\w+)}/g,Dt=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Pt={};function Rt(t,e){this.a=e===qt?t:""}function Ot(t){return t instanceof Rt&&t.constructor===Rt?t.a:(F("expected object of type SafeUrl, got '"+t+"' of type "+d(t)),"type_error:SafeUrl")}Rt.prototype.sa=!0,Rt.prototype.ra=function(){return this.a.toString()},Rt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var xt=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,Lt=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Mt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Ft(t){if(t instanceof Rt)return t;if(t="object"==typeof t&&t.sa?t.ra():String(t),Mt.test(t))t=new Rt(t,qt);else{var e=(t=(t=String(t)).replace(/(%0A|%0D)/g,"")).match(Lt);t=e&&xt.test(e[1])?new Rt(t,qt):null}return t}function Ut(t){return t instanceof Rt?t:(t="object"==typeof t&&t.sa?t.ra():String(t),Mt.test(t)||(t="about:invalid#zClosurez"),new Rt(t,qt))}var qt={},jt=new Rt("about:invalid#zClosurez",qt);function Vt(t,e,n){this.a=n===Bt?t:""}Vt.prototype.sa=!0,Vt.prototype.ra=function(){return this.a.toString()},Vt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Bt={};function Gt(t,e,n,r){return t=t instanceof Rt?t:Ut(t),e=e||u,n=n instanceof _t?wt(n):n||"",e.open(Ot(t),n,r,void 0)}function Kt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Wt(t){return ut.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(nt,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(rt,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(it,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(ot,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(at,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(st,"&#0;"))),t}function Ht(t){return Ht[" "](t),t}Ht[" "]=f;var zt,Jt,Qt=dt("Opera"),Yt=dt("Trident")||dt("MSIE"),Xt=dt("Edge"),Zt=Xt||Yt,$t=dt("Gecko")&&!(ct(tt.toLowerCase(),"webkit")&&!dt("Edge"))&&!(dt("Trident")||dt("MSIE"))&&!dt("Edge"),te=ct(tt.toLowerCase(),"webkit")&&!dt("Edge");function ee(){var t=u.document;return t?t.documentMode:void 0}t:{var ne="",re=(Jt=tt,$t?/rv:([^\);]+)(\)|;)/.exec(Jt):Xt?/Edge\/([\d\.]+)/.exec(Jt):Yt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Jt):te?/WebKit\/(\S+)/.exec(Jt):Qt?/(?:Version)[ \/]?(\S+)/.exec(Jt):void 0);if(re&&(ne=re?re[1]:""),Yt){var ie=ee();if(null!=ie&&ie>parseFloat(ne)){zt=String(ie);break t}}zt=ne}var oe,ae={};function se(t){return function(t,e){var n=ae;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=et(String(zt)).split("."),r=et(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=ht(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||ht(0==a[2].length,0==s[2].length)||ht(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}u.document&&Yt?oe=ee()||parseInt(zt,10)||void 0:oe=void 0;var ue=oe;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(Jt){}var ce=!Yt||9<=Number(ue);function he(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function le(t,e){pt(e,(function(e,n){e&&"object"==typeof e&&e.sa&&(e=e.ra()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:pe.hasOwnProperty(n)?t.setAttribute(pe[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var fe,de,pe={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ve(t,e,n){function r(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];if(!p(o)||g(o)&&0<o.nodeType)r(o);else{t:{if(o&&"number"==typeof o.length){if(g(o)){var a="function"==typeof o.item||"string"==typeof o.item;break t}if(v(o)){a="function"==typeof o.item;break t}}a=!1}W(a?$(o):o,r)}}}function ge(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function me(t){u.setTimeout((function(){throw t}),0)}function ye(t,e){de||function(){if(u.Promise&&u.Promise.resolve){var t=u.Promise.resolve(void 0);de=function(){t.then(we)}}else de=function(){var t=we;!v(u.setImmediate)||u.Window&&u.Window.prototype&&!dt("Edge")&&u.Window.prototype.setImmediate==u.setImmediate?(fe||(fe=function(){var t=u.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!dt("Presto")&&(t=function(){var t=ge(document,"IFRAME");t.style.display="none",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=I((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!dt("Trident")&&!dt("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Gb;n.Gb=null,t()}},function(t){r.next={Gb:t},r=r.next,e.port2.postMessage(0)}}return function(t){u.setTimeout(t,0)}}()),fe(t)):u.setImmediate(t)}}(),be||(de(),be=!0),_e.add(t,e)}var be=!1,_e=new j;function we(){for(var t;t=B();){try{t.a.call(t.b)}catch(t){me(t)}q(V,t)}be=!1}function Ie(t,e){if(this.a=Te,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=f)try{var n=this;t.call(e,(function(t){Me(n,Ee,t)}),(function(t){if(!(t instanceof Ge))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}Me(n,Se,t)}))}catch(t){Me(this,Se,t)}}var Te=0,Ee=2,Se=3;function Ce(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Ce.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var ke=new U((function(){return new Ce}),(function(t){t.reset()}));function Ne(t,e,n){var r=ke.get();return r.g=t,r.b=e,r.f=n,r}function Ae(t){if(t instanceof Ie)return t;var e=new Ie(f);return Me(e,Ee,t),e}function De(t){return new Ie((function(e,n){n(t)}))}function Pe(t,e,n){Fe(t,e,n,null)||ye(T(e,t))}function Re(t){return new Ie((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Pb:!0,value:o}:{Pb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)Pe(t[o],T(i,o,!0),T(i,o,!1));else e(r)}))}function Oe(t,e){if(t.a==Te)if(t.c){var n=t.c;if(n.b){for(var r=0,i=null,o=null,a=n.b;a&&(a.c||(r++,a.a==t&&(i=a),!(i&&1<r)));a=a.next)i||(o=a);i&&(n.a==Te&&1==r?Oe(n,e):(o?((r=o).next==n.f&&(n.f=r),r.next=r.next.next):qe(n),je(n,i,Se,e)))}t.c=null}else Me(t,Se,e)}function xe(t,e){t.b||t.a!=Ee&&t.a!=Se||Ue(t),t.f?t.f.next=e:t.b=e,t.f=e}function Le(t,e,n,r){var i=Ne(null,null,null);return i.a=new Ie((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof Ge?o(e):t(i)}catch(t){o(t)}}:o})),i.a.c=t,xe(t,i),i.a}function Me(t,e,n){t.a==Te&&(t===n&&(e=Se,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Fe(n,t.$c,t.ad,t)||(t.i=n,t.a=e,t.c=null,Ue(t),e!=Se||n instanceof Ge||function(t,e){t.g=!0,ye((function(){t.g&&Be.call(null,e)}))}(t,n)))}function Fe(t,e,n,r){if(t instanceof Ie)return xe(t,Ne(e||f,n||null,r)),!0;if(x(t))return t.then(e,n,r),!0;if(g(t))try{var i=t.then;if(v(i))return function(t,e,n,r,i){function o(t){a||(a=!0,r.call(i,t))}var a=!1;try{e.call(t,(function(t){a||(a=!0,n.call(i,t))}),o)}catch(t){o(t)}}(t,i,e,n,r),!0}catch(t){return n.call(r,t),!0}return!1}function Ue(t){t.h||(t.h=!0,ye(t.gc,t))}function qe(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function je(t,e,n,r){if(n==Se&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Ve(e,n,r);else try{e.c?e.g.call(e.f):Ve(e,n,r)}catch(t){Be.call(null,t)}q(ke,e)}function Ve(t,e,n){e==Ee?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}Ie.prototype.then=function(t,e,n){return Le(this,v(t)?t:null,v(e)?e:null,n)},Ie.prototype.$goog_Thenable=!0,(e=Ie.prototype).oa=function(t,e){return(t=Ne(t,t,e)).c=!0,xe(this,t),this},e.o=function(t,e){return Le(this,null,t,e)},e.cancel=function(t){if(this.a==Te){var e=new Ge(t);ye((function(){Oe(this,e)}),this)}},e.$c=function(t){this.a=Te,Me(this,Ee,t)},e.ad=function(t){this.a=Te,Me(this,Se,t)},e.gc=function(){for(var t;t=qe(this);)je(this,t,this.a,this.i);this.h=!1};var Be=me;function Ge(t){L.call(this,t)}function Ke(){0!=We&&(He[m(this)]=this),this.xa=this.xa,this.pa=this.pa}S(Ge,L),Ge.prototype.name="cancel";var We=0,He={};function ze(t){if(!t.xa&&(t.xa=!0,t.Da(),0!=We)){var e=m(t);if(0!=We&&t.pa&&0<t.pa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete He[e]}}Ke.prototype.xa=!1,Ke.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var Je=Object.freeze||function(t){return t},Qe=!Yt||9<=Number(ue),Ye=Yt&&!se("9"),Xe=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{u.addEventListener("test",f,e),u.removeEventListener("test",f,e)}catch(t){}return t}();function Ze(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function $e(t,e){if(Ze.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if($t){t:{try{Ht(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:tn[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Ze.prototype.preventDefault=function(){this.defaultPrevented=!0},S($e,Ze);var tn=Je({2:"touch",3:"pen",4:"mouse"});$e.prototype.preventDefault=function(){$e.ab.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Ye)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},$e.prototype.g=function(){return this.a};var en="closure_listenable_"+(1e6*Math.random()|0),nn=0;function rn(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Va=i,this.key=++nn,this.va=this.Pa=!1}function on(t){t.va=!0,t.listener=null,t.proxy=null,t.src=null,t.Va=null}function an(t){this.src=t,this.a={},this.b=0}function sn(t,e){var n=e.type;n in t.a&&Y(t.a[n],e)&&(on(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function un(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.va&&o.listener==e&&o.capture==!!n&&o.Va==r)return i}return-1}an.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=un(t,e,r,i);return-1<a?(e=t[a],n||(e.Pa=!1)):((e=new rn(e,this.src,o,!!r,i)).Pa=n,t.push(e)),e};var cn="closure_lm_"+(1e6*Math.random()|0),hn={};function ln(t,e,n,r,i){if(r&&r.once)dn(t,e,n,r,i);else if(Array.isArray(e))for(var o=0;o<e.length;o++)ln(t,e[o],n,r,i);else n=In(n),t&&t[en]?En(t,e,n,g(r)?!!r.capture:!!r,i):fn(t,e,n,!1,r,i)}function fn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=g(i)?!!i.capture:!!i,s=_n(t);if(s||(t[cn]=s=new an(t)),!(n=s.add(e,n,r,a,o)).proxy)if(r=function(){var t=bn,e=Qe?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Xe||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(gn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}}function dn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)dn(t,e[o],n,r,i);else n=In(n),t&&t[en]?Sn(t,e,n,g(r)?!!r.capture:!!r,i):fn(t,e,n,!0,r,i)}function pn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)pn(t,e[o],n,r,i);else r=g(r)?!!r.capture:!!r,n=In(n),t&&t[en]?(t=t.v,(e=String(e).toString())in t.a&&-1<(n=un(o=t.a[e],n,r,i))&&(on(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=_n(t))&&(e=t.a[e.toString()],t=-1,e&&(t=un(e,n,r,i)),(n=-1<t?e[t]:null)&&vn(n))}function vn(t){if("number"!=typeof t&&t&&!t.va){var e=t.src;if(e&&e[en])sn(e.v,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(gn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=_n(e))?(sn(n,t),0==n.b&&(n.src=null,e[cn]=null)):on(t)}}}function gn(t){return t in hn?hn[t]:hn[t]="on"+t}function mn(t,e,n,r){var i=!0;if((t=_n(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.va&&(o=yn(o,r),i=i&&!1!==o)}return i}function yn(t,e){var n=t.listener,r=t.Va||t.src;return t.Pa&&vn(t),n.call(r,e)}function bn(t,e){if(t.va)return!0;if(!Qe){if(!e)t:{e=["window","event"];for(var n=u,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new $e(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=mn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=mn(r[i],t,!1,e),n=n&&o}return n}return yn(t,new $e(e,this))}function _n(t){return(t=t[cn])instanceof an?t:null}var wn="__closure_events_fn_"+(1e9*Math.random()>>>0);function In(t){return v(t)?t:(t[wn]||(t[wn]=function(e){return t.handleEvent(e)}),t[wn])}function Tn(){Ke.call(this),this.v=new an(this),this.ac=this,this.gb=null}function En(t,e,n,r,i){t.v.add(String(e),n,!1,r,i)}function Sn(t,e,n,r,i){t.v.add(String(e),n,!0,r,i)}function Cn(t,e,n,r){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.va&&a.capture==n){var s=a.listener,u=a.Va||a.src;a.Pa&&sn(t.v,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}function kn(t,e,n){if(v(t))n&&(t=I(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=I(t.handleEvent,t)}return 2147483647<Number(e)?-1:u.setTimeout(t,e||0)}function Nn(t){var e=null;return new Ie((function(n,r){-1==(e=kn((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).o((function(t){throw u.clearTimeout(e),t}))}function An(t){if(t.W&&"function"==typeof t.W)return t.W();if("string"==typeof t)return t.split("");if(p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function Dn(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.W||"function"!=typeof t.W){if(p(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function Pn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Pn)for(n=t.Y(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Rn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];On(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)On(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function On(t,e){return Object.prototype.hasOwnProperty.call(t,e)}S(Tn,Ke),Tn.prototype[en]=!0,Tn.prototype.addEventListener=function(t,e,n,r){ln(this,t,e,n,r)},Tn.prototype.removeEventListener=function(t,e,n,r){pn(this,t,e,n,r)},Tn.prototype.dispatchEvent=function(t){var e,n=this.gb;if(n)for(e=[];n;n=n.gb)e.push(n);n=this.ac;var r=t.type||t;if("string"==typeof t)t=new Ze(t,n);else if(t instanceof Ze)t.target=t.target||n;else{var i=t;yt(t=new Ze(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];i=Cn(a,r,!0,t)&&i}if(i=Cn(a=t.b=n,r,!0,t)&&i,i=Cn(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=Cn(a=t.b=e[o],r,!1,t)&&i;return i},Tn.prototype.Da=function(){if(Tn.ab.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)on(n[r]);delete e.a[t],e.b--}}this.gb=null},(e=Pn.prototype).W=function(){Rn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},e.Y=function(){return Rn(this),this.a.concat()},e.clear=function(){this.b={},this.c=this.a.length=0},e.get=function(t,e){return On(this.b,t)?this.b[t]:e},e.set=function(t,e){On(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},e.forEach=function(t,e){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var xn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ln(t,e){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,t instanceof Ln?(this.i=void 0!==e?e:t.i,Mn(this,t.c),this.l=t.l,this.a=t.a,Fn(this,t.g),this.f=t.f,Un(this,rr(t.b)),this.h=t.h):t&&(n=String(t).match(xn))?(this.i=!!e,Mn(this,n[1]||"",!0),this.l=Gn(n[2]||""),this.a=Gn(n[3]||"",!0),Fn(this,n[4]),this.f=Gn(n[5]||"",!0),Un(this,n[6]||"",!0),this.h=Gn(n[7]||"")):(this.i=!!e,this.b=new Xn(null,this.i))}function Mn(t,e,n){t.c=n?Gn(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function Fn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function Un(t,e,n){e instanceof Xn?(t.b=e,function(t,e){e&&!t.f&&(Zn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(tr(this,e),nr(this,n,t))}),t)),t.f=e}(t.b,t.i)):(n||(e=Kn(e,Qn)),t.b=new Xn(e,t.i))}function qn(t,e,n){t.b.set(e,n)}function jn(t,e){return t.b.get(e)}function Vn(t){return t instanceof Ln?new Ln(t):new Ln(t,void 0)}function Bn(t,e,n,r){var i=new Ln(null,void 0);return t&&Mn(i,t),e&&(i.a=e),n&&Fn(i,n),r&&(i.f=r),i}function Gn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Kn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Wn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Wn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ln.prototype.toString=function(){var t=[],e=this.c;e&&t.push(Kn(e,Hn,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Kn(e,Hn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Kn(n,"/"==n.charAt(0)?Jn:zn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Kn(n,Yn)),t.join("")},Ln.prototype.resolve=function(t){var e=new Ln(this),n=!!t.c;n?Mn(e,t.c):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var r=t.f;if(n)Fn(e,t.g);else if(n=!!t.f){if("/"!=r.charAt(0))if(this.a&&!this.f)r="/"+r;else{var i=e.f.lastIndexOf("/");-1!=i&&(r=e.f.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ct(i,"./")||ct(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.f=r:n=""!==t.b.toString(),n?Un(e,rr(t.b)):n=!!t.h,n&&(e.h=t.h),e};var Hn=/[#\/\?@]/g,zn=/[#\?:]/g,Jn=/[#\?]/g,Qn=/[#\?@]/g,Yn=/#/g;function Xn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Zn(t){t.a||(t.a=new Pn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function $n(t){var e=Dn(t);if(void 0===e)throw Error("Keys are undefined");var n=new Xn(null,void 0);t=An(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];Array.isArray(o)?nr(n,i,o):n.add(i,o)}return n}function tr(t,e){Zn(t),e=ir(t,e),On(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,On((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Rn(t)))}function er(t,e){return Zn(t),e=ir(t,e),On(t.a.b,e)}function nr(t,e,n){tr(t,e),0<n.length&&(t.c=null,t.a.set(ir(t,e),$(n)),t.b+=n.length)}function rr(t){var e=new Xn;return e.c=t.c,t.a&&(e.a=new Pn(t.a),e.b=t.b),e}function ir(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function or(t){var e=[];return sr(new ar,t,e),e.join("")}function ar(){}function sr(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(Array.isArray(e)){var r=e;e=r.length,n.push("[");for(var i="",o=0;o<e;o++)n.push(i),sr(t,r[o],n),i=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){for(r in n.push("{"),i="",e)Object.prototype.hasOwnProperty.call(e,r)&&"function"!=typeof(o=e[r])&&(n.push(i),hr(r,n),n.push(":"),sr(t,o,n),i=",");return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":hr(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}(e=Xn.prototype).add=function(t,e){Zn(this),this.c=null,t=ir(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},e.clear=function(){this.a=this.c=null,this.b=0},e.forEach=function(t,e){Zn(this),this.a.forEach((function(n,r){W(n,(function(n){t.call(e,n,r,this)}),this)}),this)},e.Y=function(){Zn(this);for(var t=this.a.W(),e=this.a.Y(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},e.W=function(t){Zn(this);var e=[];if("string"==typeof t)er(this,t)&&(e=Z(e,this.a.get(ir(this,t))));else{t=this.a.W();for(var n=0;n<t.length;n++)e=Z(e,t[n])}return e},e.set=function(t,e){return Zn(this),this.c=null,er(this,t=ir(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},e.get=function(t,e){return t&&0<(t=this.W(t)).length?String(t[0]):e},e.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.W(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var ur={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},cr=/\uffff/.test("￿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function hr(t,e){e.push('"',t.replace(cr,(function(t){var e=ur[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),ur[t]=e),e})),'"')}function lr(){var t=Pr();return Yt&&!!ue&&11==ue||/Edge\/\d+/.test(t)}function fr(){return u.window&&u.window.location.href||self&&self.location&&self.location.href||""}function dr(t,e){e=e||u.window;var n="about:blank";t&&(n=Ot(Ft(t)||jt)),e.location.href=n}function pr(t,e){var n,r=[];for(n in t)n in e?typeof t[n]!=typeof e[n]?r.push(n):"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<pr(t[n],e[n]).length&&r.push(n):t[n]!==e[n]&&r.push(n):r.push(n);for(n in e)n in t||r.push(n);return r}function vr(t){return!!((t=(t||Pr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function gr(t){t=t||u.window;try{t.close()}catch(t){}}function mr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Pr().toLowerCase(),r&&(e.target=r,ct(n,"crios/")&&(e.target="_blank")),Nr(Pr())==Cr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Rt?n:Ft(void 0!==n.href?n.href:String(n))||jt,n=t.target||n.target,i=[],t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((dt("iPhone")&&!dt("iPod")&&!dt("iPad")||dt("iPad")||dt("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(bt(a=ge(document,"A"),"HTMLAnchorElement"),e=e instanceof Rt?e:Ut(e),a.href=Ot(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=Gt("",r,n,a),t=Ot(e),a&&(Zt&&ct(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Wt(t)+'">',t=new Vt(t=(r=St())?r.createHTML(t):t,null,Bt),r=a.document)&&(r.write(function(t){return t instanceof Vt&&t.constructor===Vt?t.a:(F("expected object of type SafeHtml, got '"+t+"' of type "+d(t)),"type_error:SafeHtml")}(t)),r.close())):(a=Gt(e,r,n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(t){}return a}var yr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,br=/^[^@]+@[^@]+$/;function _r(){var t=null;return new Ie((function(e){"complete"==u.document.readyState?e():(t=function(){e()},dn(window,"load",t))})).o((function(e){throw pn(window,"load",t),e}))}function wr(t){return t=t||Pr(),!("file:"!==Mr()&&"ionic:"!==Mr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Ir(){var t=u.window;try{return!(!t||t==t.top)}catch(t){return!1}}function Tr(){return void 0!==u.WorkerGlobalScope&&"function"==typeof u.importScripts}function Er(){return t.Z.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":t.Z.INTERNAL.hasOwnProperty("node")?"Node":Tr()?"Worker":"Browser"}function Sr(){var t=Er();return"ReactNative"===t||"Node"===t}var Cr="Firefox",kr="Chrome";function Nr(t){var e=t.toLowerCase();return ct(e,"opera/")||ct(e,"opr/")||ct(e,"opios/")?"Opera":ct(e,"iemobile")?"IEMobile":ct(e,"msie")||ct(e,"trident/")?"IE":ct(e,"edge/")?"Edge":ct(e,"firefox/")?Cr:ct(e,"silk/")?"Silk":ct(e,"blackberry")?"Blackberry":ct(e,"webos")?"Webos":!ct(e,"safari/")||ct(e,"chrome/")||ct(e,"crios/")||ct(e,"android")?!ct(e,"chrome/")&&!ct(e,"crios/")||ct(e,"edge/")?ct(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":kr:"Safari"}var Ar={md:"FirebaseCore-web",od:"FirebaseUI-web"};function Dr(t,e){e=e||[];var n,r=[],i={};for(n in Ar)i[Ar[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=Er())?r=Nr(i=Pr()):"Worker"===r&&(r=Nr(i=Pr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function Pr(){return u.navigator&&u.navigator.userAgent||""}function Rr(t,e){t=t.split("."),e=e||u;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Or(){try{var t=u.localStorage,e=Vr();if(t)return t.setItem(e,"1"),t.removeItem(e),!lr()||!!u.indexedDB}catch(t){return Tr()&&!!u.indexedDB}return!1}function xr(){return(Lr()||"chrome-extension:"===Mr()||wr())&&!Sr()&&Or()&&!Tr()}function Lr(){return"http:"===Mr()||"https:"===Mr()}function Mr(){return u.location&&u.location.protocol||null}function Fr(t){return!vr(t=t||Pr())&&Nr(t)!=Cr}function Ur(t){return void 0===t?null:or(t)}function qr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function jr(t){if(null!==t)return JSON.parse(t)}function Vr(t){return t||Math.floor(1e9*Math.random()).toString()}function Br(t){return"Safari"!=Nr(t=t||Pr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Gr(){var t=u.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Kr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=Pr(),e=Er(),this.b=vr(t)||"ReactNative"===e}function Wr(){var t=u.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Hr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function zr(){return!(!Rr("fireauth.oauthhelper",u)&&!Rr("fireauth.iframe",u))}Kr.prototype.get=function(){var t=u.navigator;return!t||"boolean"!=typeof t.onLine||!Lr()&&"chrome-extension:"!==Mr()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Jr,Qr={};function Yr(t){Qr[t]||(Qr[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Xr={};Object.defineProperty(Xr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Xr,"abcd",{configurable:!0,enumerable:!0,value:2}),Jr=2==Xr.abcd}catch(Jt){Jr=!1}function Zr(t,e,n){Jr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function $r(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Zr(t,n,e[n])}function ti(t){var e={};return $r(e,t),e}function ei(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Zr(e,n,ei(t[n]));return e}function ni(t){var e=t&&(t[si]?"phone":null);if(!(e&&t&&t[ai]))throw new k("internal-error","Internal assert: invalid MultiFactorInfo object");Zr(this,"uid",t[ai]),Zr(this,"displayName",t[ii]||null);var n=null;t[oi]&&(n=new Date(t[oi]).toUTCString()),Zr(this,"enrollmentTime",n),Zr(this,"factorId",e)}function ri(t){try{var e=new ui(t)}catch(t){e=null}return e}ni.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var ii="displayName",oi="enrolledAt",ai="mfaEnrollmentId",si="phoneInfo";function ui(t){ni.call(this,t),Zr(this,"phoneNumber",t[si])}function ci(t){var e={},n=t[di],r=t[vi],i=t[gi];if(t=ri(t[pi]),!i||i!=li&&i!=fi&&!n||i==fi&&!r||i==hi&&!t)throw Error("Invalid checkActionCode response!");i==fi?(e[yi]=n||null,e[_i]=n||null,e[mi]=r):(e[yi]=r||null,e[_i]=r||null,e[mi]=n||null),e[bi]=t||null,Zr(this,Ii,i),Zr(this,wi,ei(e))}S(ui,ni),ui.prototype.w=function(){var t=ui.ab.w.call(this);return t.phoneNumber=this.phoneNumber,t};var hi="REVERT_SECOND_FACTOR_ADDITION",li="EMAIL_SIGNIN",fi="VERIFY_AND_CHANGE_EMAIL",di="email",pi="mfaInfo",vi="newEmail",gi="requestType",mi="email",yi="fromEmail",bi="multiFactorInfo",_i="previousEmail",wi="data",Ii="operation";function Ti(t){var e=jn(t=Vn(t),Ei)||null,n=jn(t,Si)||null,r=jn(t,Ni)||null;if(r=r&&Di[r]||null,!e||!n||!r)throw new k("argument-error",Ei+", "+Si+"and "+Ni+" are required in a valid action code URL.");$r(this,{apiKey:e,operation:r,code:n,continueUrl:jn(t,Ci)||null,languageCode:jn(t,ki)||null,tenantId:jn(t,Ai)||null})}var Ei="apiKey",Si="oobCode",Ci="continueUrl",ki="languageCode",Ni="mode",Ai="tenantId",Di={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:hi,signIn:li,verifyAndChangeEmail:fi,verifyEmail:"VERIFY_EMAIL"};function Pi(t){try{return new Ti(t)}catch(t){return null}}function Ri(t){var e=t[Fi];if(void 0===e)throw new k("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new k("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Oi];if(n&&"object"==typeof n){e=n[ji];var r=n[Ui];if(n=n[qi],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new k("argument-error",Ui+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new k("argument-error",qi+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new k("argument-error",ji+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new k("missing-android-pkg-name")}}else if(void 0!==n)throw new k("argument-error",Oi+" property must be a non null object when specified.");if(this.f=null,(e=t[Mi])&&"object"==typeof e){if("string"==typeof(e=e[Vi])&&e.length)this.f=e;else if(void 0!==e)throw new k("argument-error",Vi+" property must be a non empty string when specified.")}else if(void 0!==e)throw new k("argument-error",Mi+" property must be a non null object when specified.");if(void 0!==(e=t[Li])&&"boolean"!=typeof e)throw new k("argument-error",Li+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[xi])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new k("argument-error",xi+" property must be a non empty string when specified.");this.i=t||null}var Oi="android",xi="dynamicLinkDomain",Li="handleCodeInApp",Mi="iOS",Fi="url",Ui="installApp",qi="minimumVersion",ji="packageName",Vi="bundleId";function Bi(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Gi=null;function Ki(t){var e=Hi(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.h=t,this.a=e.exp,this.i=e.sub,t=Date.now()/1e3,this.g=e.iat||(t>this.a?this.a:t),this.b=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.c=!!e.is_anonymous||"anonymous"==this.b}function Wi(t){try{return new Ki(t)}catch(t){return null}}function Hi(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{var r=function(t){var e=[];return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Gi[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Gi){Gi={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Gi[o]&&(Gi[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,(function(t){e.push(t)})),e}(t);for(t=[],n=e=0;e<r.length;){var i=r[e++];if(128>i)t[n++]=String.fromCharCode(i);else if(191<i&&224>i){var o=r[e++];t[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&365>i){o=r[e++];var a=r[e++],s=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&r[e++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else o=r[e++],a=r[e++],t[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}return JSON.parse(t.join(""))}catch(t){}return null}Ki.prototype.T=function(){return this.f},Ki.prototype.l=function(){return this.c},Ki.prototype.toString=function(){return this.h};var zi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Ji=["client_id","response_type","scope","redirect_uri","state"],Qi={nd:{Ja:"locale",ua:700,ta:600,fa:"facebook.com",Xa:Ji},pd:{Ja:null,ua:500,ta:750,fa:"github.com",Xa:Ji},qd:{Ja:"hl",ua:515,ta:680,fa:"google.com",Xa:Ji},wd:{Ja:"lang",ua:485,ta:705,fa:"twitter.com",Xa:zi},kd:{Ja:"locale",ua:640,ta:600,fa:"apple.com",Xa:[]}};function Yi(t){for(var e in Qi)if(Qi[e].fa==t)return Qi[e];return null}function Xi(t){var e={};e["facebook.com"]=no,e["google.com"]=io,e["github.com"]=ro,e["twitter.com"]=oo;var n=t&&t[$i];try{if(n)return e[n]?new e[n](t):new eo(t);if(void 0!==t[Zi])return new to(t)}catch(t){}return null}var Zi="idToken",$i="providerId";function to(t){var e=t[$i];if(!e&&t[Zi]){var n=Wi(t[Zi]);n&&n.b&&(e=n.b)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Zr(this,"providerId",e),Zr(this,"isNewUser",n)}function eo(t){to.call(this,t),Zr(this,"profile",ei((t=jr(t.rawUserInfo||"{}"))||{}))}function no(t){if(eo.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function ro(t){if(eo.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Zr(this,"username",this.profile&&this.profile.login||null)}function io(t){if(eo.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function oo(t){if(eo.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Zr(this,"username",t.screenName||null)}function ao(t){var e=Vn(t),n=jn(e,"link"),r=jn(Vn(n),"link");return e=jn(e,"deep_link_id"),jn(Vn(e),"link")||e||r||n||t}function so(t,e){if(!t&&!e)throw new k("internal-error","Internal assert: no raw session string available");if(t&&e)throw new k("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?uo:co}S(eo,to),S(no,eo),S(ro,eo),S(io,eo),S(oo,eo);var uo="enroll",co="signin";function ho(){}function lo(t,e){return t.then((function(t){if(t[$a]){var n=Wi(t[$a]);if(!n||e!=n.i)throw new k("user-mismatch");return t}throw new k("user-mismatch")})).o((function(t){throw t&&t.code&&t.code==D+"user-not-found"?new k("user-mismatch"):t}))}function fo(t,e){if(!e)throw new k("internal-error","failed to construct a credential");this.a=e,Zr(this,"providerId",t),Zr(this,"signInMethod",t)}function po(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function vo(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new fo(t.providerId,t.pendingToken)}catch(t){}return null}function go(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Zr(this,"idToken",e.idToken),e.accessToken&&Zr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Zr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new k("internal-error","failed to construct a credential");Zr(this,"accessToken",e.oauthToken),Zr(this,"secret",e.oauthTokenSecret)}Zr(this,"providerId",t),Zr(this,"signInMethod",n)}function mo(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:$n(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function yo(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new go(t.providerId,e,t.signInMethod)}catch(t){}}return null}function bo(t,e){this.Qc=e||[],$r(this,{providerId:t,isOAuthProvider:!0}),this.Ib={},this.pb=(Yi(t)||{}).Ja||null,this.ob=null}function _o(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new k("argument-error",'SAML provider IDs must be prefixed with "saml."');bo.call(this,t,[])}function wo(t){bo.call(this,t,Ji),this.a=[]}function Io(){wo.call(this,"facebook.com")}function To(t){if(!t)throw new k("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return g(t)&&(e=t.accessToken),(new Io).credential({accessToken:e})}function Eo(){wo.call(this,"github.com")}function So(t){if(!t)throw new k("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return g(t)&&(e=t.accessToken),(new Eo).credential({accessToken:e})}function Co(){wo.call(this,"google.com"),this.Ca("profile")}function ko(t,e){var n=t;return g(t)&&(n=t.idToken,e=t.accessToken),(new Co).credential({idToken:n,accessToken:e})}function No(){bo.call(this,"twitter.com",zi)}function Ao(t,e){var n=t;if(g(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new k("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new go("twitter.com",n,"twitter.com")}function Do(t,e,n){this.a=t,this.f=e,Zr(this,"providerId","password"),Zr(this,"signInMethod",n===Ro.EMAIL_LINK_SIGN_IN_METHOD?Ro.EMAIL_LINK_SIGN_IN_METHOD:Ro.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Po(t){return t&&t.email&&t.password?new Do(t.email,t.password,t.signInMethod):null}function Ro(){$r(this,{providerId:"password",isOAuthProvider:!1})}function Oo(t,e){if(!(e=xo(e)))throw new k("argument-error","Invalid email link!");return new Do(t,e.code,Ro.EMAIL_LINK_SIGN_IN_METHOD)}function xo(t){return(t=Pi(t=ao(t)))&&t.operation===li?t:null}function Lo(t){if(!(t.eb&&t.cb||t.La&&t.ea))throw new k("internal-error");this.a=t,Zr(this,"providerId","phone"),this.fa="phone",Zr(this,"signInMethod","phone")}function Mo(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return W(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new Lo(e)}return null}function Fo(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.eb,code:t.a.cb}}function Uo(e){try{this.a=e||t.Z.auth()}catch(t){throw new k("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}$r(this,{providerId:"phone",isOAuthProvider:!1})}function qo(t,e){if(!t)throw new k("missing-verification-id");if(!e)throw new k("missing-verification-code");return new Lo({eb:t,cb:e})}function jo(t){if(t.temporaryProof&&t.phoneNumber)return new Lo({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return ko(o,n);case"facebook.com":return To(n);case"github.com":return So(n);case"twitter.com":return Ao(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new fo(e,a):new go(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new wo(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(t){return null}}function Vo(t){if(!t.isOAuthProvider)throw new k("invalid-oauth-provider")}function Bo(t,e,n,r,i,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new k("invalid-auth-event");if(this.g&&this.a)throw new k("invalid-auth-event");if(this.g&&!this.f)throw new k("invalid-auth-event")}function Go(t){return(t=t||{}).type?new Bo(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&N(t.error),t.postBody,t.tenantId):null}function Ko(){this.b=null,this.a=[]}so.prototype.Ha=function(){return this.a?Ae(this.a):Ae(this.b)},so.prototype.w=function(){return this.type==uo?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},ho.prototype.ka=function(){},ho.prototype.b=function(){},ho.prototype.c=function(){},ho.prototype.w=function(){},fo.prototype.ka=function(t){return _s(t,po(this))},fo.prototype.b=function(t,e){var n=po(this);return n.idToken=e,ws(t,n)},fo.prototype.c=function(t,e){return lo(Is(t,po(this)),e)},fo.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},go.prototype.ka=function(t){return _s(t,mo(this))},go.prototype.b=function(t,e){var n=mo(this);return n.idToken=e,ws(t,n)},go.prototype.c=function(t,e){return lo(Is(t,mo(this)),e)},go.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},bo.prototype.Ka=function(t){return this.Ib=gt(t),this},S(_o,bo),S(wo,bo),wo.prototype.Ca=function(t){return Q(this.a,t)||this.a.push(t),this},wo.prototype.Qb=function(){return $(this.a)},wo.prototype.credential=function(t,e){var n;if(!(n=g(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new k("argument-error","credential failed: must provide the ID token and/or the access token.");return new go(this.providerId,n,this.providerId)},S(Io,wo),Zr(Io,"PROVIDER_ID","facebook.com"),Zr(Io,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),S(Eo,wo),Zr(Eo,"PROVIDER_ID","github.com"),Zr(Eo,"GITHUB_SIGN_IN_METHOD","github.com"),S(Co,wo),Zr(Co,"PROVIDER_ID","google.com"),Zr(Co,"GOOGLE_SIGN_IN_METHOD","google.com"),S(No,bo),Zr(No,"PROVIDER_ID","twitter.com"),Zr(No,"TWITTER_SIGN_IN_METHOD","twitter.com"),Do.prototype.ka=function(t){return this.signInMethod==Ro.EMAIL_LINK_SIGN_IN_METHOD?ru(t,Ds,{email:this.a,oobCode:this.f}):ru(t,Zs,{email:this.a,password:this.f})},Do.prototype.b=function(t,e){return this.signInMethod==Ro.EMAIL_LINK_SIGN_IN_METHOD?ru(t,Ps,{idToken:e,email:this.a,oobCode:this.f}):ru(t,Ks,{idToken:e,email:this.a,password:this.f})},Do.prototype.c=function(t,e){return lo(this.ka(t),e)},Do.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},$r(Ro,{PROVIDER_ID:"password"}),$r(Ro,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),$r(Ro,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Lo.prototype.ka=function(t){return t.fb(Fo(this))},Lo.prototype.b=function(t,e){var n=Fo(this);return n.idToken=e,ru(t,tu,n)},Lo.prototype.c=function(t,e){var n=Fo(this);return n.operation="REAUTH",lo(t=ru(t,eu,n),e)},Lo.prototype.w=function(){var t={providerId:"phone"};return this.a.eb&&(t.verificationId=this.a.eb),this.a.cb&&(t.verificationCode=this.a.cb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},Uo.prototype.fb=function(t,e){var n=this.a.a;return Ae(e.verify()).then((function(r){if("string"!=typeof r)throw new k("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var i=g(t)?t.session:null,o=g(t)?t.phoneNumber:t;return(i&&i.type==uo?i.Ha().then((function(t){return function(t,e){return ru(t,Hs,e).then((function(t){return t.phoneSessionInfo.sessionInfo}))}(n,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}})})):i&&i.type==co?i.Ha().then((function(e){return function(t,e){return ru(t,zs,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(t,e){return ru(t,Bs,e)}(n,{phoneNumber:o,recaptchaToken:r})).then((function(t){return"function"==typeof e.reset&&e.reset(),t}),(function(t){throw"function"==typeof e.reset&&e.reset(),t}));default:throw new k("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},$r(Uo,{PROVIDER_ID:"phone"}),$r(Uo,{PHONE_SIGN_IN_METHOD:"phone"}),Bo.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Bo.prototype.T=function(){return this.h},Bo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Wo,Ho=null;function zo(t){var e="unauthorized-domain",n=void 0,r=Vn(t);t=r.a,"chrome-extension"==(r=r.c)?n=Kt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=Kt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",k.call(this,e,n)}function Jo(t,e,n){k.call(this,t,n),(t=e||{}).Jb&&Zr(this,"email",t.Jb),t.ea&&Zr(this,"phoneNumber",t.ea),t.credential&&Zr(this,"credential",t.credential),t.Zb&&Zr(this,"tenantId",t.Zb)}function Qo(t){if(t.code){var e=t.code||"";0==e.indexOf(D)&&(e=e.substring(D.length));var n={credential:jo(t),Zb:t.tenantId};if(t.email)n.Jb=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new k(e,t.message||void 0);return new Jo(e,n,t.message)}return null}function Yo(){}function Xo(t){return t.c||(t.c=t.b())}function Zo(){}function $o(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function ta(){}function ea(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=I(this.qc,this),this.a.onerror=I(this.Sb,this),this.a.onprogress=I(this.rc,this),this.a.ontimeout=I(this.vc,this)}function na(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function ra(t,e,n){this.reset(t,e,n,void 0,void 0)}function ia(t){this.f=t,this.b=this.c=this.a=null}function oa(t,e){this.name=t,this.value=e}S(zo,k),S(Jo,k),Jo.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&yt(t,e),t},Jo.prototype.toJSON=function(){return this.w()},Yo.prototype.c=null,S(Zo,Yo),Zo.prototype.a=function(){var t=$o(this);return t?new ActiveXObject(t):new XMLHttpRequest},Zo.prototype.b=function(){var t={};return $o(this)&&(t[0]=!0,t[1]=!0),t},Wo=new Zo,S(ta,Yo),ta.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new ea;throw Error("Unsupported browser")},ta.prototype.b=function(){return{}},(e=ea.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},e.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},e.abort=function(){this.a.abort()},e.setRequestHeader=function(){},e.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},e.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,na(this,4)},e.Sb=function(){this.status=500,this.response=this.responseText="",na(this,4)},e.vc=function(){this.Sb()},e.rc=function(){this.status=200,na(this,1)},e.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},ra.prototype.a=null,ra.prototype.reset=function(t,e,n,r,i){r||E(),delete this.a},oa.prototype.toString=function(){return this.name};var aa=new oa("SEVERE",1e3),sa=new oa("WARNING",900),ua=new oa("CONFIG",700),ca=new oa("FINE",500);function ha(t){return t.c?t.c:t.a?ha(t.a):(F("Root logger has no level set."),null)}ia.prototype.log=function(t,e,n){if(t.value>=ha(this).value)for(v(e)&&(e=e()),t=new ra(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var la={},fa=null;function da(t){var e;if(fa||(fa=new ia(""),la[""]=fa,fa.c=ua),!(e=la[t])){e=new ia(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=da(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,la[t]=e}return e}function pa(t,e){t&&t.log(ca,e,void 0)}function va(t){this.f=t}function ga(t){Tn.call(this),this.u=t,this.h=void 0,this.readyState=ma,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=da("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}S(va,Yo),va.prototype.a=function(){return new ga(this.f)},va.prototype.b=function(t){return function(){return t}}({}),S(ga,Tn);var ma=0;function ya(t){t.c.read().then(t.pc.bind(t)).catch(t.Ua.bind(t))}function ba(t){t.readyState=4,t.g=null,t.c=null,t.m=null,_a(t)}function _a(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function wa(t){Tn.call(this),this.headers=new Pn,this.D=t||null,this.c=!1,this.C=this.a=null,this.h=this.R=this.l="",this.f=this.O=this.i=this.J=!1,this.g=0,this.s=null,this.m=Ia,this.u=this.S=!1}(e=ga.prototype).open=function(t,e){if(this.readyState!=ma)throw this.abort(),Error("Error reopening a connection");this.s=t,this.f=e,this.readyState=1,_a(this)},e.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.f,e)).then(this.uc.bind(this),this.Ua.bind(this))},e.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,ba(this)),this.readyState=ma},e.uc=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,_a(this)),this.a&&(this.readyState=3,_a(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.sc.bind(this),this.Ua.bind(this)):void 0!==u.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.m=new TextDecoder,ya(this)):t.text().then(this.tc.bind(this),this.Ua.bind(this)))))},e.pc=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?ba(this):_a(this),3==this.readyState&&ya(this)}},e.tc=function(t){this.a&&(this.response=this.responseText=t,ba(this))},e.sc=function(t){this.a&&(this.response=t,ba(this))},e.Ua=function(t){var e=this.i;e&&e.log(sa,"Failed to fetch url "+this.f,t instanceof Error?t:Error(t)),this.a&&ba(this)},e.setRequestHeader=function(t,e){this.l.append(t,e)},e.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.i)&&t.log(sa,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},e.getAllResponseHeaders=function(){if(!this.b){var t=this.i;return t&&t.log(sa,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(ga.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),S(wa,Tn);var Ia="";wa.prototype.b=da("goog.net.XhrIo");var Ta=/^https?$/i,Ea=["POST","PUT"];function Sa(t){return"content-type"==t.toLowerCase()}function Ca(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,ka(t),Aa(t)}function ka(t){t.J||(t.J=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Na(t){if(t.c&&void 0!==s)if(t.C[1]&&4==Pa(t)&&2==Ra(t))pa(t.b,Oa(t,"Local request error detected and ignored"));else if(t.i&&4==Pa(t))kn(t.Vb,0,t);else if(t.dispatchEvent("readystatechange"),4==Pa(t)){pa(t.b,Oa(t,"Request complete")),t.c=!1;try{var e,n=Ra(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(xn)[1]||null;if(!o&&u.self&&u.self.location){var a=u.self.location.protocol;o=a.substr(0,a.length-1)}i=!Ta.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<Pa(t)?t.a.statusText:""}catch(e){pa(t.b,"Can not get status: "+e.message),c=""}t.h=c+" ["+Ra(t)+"]",ka(t)}}finally{Aa(t)}}}function Aa(t,e){if(t.a){Da(t);var n=t.a,r=t.C[0]?f:null;t.a=null,t.C=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(aa,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Da(t){t.a&&t.u&&(t.a.ontimeout=null),t.s&&(u.clearTimeout(t.s),t.s=null)}function Pa(t){return t.a?t.a.readyState:0}function Ra(t){try{return 2<Pa(t)?t.a.status:-1}catch(t){return-1}}function Oa(t,e){return e+" ["+t.R+" "+t.l+" "+Ra(t)+"]"}function xa(t){var e=Wa;this.g=[],this.u=e,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function La(t,e,n){t.a=!0,t.c=n,t.f=!e,qa(t)}function Ma(t){if(t.a){if(!t.v)throw new ja(t);t.v=!1}}function Fa(t,e,n,r){t.g.push([e,n,r]),t.a&&qa(t)}function Ua(t){return J(t.g,(function(t){return v(t[1])}))}function qa(t){if(t.h&&t.a&&Ua(t)){var e=t.h,n=Ga[e];n&&(u.clearTimeout(n.a),delete Ga[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var s=o.call(i||t.s,e);void 0!==s&&(t.f=t.f&&(s==e||s instanceof Error),t.c=e=s),(x(e)||"function"==typeof u.Promise&&e instanceof u.Promise)&&(r=!0,t.i=!0)}catch(r){e=r,t.f=!0,Ua(t)||(n=!0)}}t.c=e,r&&(s=I(t.m,t,!0),r=I(t.m,t,!1),e instanceof xa?(Fa(e,s,r),e.C=!0):e.then(s,r)),n&&(e=new Ba(e),Ga[e.a]=e,t.h=e.a)}function ja(){L.call(this)}function Va(){L.call(this)}function Ba(t){this.a=u.setTimeout(I(this.c,this),0),this.b=t}(e=wa.prototype).Ma=function(){void 0!==s&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",pa(this.b,Oa(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},e.abort=function(){this.a&&this.c&&(pa(this.b,Oa(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Aa(this))},e.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Aa(this,!0)),wa.ab.Da.call(this)},e.Vb=function(){this.xa||(this.O||this.i||this.f?Na(this):this.Jc())},e.Jc=function(){Na(this)},e.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case Ia:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(aa,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return pa(this.b,"Can not get response: "+t.message),null}},xa.prototype.cancel=function(t){if(this.a)this.c instanceof xa&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(t=new Va(this),Ma(this),La(this,!1,t))}},xa.prototype.m=function(t,e){this.i=!1,La(this,t,e)},xa.prototype.then=function(t,e,n){var r,i,o=new Ie((function(t,e){r=t,i=e}));return Fa(this,r,(function(t){t instanceof Va?o.cancel():i(t)})),o.then(t,e,n)},xa.prototype.$goog_Thenable=!0,S(ja,L),ja.prototype.message="Deferred has already fired",ja.prototype.name="AlreadyCalledError",S(Va,L),Va.prototype.message="Deferred was canceled",Va.prototype.name="CanceledError",Ba.prototype.c=function(){throw delete Ga[this.a],this.b};var Ga={};function Ka(t){var e={},n=e.document||document,r=kt(t).toString(),i=ge(document,"SCRIPT"),o={Wb:i,Ma:void 0},a=new xa(o),s=null,c=null!=e.timeout?e.timeout:5e3;return 0<c&&(s=window.setTimeout((function(){Ha(i,!0);var t=new Qa(Ja,"Timeout reached for loading script "+r);Ma(a),La(a,!1,t)}),c),o.Ma=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Ha(i,e.xd||!1,s),Ma(a),La(a,!0,null))},i.onerror=function(){Ha(i,!0,s);var t=new Qa(za,"Error while loading script "+r);Ma(a),La(a,!1,t)},yt(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),le(i,o),function(t,e){bt(t,"HTMLScriptElement"),t.src=kt(e),(e=t.ownerDocument&&t.ownerDocument.defaultView)&&e!=u?e=l(e.document):(null===h&&(h=l(u.document)),e=h),e&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),a}function Wa(){if(this&&this.Wb){var t=this.Wb;t&&"SCRIPT"==t.tagName&&Ha(t,!0,this.Ma)}}function Ha(t,e,n){null!=n&&u.clearTimeout(n),t.onload=f,t.onerror=f,t.onreadystatechange=f,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var za=0,Ja=1;function Qa(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),L.call(this,n),this.code=t}function Ya(t){this.f=t}function Xa(e,n,r){if(this.c=e,e=n||{},this.l=e.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=e.secureTokenTimeout||ts,this.g=gt(e.secureTokenHeaders||es),this.h=e.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=e.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=e.firebaseTimeout||ns,this.a=gt(e.firebaseHeaders||rs),r&&(this.a["X-Client-Version"]=r,this.g["X-Client-Version"]=r),r="Node"==Er(),!(r=u.XMLHttpRequest||r&&t.Z.INTERNAL.node&&t.Z.INTERNAL.node.XMLHttpRequest)&&!Tr())throw new k("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,Tr()?this.f=new va(self):Sr()?this.f=new Ya(r):this.f=new ta,this.b=null}S(Qa,L),S(Ya,Yo),Ya.prototype.a=function(){return new this.f},Ya.prototype.b=function(){return{}};var Za,$a="idToken",ts=new Kr(3e4,6e4),es={"Content-Type":"application/x-www-form-urlencoded"},ns=new Kr(3e4,6e4),rs={"Content-Type":"application/json"};function is(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function os(t,e){e&&(t.l=as("https://securetoken.googleapis.com/v1/token",e),t.h=as("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=as("https://identitytoolkit.googleapis.com/v2/",e))}function as(t,e){return t=Vn(t),e=Vn(e.url),t.f=t.a+t.f,Mn(t,e.c),t.a=e.a,Fn(t,e.g),t.toString()}function ss(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function us(t,e,n,r,i,o,a){(function(){var t=Pr();return!((t=Nr(t)!=kr?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Yt&&ue&&!(9<ue))})()||Tr()?t=I(t.u,t):(Za||(Za=new Ie((function(t,e){!function(t,e){((window.gapi||{}).client||{}).request?t():(u[hs]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){Fa(t,null,e,void 0)}(Ka(Nt(cs,{onload:hs})),(function(){e(Error("CORS_UNSUPPORTED"))})))}(t,e)}))),t=I(t.s,t)),t(e,n,r,i,o,a)}Xa.prototype.T=function(){return this.b},Xa.prototype.u=function(t,e,n,r,i,o){if(Tr()&&(void 0===u.fetch||void 0===u.Headers||void 0===u.Request))throw new k("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new wa(this.f);if(o){a.g=Math.max(0,o);var s=setTimeout((function(){a.dispatchEvent("timeout")}),o)}En(a,"complete",(function(){s&&clearTimeout(s);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return pa(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)})),Sn(a,"ready",(function(){s&&clearTimeout(s),ze(this)})),Sn(a,"timeout",(function(){s&&clearTimeout(s),ze(this),e&&e(null)})),function(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.R=n,t.J=!1,t.c=!0,t.a=t.D?t.D.a():Wo.a(),t.C=t.D?Xo(t.D):Xo(Wo),t.a.onreadystatechange=I(t.Vb,t);try{pa(t.b,Oa(t,"Opening Xhr")),t.O=!0,t.a.open(n,String(e),!0),t.O=!1}catch(e){return pa(t.b,Oa(t,"Error opening Xhr: "+e.message)),void Ca(t,e)}e=r||"";var o=new Pn(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||"string"==typeof t)W(t,e,void 0);else for(var n=Dn(t),r=An(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,(function(t,e){o.set(e,t)})),i=function(t){t:{for(var e=Sa,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(o.Y()),r=u.FormData&&e instanceof u.FormData,!Q(Ea,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.S&&(t.a.withCredentials=t.S);try{Da(t),0<t.g&&(t.u=function(t){return Yt&&se(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),pa(t.b,Oa(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=I(t.Ma,t)):t.s=kn(t.Ma,t.g,t)),pa(t.b,Oa(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){pa(t.b,Oa(t,"Send error: "+e.message)),Ca(t,e)}}(a,t,n,r,i)};var cs=new _t(Et,"https://apis.google.com/js/client.js?onload=%{onload}"),hs="__fcb"+Math.floor(1e6*Math.random()).toString();function ls(t){if("string"!=typeof(t=t.email)||!br.test(t))throw new k("invalid-email")}function fs(t){"email"in t&&ls(t)}function ds(t){if(!t[$a]){if(t.mfaPendingCredential)throw new k("multi-factor-auth-required",null,gt(t));throw new k("internal-error")}}function ps(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new k("internal-error")}else{if(!t.sessionInfo)throw new k("missing-verification-id");if(!t.code)throw new k("missing-verification-code")}}Xa.prototype.s=function(t,e,n,r,i){var o=this;Za.then((function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})})).o((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},Xa.prototype.zb=function(){return ru(this,Ws,{})},Xa.prototype.Bb=function(t,e){return ru(this,Gs,{idToken:t,email:e})},Xa.prototype.Cb=function(t,e){return ru(this,Ks,{idToken:t,password:e})};var vs={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function gs(t){if(!t.phoneVerificationInfo)throw new k("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new k("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new k("missing-verification-code")}function ms(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new k("internal-error")}function ys(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&er(t=new Xn(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function bs(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Qo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Qo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Qo(t)):t.errorMessage&&(e=iu(t.errorMessage)),e)throw e;ds(t)}function _s(t,e){return e.returnIdpCredential=!0,ru(t,Js,e)}function ws(t,e){return e.returnIdpCredential=!0,ru(t,Ys,e)}function Is(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,ru(t,Qs,e)}function Ts(t){if(!t.oobCode)throw new k("invalid-action-code")}(e=Xa.prototype).Db=function(t,e){var n={idToken:t},r=[];return pt(vs,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),ru(this,Gs,n)},e.vb=function(t,e){return yt(t={requestType:"PASSWORD_RESET",email:t},e),ru(this,Us,t)},e.wb=function(t,e){return yt(t={requestType:"EMAIL_SIGNIN",email:t},e),ru(this,Ls,t)},e.ub=function(t,e){return yt(t={requestType:"VERIFY_EMAIL",idToken:t},e),ru(this,Ms,t)},e.Eb=function(t,e,n){return yt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),ru(this,Fs,t)},e.fb=function(t){return ru(this,$s,t)},e.nb=function(t,e){return ru(this,Vs,{oobCode:t,newPassword:e})},e.Ra=function(t){return ru(this,Ss,{oobCode:t})},e.jb=function(t){return ru(this,Es,{oobCode:t})};var Es={endpoint:"setAccountInfo",A:Ts,Z:"email",B:!0},Ss={endpoint:"resetPassword",A:Ts,G:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new k("internal-error")},B:!0},Cs={endpoint:"signupNewUser",A:function(t){if(ls(t),!t.password)throw new k("weak-password")},G:ds,V:!0,B:!0},ks={endpoint:"createAuthUri",B:!0},Ns={endpoint:"deleteAccount",N:["idToken"]},As={endpoint:"setAccountInfo",N:["idToken","deleteProvider"],A:function(t){if(!Array.isArray(t.deleteProvider))throw new k("internal-error")}},Ds={endpoint:"emailLinkSignin",N:["email","oobCode"],A:ls,G:ds,V:!0,B:!0},Ps={endpoint:"emailLinkSignin",N:["idToken","email","oobCode"],A:ls,G:ds,V:!0},Rs={endpoint:"accounts/mfaEnrollment:finalize",N:["idToken","phoneVerificationInfo"],A:gs,G:ds,B:!0,Na:!0},Os={endpoint:"accounts/mfaSignIn:finalize",N:["mfaPendingCredential","phoneVerificationInfo"],A:gs,G:ds,B:!0,Na:!0},xs={endpoint:"getAccountInfo"},Ls={endpoint:"getOobConfirmationCode",N:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new k("internal-error");ls(t)},Z:"email",B:!0},Ms={endpoint:"getOobConfirmationCode",N:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new k("internal-error")},Z:"email",B:!0},Fs={endpoint:"getOobConfirmationCode",N:["idToken","newEmail","requestType"],A:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new k("internal-error")},Z:"email",B:!0},Us={endpoint:"getOobConfirmationCode",N:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new k("internal-error");ls(t)},Z:"email",B:!0},qs={lb:!0,endpoint:"getProjectConfig",Ub:"GET"},js={lb:!0,endpoint:"getRecaptchaParam",Ub:"GET",G:function(t){if(!t.recaptchaSiteKey)throw new k("internal-error")}},Vs={endpoint:"resetPassword",A:Ts,Z:"email",B:!0},Bs={endpoint:"sendVerificationCode",N:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},Gs={endpoint:"setAccountInfo",N:["idToken"],A:fs,V:!0},Ks={endpoint:"setAccountInfo",N:["idToken"],A:function(t){if(fs(t),!t.password)throw new k("weak-password")},G:ds,V:!0},Ws={endpoint:"signupNewUser",G:ds,V:!0,B:!0},Hs={endpoint:"accounts/mfaEnrollment:start",N:["idToken","phoneEnrollmentInfo"],A:function(t){if(!t.phoneEnrollmentInfo)throw new k("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new k("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new k("missing-app-credential")},G:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new k("internal-error")},B:!0,Na:!0},zs={endpoint:"accounts/mfaSignIn:start",N:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new k("missing-app-credential")},G:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new k("internal-error")},B:!0,Na:!0},Js={endpoint:"verifyAssertion",A:ms,Ya:ys,G:bs,V:!0,B:!0},Qs={endpoint:"verifyAssertion",A:ms,Ya:ys,G:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new k("user-not-found");if(t.errorMessage)throw iu(t.errorMessage);ds(t)},V:!0,B:!0},Ys={endpoint:"verifyAssertion",A:function(t){if(ms(t),!t.idToken)throw new k("internal-error")},Ya:ys,G:bs,V:!0},Xs={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new k("invalid-custom-token")},G:ds,V:!0,B:!0},Zs={endpoint:"verifyPassword",A:function(t){if(ls(t),!t.password)throw new k("wrong-password")},G:ds,V:!0,B:!0},$s={endpoint:"verifyPhoneNumber",A:ps,G:ds,B:!0},tu={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new k("internal-error");ps(t)},G:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Qo(t);ds(t)}},eu={Hb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:ps,G:ds,B:!0},nu={endpoint:"accounts/mfaEnrollment:withdraw",N:["idToken","mfaEnrollmentId"],G:function(t){if(!!t[$a]^!!t.refreshToken)throw new k("internal-error")},B:!0,Na:!0};function ru(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.N))return De(new k("internal-error"));var r,i=!!e.Na,o=e.Ub||"POST";return Ae(n).then(e.A).then((function(){return e.V&&(n.returnSecureToken=!0),e.B&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),function(t,e,n,r,i,o,a){var s=Vn(e+n);qn(s,"key",t.c),a&&qn(s,"cb",Date.now().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&qn(s,c,i[c]);return new Ie((function(e,n){us(t,s.toString(),(function(t){t?t.error?n(ou(t,o||{})):e(t):n(new k("network-request-failed"))}),r,u?void 0:or(qr(i)),t.a,t.v.get())}))}(t,i?t.i:t.h,e.endpoint,o,n,e.Hb,e.lb||!1)})).then((function(t){return r=t,e.Ya?e.Ya(n,r):r})).then(e.G).then((function(){if(!e.Z)return r;if(!(e.Z in r))throw new k("internal-error");return r[e.Z]}))}function iu(t){return ou({error:{errors:[{message:t}],code:400,message:t}})}function ou(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new k(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",yt(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new k(r[i],e);return!e&&t&&(e=Ur(t)),new k("internal-error",e)}function au(t){this.b=t,this.a=null,this.rb=function(t){return(hu||(hu=new Ie((function(t,e){function n(){Gr(),Rr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Gr(),e(Error("Network Error"))},timeout:uu.get()})}if(Rr("gapi.iframes.Iframe"))t();else if(Rr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();u[r]=function(){Rr("gapi.load")?n():e(Error("Network Error"))},Ae(Ka(r=Nt(su,{onload:r}))).o((function(){e(Error("Network Error"))}))}})).o((function(t){throw hu=null,t})))).then((function(){return new Ie((function(e,n){Rr("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Rr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),cu.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var su=new _t(Et,"https://apis.google.com/js/api.js?onload=%{onload}"),uu=new Kr(3e4,6e4),cu=new Kr(5e3,15e3),hu=null;function lu(t,e,n,r){this.l=t,this.h=e,this.i=n,this.g=r,this.f=null,t=this.g?Bn((t=Vn(this.g.url)).c,t.a,t.g,"/emulator/auth/iframe"):Bn("https",this.l,null,"/__/auth/iframe"),this.a=t,qn(this.a,"apiKey",this.h),qn(this.a,"appName",this.i),this.b=null,this.c=[]}function fu(t,e,n,r,i,o){this.u=t,this.s=e,this.c=n,this.m=r,this.v=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function du(e){try{return t.Z.app(e).auth().Ga()}catch(t){return[]}}function pu(t,e,n,r,i,o){this.s=t,this.g=e,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function vu(t){var e=fr();return function(t){return ru(t,qs,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Vn(e),r=n.c;n=n.a;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=Vn(o).a==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:yr.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new zo(fr())}))}function gu(t){return t.m||(t.m=_r().then((function(){if(!t.u){var e=t.c,n=t.i,r=du(t.b),i=new lu(t.s,t.g,t.b,t.f);i.f=e,i.b=n,i.c=$(r||[]),t.u=i.toString()}t.v=new au(t.u),function(t){if(!t.v)throw Error("IfcHandler must be initialized!");!function(t,e){t.rb.then((function(){t.a.register("authEvent",e,Rr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.v,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Go(e.authEvent),n=0;n<t.h.length;n++)r=t.h[n](e)||r;return(n={}).status=r?"ACK":"ERROR",Ae(n)}return n.status="ERROR",Ae(n)}))}(t)}))),t.m}function mu(t){return t.l||(t.C=t.c?Dr(t.c,du(t.b)):null,t.l=new Xa(t.g,O(t.i),t.C),t.f&&os(t.l,t.f)),t.l}function yu(t,e,n,r,i,o,a,s,u,c,h,l){return(t=new fu(t,e,n,r,i,l)).l=o,t.g=a,t.i=s,t.b=gt(u||null),t.f=c,t.yb(h).toString()}function bu(e){if(this.a=e||t.Z.INTERNAL.reactNative&&t.Z.INTERNAL.reactNative.AsyncStorage,!this.a)throw new k("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function _u(t){this.b=t,this.a={},this.f=I(this.c,this)}lu.prototype.toString=function(){return this.f?qn(this.a,"v",this.f):tr(this.a.b,"v"),this.b?qn(this.a,"eid",this.b):tr(this.a.b,"eid"),this.c.length?qn(this.a,"fw",this.c.join(",")):tr(this.a.b,"fw"),this.a.toString()},fu.prototype.yb=function(t){return this.h=t,this},fu.prototype.toString=function(){if(this.v){var e=Vn(this.v.url);e=Bn(e.c,e.a,e.g,"/emulator/auth/handler")}else e=Bn("https",this.u,null,"/__/auth/handler");if(qn(e,"apiKey",this.s),qn(e,"appName",this.c),qn(e,"authType",this.m),this.a.isOAuthProvider){var n=this.a;try{var r=t.Z.app(this.c).auth().la()}catch(t){r=null}for(var i in n.ob=r,qn(e,"providerId",this.a.providerId),n=qr((r=this.a).Ib))n[i]=n[i].toString();i=r.Qc,n=gt(n);for(var o=0;o<i.length;o++){var a=i[o];a in n&&delete n[a]}r.pb&&r.ob&&!n[r.pb]&&(n[r.pb]=r.ob),vt(n)||qn(e,"customParameters",Ur(n))}if("function"==typeof this.a.Qb&&(r=this.a.Qb()).length&&qn(e,"scopes",r.join(",")),this.l?qn(e,"redirectUrl",this.l):tr(e.b,"redirectUrl"),this.g?qn(e,"eventId",this.g):tr(e.b,"eventId"),this.i?qn(e,"v",this.i):tr(e.b,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!jn(e,s)&&qn(e,s,this.b[s]);return this.h?qn(e,"tid",this.h):tr(e.b,"tid"),this.f?qn(e,"eid",this.f):tr(e.b,"eid"),(s=du(this.c)).length&&qn(e,"fw",s.join(",")),e.toString()},(e=pu.prototype).Ob=function(t,e,n){var r=new k("popup-closed-by-user"),i=new k("web-storage-unsupported"),o=this,a=!1;return this.ma().then((function(){(function(t){var e={type:"webStorageSupport"};return gu(t).then((function(){return function(t,e){return t.rb.then((function(){return new Ie((function(n){t.a.send(e.type,e,n,Rr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.v,e)})).then((function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&gr(t),e(i),a=!0)}))})).o((function(){})).then((function(){if(!a)return function(t){return new Ie((function(e){return function n(){Nn(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!a)return Nn(n).then((function(){e(r)}))}))},e.Xb=function(){var t=Pr();return!Fr(t)&&!Br(t)},e.Tb=function(){return!1},e.Mb=function(t,e,n,r,i,o,a,s){if(!t)return De(new k("popup-blocked"));if(a&&!Fr())return this.ma().o((function(e){gr(t),i(e)})),r(),Ae();this.a||(this.a=vu(mu(this)));var u=this;return this.a.then((function(){var e=u.ma().o((function(e){throw gr(t),i(e),e}));return r(),e})).then((function(){Vo(n),a||dr(yu(u.s,u.g,u.b,e,n,null,o,u.c,void 0,u.i,s,u.f),t)})).o((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},e.Nb=function(t,e,n,r){this.a||(this.a=vu(mu(this)));var i=this;return this.a.then((function(){Vo(e),dr(yu(i.s,i.g,i.b,t,e,fr(),n,i.c,void 0,i.i,r,i.f))})).o((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},e.ma=function(){var t=this;return gu(this).then((function(){return t.v.rb})).o((function(){throw t.a=null,new k("network-request-failed")}))},e.$b=function(){return!0},e.Ea=function(t){this.h.push(t)},e.Sa=function(t){X(this.h,(function(e){return e==t}))},(e=bu.prototype).get=function(t){return Ae(this.a.getItem(t)).then((function(t){return t&&jr(t)}))},e.set=function(t,e){return Ae(this.a.setItem(t,Ur(e)))},e.U=function(t){return Ae(this.a.removeItem(t))},e.ca=function(){},e.ia=function(){};var wu,Iu=[];function Tu(t,e,n){vt(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function Eu(t){this.a=t}function Su(t){this.c=t,this.b=!1,this.a=[]}function Cu(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return De(Error("connection_unavailable"));var h=r?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new Ie((function(n,r){l?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),a=setTimeout((function(){r(Error("unsupported_event"))}),h),c={messageChannel:l,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}},t.a.push(c),l.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[l.port2])):r(Error("connection_unavailable"))})).then((function(e){return ku(t,c),e})).o((function(e){throw ku(t,c),e}))}function ku(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),X(t.a,(function(t){return t==e}))}}function Nu(){if(!Ru())throw new k("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=u.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var t=this;Tr()&&self?(this.v=function(){var t=Tr()?self:null;if(W(Iu,(function(n){n.b==t&&(e=n)})),!e){var e=new _u(t);Iu.push(e)}return e}(),Tu(this.v,"keyChanged",(function(e,n){return Fu(t).then((function(e){return 0<e.length&&W(t.a,(function(t){t(e)})),{keyProcessed:Q(e,n.key)}}))})),Tu(this.v,"ping",(function(){return Ae(["keyChanged"])}))):function(){var t=u.navigator;return t&&t.serviceWorker?Ae().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).o((function(){return null})):Ae(null)}().then((function(e){(t.h=e)&&(t.g=new Su(new Eu(e)),Cu(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&Q(e[0].value,"keyChanged")&&(t.s=!0)})).o((function(){})))}))}function Au(t){return new Ie((function(e,n){var r=t.m.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(r):function(t){return new Ie((function(e,n){var r=t.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(t).then((function(){return Au(t)})).then((function(t){e(t)})).o((function(t){n(t)}))}}))}function Du(t){return t.i||(t.i=Au(t)),t.i}function Pu(t,e){var n=0;return new Ie((function r(i,o){Du(t).then(e).then(i).o((function(e){if(!(3<++n))return Du(t).then((function(e){return e.close(),t.i=void 0,r(i,o)})).o((function(t){o(t)}));o(e)}))}))}function Ru(){try{return!!u.indexedDB}catch(t){return!1}}function Ou(t){return t.objectStore("firebaseLocalStorage")}function xu(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Lu(t){return new Ie((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function Mu(t,e){return t.g&&t.h&&function(){var t=u.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?Cu(t.g,"keyChanged",{key:e},t.s).then((function(){})).o((function(){})):Ae()}function Fu(t){return Du(t).then((function(t){var e=Ou(xu(t,!1));return e.getAll?Lu(e.getAll()):new Ie((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=pr(t.c,n),t.c=n}return r}))}function Uu(t){t.l&&t.l.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function qu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Ae().then((function(){if(Ru()){var t=Vr(),r="__sak"+t;return wu||(wu=new Nu),(n=wu).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.U(r)})).then((function(){return n})).o((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ca((function(t){W(e.a,(function(e){e(t)}))})),t}))}function ju(){this.a={},this.type="inMemory"}function Vu(){if(!function(){var e="Node"==Er();if(!(e=Bu()||e&&t.Z.INTERNAL.node&&t.Z.INTERNAL.node.localStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Er())throw new k("internal-error","The LocalStorage compatibility library was not found.");throw new k("web-storage-unsupported")}this.a=Bu()||t.Z.INTERNAL.node.localStorage,this.type="localStorage"}function Bu(){try{var t=u.localStorage,e=Vr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Gu(){this.type="nullStorage"}function Ku(){if(!function(){var e="Node"==Er();if(!(e=Wu()||e&&t.Z.INTERNAL.node&&t.Z.INTERNAL.node.sessionStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Er())throw new k("internal-error","The SessionStorage compatibility library was not found.");throw new k("web-storage-unsupported")}this.a=Wu()||t.Z.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Wu(){try{var t=u.sessionStorage,e=Vr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Hu(){var t={};t.Browser=Qu,t.Node=Yu,t.ReactNative=Xu,t.Worker=Zu,this.a=t[Er()]}_u.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];W(r,(function(e){i.push(Ae().then((function(){return e(t.origin,t.data.data)})))})),Re(i).then((function(r){var i=[];W(r,(function(t){i.push({fulfilled:t.Pb,value:t.value,reason:t.reason?t.reason.message:void 0})})),W(i,(function(t){for(var e in t)void 0===t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},Eu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Su.prototype.close=function(){for(;0<this.a.length;)ku(this,this.a[0]);this.b=!0},(e=Nu.prototype).set=function(t,e){var n=this,r=!1;return Pu(this,(function(e){return Lu((e=Ou(xu(e,!0))).get(t))})).then((function(i){return Pu(n,(function(o){if(o=Ou(xu(o,!0)),i)return i.value=e,Lu(o.put(i));n.b++,r=!0;var a={};return a.fbase_key=t,a.value=e,Lu(o.add(a))}))})).then((function(){return n.c[t]=e,Mu(n,t)})).oa((function(){r&&n.b--}))},e.get=function(t){return Pu(this,(function(e){return Lu(Ou(xu(e,!1)).get(t))})).then((function(t){return t&&t.value}))},e.U=function(t){var e=this,n=!1;return Pu(this,(function(r){return n=!0,e.b++,Lu(Ou(xu(r,!0)).delete(t))})).then((function(){return delete e.c[t],Mu(e,t)})).oa((function(){n&&e.b--}))},e.ca=function(t){0==this.a.length&&function(t){Uu(t),function e(){t.f=setTimeout((function(){t.l=Fu(t).then((function(e){0<e.length&&W(t.a,(function(t){t(e)}))})).then((function(){e()})).o((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}()}(this),this.a.push(t)},e.ia=function(t){X(this.a,(function(e){return e==t})),0==this.a.length&&Uu(this)},(e=qu.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},e.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},e.U=function(t){return this.b.then((function(e){return e.U(t)}))},e.ca=function(t){this.a.push(t)},e.ia=function(t){X(this.a,(function(e){return e==t}))},(e=ju.prototype).get=function(t){return Ae(this.a[t])},e.set=function(t,e){return this.a[t]=e,Ae()},e.U=function(t){return delete this.a[t],Ae()},e.ca=function(){},e.ia=function(){},(e=Vu.prototype).get=function(t){var e=this;return Ae().then((function(){return jr(e.a.getItem(t))}))},e.set=function(t,e){var n=this;return Ae().then((function(){var r=Ur(e);null===r?n.U(t):n.a.setItem(t,r)}))},e.U=function(t){var e=this;return Ae().then((function(){e.a.removeItem(t)}))},e.ca=function(t){u.window&&ln(u.window,"storage",t)},e.ia=function(t){u.window&&pn(u.window,"storage",t)},(e=Gu.prototype).get=function(){return Ae(null)},e.set=function(){return Ae()},e.U=function(){return Ae()},e.ca=function(){},e.ia=function(){},(e=Ku.prototype).get=function(t){var e=this;return Ae().then((function(){return jr(e.a.getItem(t))}))},e.set=function(t,e){var n=this;return Ae().then((function(){var r=Ur(e);null===r?n.U(t):n.a.setItem(t,r)}))},e.U=function(t){var e=this;return Ae().then((function(){e.a.removeItem(t)}))},e.ca=function(){},e.ia=function(){};var zu,Ju,Qu={F:Vu,bb:Ku},Yu={F:Vu,bb:Ku},Xu={F:bu,bb:Gu},Zu={F:Vu,bb:Gu},$u={rd:"local",NONE:"none",td:"session"};function tc(){var t=!(Br(Pr())||!Ir()),e=Fr(),n=Or();this.m=t,this.h=e,this.l=n,this.a={},zu||(zu=new Hu),t=zu;try{this.g=!lr()&&zr()||!u.indexedDB?new t.a.F:new qu(Tr()?new ju:new t.a.F)}catch(t){this.g=new ju,this.h=!0}try{this.i=new t.a.bb}catch(t){this.i=new ju}this.v=new ju,this.f=I(this.Yb,this),this.b={}}function ec(){return Ju||(Ju=new tc),Ju}function nc(t,e){switch(e){case"session":return t.i;case"none":return t.v;default:return t.g}}function rc(t,e){return"firebase:"+t.name+(e?":"+e:"")}function ic(t,e,n){return n=rc(e,n),"local"==e.F&&(t.b[n]=null),nc(t,e.F).U(n)}function oc(t){t.c&&(clearInterval(t.c),t.c=null)}function ac(t){this.a=t,this.b=ec()}(e=tc.prototype).get=function(t,e){return nc(this,t.F).get(rc(t,e))},e.set=function(t,e,n){var r=rc(t,n),i=this,o=nc(this,t.F);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.F&&(i.b[r]=e)}))},e.addListener=function(t,e,n){t=rc(t,e),this.l&&(this.b[t]=u.localStorage.getItem(t)),vt(this.a)&&(nc(this,"local").ca(this.f),this.h||(lr()||!zr())&&u.indexedDB||!this.l||function(t){oc(t),t.c=setInterval((function(){for(var e in t.a){var n=u.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new $e({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Yb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},e.removeListener=function(t,e,n){t=rc(t,e),this.a[t]&&(X(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),vt(this.a)&&(nc(this,"local").ia(this.f),oc(this))},e.Yb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=u.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.mb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?nc(this,"local").ia(this.f):oc(this),this.m)if(n=u.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?u.localStorage.setItem(e,r):u.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===u.localStorage.getItem(e)||(o.b[e]=u.localStorage.getItem(e),o.mb(e))},Yt&&ue&&10==ue&&u.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else W(t,I(this.mb,this))},e.mb=function(t){this.a[t]&&W(this.a[t],(function(t){t()}))};var sc,uc={name:"authEvent",F:"local"};function cc(){this.a=ec()}function hc(t,e){this.b=lc,this.f=u.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=u.Int32Array?new Int32Array(64):Array(64),void 0===sc&&(sc=u.Int32Array?new Int32Array(yc):yc),this.reset()}S(hc,(function(){this.b=-1}));for(var lc=64,fc=lc-1,dc=[],pc=0;pc<fc;pc++)dc[pc]=0;var vc=Z(128,dc);function gc(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&h^~c&l)+(0|sc[e])|0)+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function mc(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"==typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(gc(t),i=0);else{if(!p(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(gc(t),i=0)}}t.c=i,t.g+=n}hc.prototype.reset=function(){this.g=this.c=0,this.a=u.Int32Array?new Int32Array(this.h):$(this.h)};var yc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function bc(){hc.call(this,8,_c)}S(bc,hc);var _c=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function wc(t,e,n,r,i,o){this.v=t,this.i=e,this.l=n,this.m=r||null,this.u=i||null,this.s=o,this.h=e+":"+n,this.C=new cc,this.g=new ac(this.h),this.f=null,this.b=[],this.a=this.c=null}function Ic(t){return new k("invalid-cordova-configuration",t)}function Tc(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Ec(t){return t.f||(t.f=t.ma().then((function(){return new Ie((function(e){t.Ea((function n(r){return e(r),t.Sa(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),Sc(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=ao(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=jr(jn(o=Vn(i),"firebaseError")||null))?N(o):null)?new Bo(r.c,r.b,null,null,o,null,r.T()):new Bo(r.c,r.b,i,r.f,null,null,r.T())),i=o||n}Tc(t,i)}))}var n=new Bo("unknown",null,null,null,new k("no-auth-event")),r=!1,i=Nn(500).then((function(){return Sc(t).then((function(){r||Tc(t,n)}))})),o=u.handleOpenURL;u.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Rr("BuildInfo.packageName",u).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(t){console.error(t)}},Ho||(Ho=new Ko),function(t){var e=Ho;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=Rr("universalLinks.subscribe",u))&&t(null,e.b))}(e)}(t)}))}))),t.f}function Sc(t){var e=null;return function(t){return t.b.get(uc,t.a).then((function(t){return Go(t)}))}(t.g).then((function(n){return e=n,ic((n=t.g).b,uc,n.a)})).then((function(){return e}))}function Cc(t){this.a=t,this.b=ec()}(e=wc.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(wr(void 0)?_r().then((function(){return new Ie((function(t,e){var n=u.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):De(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof Rr("universalLinks.subscribe",u))throw Ic("cordova-universal-links-plugin-fix is not installed");if(void 0===Rr("BuildInfo.packageName",u))throw Ic("cordova-plugin-buildinfo is not installed");if("function"!=typeof Rr("cordova.plugins.browsertab.openUrl",u))throw Ic("cordova-plugin-browsertab is not installed");if("function"!=typeof Rr("cordova.InAppBrowser.open",u))throw Ic("cordova-plugin-inappbrowser is not installed")}),(function(){throw new k("cordova-not-ready")}))},e.Ob=function(t,e){return e(new k("operation-not-supported-in-this-environment")),Ae()},e.Mb=function(){return De(new k("operation-not-supported-in-this-environment"))},e.$b=function(){return!1},e.Xb=function(){return!0},e.Tb=function(){return!0},e.Nb=function(t,e,n,r){if(this.c)return De(new k("redirect-operation-pending"));var i=this,o=u.document,a=null,s=null,c=null,h=null;return this.c=Ae().then((function(){return Vo(e),Ec(i)})).then((function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new Bo(e,r,null,o,new k("no-auth-event"),null,i),s=Rr("BuildInfo.packageName",u);if("string"!=typeof s)throw new k("invalid-cordova-configuration");var c=Rr("BuildInfo.displayName",u),h={};if(Pr().toLowerCase().match(/iphone|ipad|ipod/))h.ibi=s;else{if(!Pr().toLowerCase().match(/android/))return De(new k("operation-not-supported-in-this-environment"));h.apn=s}c&&(h.appDisplayName=c),o=function(t){var e=new bc;mc(e,t),t=[];var n=8*e.g;56>e.c?mc(e,vc,56-e.c):mc(e,vc,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(gc(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return z(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}(o),h.sessionId=o;var l=yu(t.v,t.i,t.l,e,n,null,r,t.m,h,t.u,i,t.s);return t.ma().then((function(){var e=t.h;return t.C.a.set(uc,a.w(),e)})).then((function(){var e=Rr("cordova.plugins.browsertab.isAvailable",u);if("function"!=typeof e)throw new k("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!=typeof(n=Rr("cordova.plugins.browsertab.openUrl",u)))throw new k("invalid-cordova-configuration");n(l)}else{if("function"!=typeof(n=Rr("cordova.InAppBrowser.open",u)))throw new k("invalid-cordova-configuration");e=Pr(),t.a=n(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new Ie((function(t,e){s=function(){var e=Rr("cordova.plugins.browsertab.close",u);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(s),c=function(){a||(a=Nn(2e3).then((function(){e(new k("redirect-cancelled-by-user"))})))},h=function(){Wr()&&c()},o.addEventListener("resume",c,!1),Pr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",h,!1)})).o((function(t){return Sc(i).then((function(){throw t}))}))})).oa((function(){c&&o.removeEventListener("resume",c,!1),h&&o.removeEventListener("visibilitychange",h,!1),a&&a.cancel(),s&&i.Sa(s),i.c=null}))},e.Ea=function(t){this.b.push(t),Ec(this).o((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Bo("unknown",null,null,null,new k("no-auth-event")),t(e))}))},e.Sa=function(t){X(this.b,(function(e){return e==t}))};var kc={name:"pendingRedirect",F:"session"};function Nc(t){return ic(t.b,kc,t.a)}function Ac(t,e,n,r){this.i={},this.u=0,this.D=t,this.v=e,this.m=n,this.J=r,this.h=[],this.f=!1,this.l=I(this.s,this),this.b=new Kc,this.C=new Qc,this.g=new Cc(Bc(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=Dc(this.D,this.v,this.m,A,this.J)}function Dc(e,n,r,i,o){var a=t.Z.SDK_VERSION||null;return wr()?new wc(e,n,r,a,i,o):new pu(e,n,r,a,i,o)}function Pc(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.ma().o((function(n){throw t.a==e&&t.reset(),n}))}function Rc(t){t.a.Xb()&&Pc(t).o((function(e){var n=new Bo("unknown",null,null,null,new k("operation-not-supported-in-this-environment"));Uc(e)&&t.s(n)})),t.a.Tb()||Wc(t.b)}function Oc(t,e){Q(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(kc,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?Nc(t.g).then((function(){Pc(t).o((function(e){var n=new Bo("unknown",null,null,null,new k("operation-not-supported-in-this-environment"));Uc(e)&&t.s(n)}))})):Rc(t)})).o((function(){Rc(t)}))}function xc(t,e){X(t.h,(function(t){return t==e}))}Ac.prototype.reset=function(){this.f=!1,this.a.Sa(this.l),this.a=Dc(this.D,this.v,this.m,null,this.J),this.i={}},Ac.prototype.s=function(t){if(!t)throw new k("invalid-auth-event");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Fb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=Date.now())),e=!0;break}}return Wc(this.b),e};var Lc=new Kr(2e3,1e4),Mc=new Kr(3e4,6e4);function Fc(t,e,n,r,i,o,a){return t.a.Mb(e,n,r,(function(){t.f||(t.f=!0,t.a.Ea(t.l))}),(function(){t.reset()}),i,o,a)}function Uc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function qc(t,e,n,r,i){var o;return function(t){return t.b.set(kc,"pending",t.a)}(t.g).then((function(){return t.a.Nb(e,n,r,i).o((function(e){if(Uc(e))throw new k("operation-not-supported-in-this-environment");return o=e,Nc(t.g).then((function(){throw o}))})).then((function(){return t.a.$b()?new Ie((function(){})):Nc(t.g).then((function(){return t.qa()})).then((function(){})).o((function(){}))}))}))}function jc(t,e,n,r,i){return t.a.Ob(r,(function(t){e.na(n,null,t,i)}),Lc.get())}Ac.prototype.qa=function(){return this.b.qa()};var Vc={};function Bc(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function Gc(t,e,n,r){var i=Bc(e,n,r);return Vc[i]||(Vc[i]=new Ac(t,e,n,r)),Vc[i]}function Kc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Wc(t){t.g||(t.g=!0,Jc(t,!1,null,null))}function Hc(t){t.g&&!t.i&&Jc(t,!1,null,null)}function zc(t,e){if(t.b=function(){return Ae(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Jc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return De(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):zc(t,n):zc(t,{user:null}),t.f=[],t.c=[]}function Qc(){}function Yc(){this.ib=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.ib},set:function(t){this.ib=t},enumerable:!1})}function Xc(t,e){this.a=e,Zr(this,"verificationId",t)}function Zc(t,e,n,r){return new Uo(t).fb(e,n).then((function(t){return new Xc(t,r)}))}function $c(t){var e=Hi(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new k("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");$r(this,{token:t,expirationTime:Hr(1e3*e.exp),authTime:Hr(1e3*e.auth_time),issuedAtTime:Hr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function th(t,e,n){var r=e&&e[nh];if(!r)throw new k("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=gt(e),this.g=n,this.c=new so(null,r),this.b=[];var i=this;W(e[eh]||[],(function(t){(t=ri(t))&&i.b.push(t)})),Zr(this,"auth",this.a),Zr(this,"session",this.c),Zr(this,"hints",this.b)}Kc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Kc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(Jc(this,!0,null,t.a),Ae()):e.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,a=e.T(),s=!!e.c.match(/Redirect$/);n(r,i,a,o).then((function(e){Jc(t,s,e,null)})).o((function(e){Jc(t,s,null,e)}))}(this,t,e):De(new k("invalid-auth-event")):(Jc(this,!1,null,null),Ae())}else De(new k("invalid-auth-event"))},Kc.prototype.qa=function(){var t=this;return new Ie((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new k("timeout");t.a&&t.a.cancel(),t.a=Nn(Mc.get()).then((function(){t.b||(t.g=!0,Jc(t,!0,null,e))}))}(t))}))},Qc.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.na(t.c,null,t.a,t.b),Ae()):e.Fa(n,r)?function(t,e){var n=t.b,r=t.c;e.Fa(r,n)(t.g,t.f,t.T(),t.i).then((function(t){e.na(r,t,null,n)})).o((function(t){e.na(r,null,t,n)}))}(t,e):De(new k("invalid-auth-event"))}else De(new k("invalid-auth-event"))},Xc.prototype.confirm=function(t){return t=qo(this.verificationId,t),this.a(t)};var eh="mfaInfo",nh="mfaPendingCredential";function rh(t,e,n,r){k.call(this,"multi-factor-auth-required",r,e),this.b=new th(t,e,n),Zr(this,"resolver",this.b)}function ih(t,e,n){if(t&&g(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new rh(e,t.serverResponse,n,t.message)}catch(t){}return null}function oh(){}function ah(t){Zr(this,"factorId",t.fa),this.a=t}function sh(t){if(ah.call(this,t),this.a.fa!=Uo.PROVIDER_ID)throw new k("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function uh(t,e){for(var n in Ze.call(this,t),e)this[n]=e[n]}function ch(t,e){this.a=t,this.b=[],this.c=I(this.yc,this),ln(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&W(e.multiFactor.enrolledFactors,(function(t){var e=null,r={};if(t){t.uid&&(r[ai]=t.uid),t.displayName&&(r[ii]=t.displayName),t.enrollmentTime&&(r[oi]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[si]=t.phoneNumber);try{e=new ui(r)}catch(t){}t=e}else t=null;t&&n.push(t)})),hh(this,n)}function hh(t,e){t.b=e,Zr(t,"enrolledFactors",e)}function lh(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function fh(t,e){t.stop(),t.b=Nn(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(t,e)).then((function(){return function(){var t=u.document,e=null;return Wr()||!t?Ae():new Ie((function(n){e=function(){Wr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).o((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return t.h()})).then((function(){fh(t,!0)})).o((function(e){t.i(e)&&fh(t,!1)}))}function dh(t){this.f=t,this.b=this.a=null,this.c=Date.now()}function ph(t,e){void 0===e&&(e=t.b?(e=t.b).a-e.g:0),t.c=Date.now()+1e3*e}function vh(t,e){t.b=Wi(e[$a]||""),t.a=e.refreshToken,ph(t,void 0!==(e=e.expiresIn)?Number(e):void 0)}function gh(t,e){this.a=t||null,this.b=e||null,$r(this,{lastSignInTime:Hr(e||null),creationTime:Hr(t||null)})}function mh(t,e,n,r,i,o){$r(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function yh(e,n,r){this.J=[],this.l=e.apiKey,this.m=e.appName,this.s=e.authDomain||null;var i=t.Z.SDK_VERSION?Dr(t.Z.SDK_VERSION):null;this.a=new Xa(this.l,O(A),i),e.emulatorConfig&&os(this.a,e.emulatorConfig),this.b=new dh(this.a),Ch(this,n[$a]),vh(this.b,n),Zr(this,"refreshToken",this.b.a),Ah(this,r||{}),Tn.call(this),this.R=!1,this.s&&xr()&&(this.i=Gc(this.s,this.l,this.m)),this.S=[],this.h=null,this.u=function(t){return new lh((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=t.b.c-Date.now()-3e5;return 0<e?e:0}))}(this),this.aa=I(this.hb,this);var o=this;this.ya=null,this.Oa=function(t){o.wa(t.h)},this.ja=null,this.Aa=function(t){os(o.a,t.c)},this.X=null,this.$=[],this.Ba=function(t){wh(o,t.f)},this.ba=null,this.O=new ch(this,r),Zr(this,"multiFactor",this.O)}function bh(t,e){t.ja&&pn(t.ja,"languageCodeChanged",t.Oa),(t.ja=e)&&ln(e,"languageCodeChanged",t.Oa)}function _h(t,e){t.X&&pn(t.X,"emulatorConfigChanged",t.Aa),(t.X=e)&&ln(e,"emulatorConfigChanged",t.Aa)}function wh(e,n){e.$=n,ss(e.a,t.Z.SDK_VERSION?Dr(t.Z.SDK_VERSION,e.$):null)}function Ih(t,e){t.ba&&pn(t.ba,"frameworkChanged",t.Ba),(t.ba=e)&&ln(e,"frameworkChanged",t.Ba)}function Th(e){try{return t.Z.app(e.m).auth()}catch(t){throw new k("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+e.m+"'!")}}function Eh(t){t.D||t.u.b||(t.u.start(),pn(t,"tokenChanged",t.aa),ln(t,"tokenChanged",t.aa))}function Sh(t){pn(t,"tokenChanged",t.aa),t.u.stop()}function Ch(t,e){t.za=e,Zr(t,"_lat",e)}function kh(t){for(var e=[],n=0;n<t.S.length;n++)e.push(t.S[n](t));return Re(e).then((function(){return t}))}function Nh(t){t.i&&!t.R&&(t.R=!0,Oc(t.i,t))}function Ah(t,e){$r(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new gh(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Dh(){}function Ph(t){return Ae().then((function(){if(t.D)throw new k("app-deleted")}))}function Rh(t){return z(t.providerData,(function(t){return t.providerId}))}function Oh(t,e){e&&(xh(t,e.providerId),t.providerData.push(e))}function xh(t,e){X(t.providerData,(function(t){return t.providerId==e}))}function Lh(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Zr(t,e,n)}function Mh(t,e){t!=e&&($r(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?Zr(t,"metadata",function(t){return new gh(t.a,t.b)}(e.metadata)):Zr(t,"metadata",new gh),W(e.providerData,(function(e){Oh(t,e)})),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.b,e.b),Zr(t,"refreshToken",t.b.a),hh(t.O,e.O.b))}function Fh(t){return t.I().then((function(e){var n=t.isAnonymous;return function(t,e){return ru(t.a,xs,{idToken:e}).then(I(t.Kc,t))}(t,e).then((function(){return n||Lh(t,"isAnonymous",!1),e}))}))}function Uh(t,e){e[$a]&&t.za!=e[$a]&&(vh(t.b,e),t.dispatchEvent(new uh("tokenChanged")),Ch(t,e[$a]),Lh(t,"refreshToken",t.b.a))}function qh(t,e){return Fh(t).then((function(){if(Q(Rh(t),e))return kh(t).then((function(){throw new k("provider-already-linked")}))}))}function jh(t,e,n){return ti({user:t,credential:jo(e),additionalUserInfo:e=Xi(e),operationType:n})}function Vh(t,e){return Uh(t,e),t.reload().then((function(){return t}))}function Bh(e,n,r,i,o){if(!xr())return De(new k("operation-not-supported-in-this-environment"));if(e.h&&!o)return De(e.h);var a=Yi(r.providerId),s=Vr(e.uid+":::"),u=null;(!Fr()||Ir())&&e.s&&r.isOAuthProvider&&(u=yu(e.s,e.l,e.m,n,r,null,s,t.Z.SDK_VERSION||null,null,null,e.tenantId));var c=mr(u,a&&a.ua,a&&a.ta);return i=i().then((function(){if(Kh(e),!o)return e.I().then((function(){}))})).then((function(){return Fc(e.i,c,n,r,s,!!u,e.tenantId)})).then((function(){return new Ie((function(t,r){e.na(n,null,new k("cancelled-popup-request"),e.g||null),e.f=t,e.C=r,e.g=s,e.c=jc(e.i,e,n,c,s)}))})).then((function(t){return c&&gr(c),t?ti(t):null})).o((function(t){throw c&&gr(c),t})),Wh(e,i,o)}function Gh(t,e,n,r,i){if(!xr())return De(new k("operation-not-supported-in-this-environment"));if(t.h&&!i)return De(t.h);var o=null,a=Vr(t.uid+":::");return r=r().then((function(){if(Kh(t),!i)return t.I().then((function(){}))})).then((function(){return t.ga=a,kh(t)})).then((function(e){return t.ha&&(e=(e=t.ha).b.set(Jh,t.w(),e.a)),e})).then((function(){return qc(t.i,e,n,a,t.tenantId)})).o((function(e){if(o=e,t.ha)return Qh(t.ha);throw o})).then((function(){if(o)throw o})),Wh(t,r,i)}function Kh(t){if(!t.i||!t.R){if(t.i&&!t.R)throw new k("internal-error");throw new k("auth-domain-config-required")}}function Wh(t,e,n){var r=function(t,e,n){return t.h&&!n?(e.cancel(),De(t.h)):e.o((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.h||t.dispatchEvent(new uh("userInvalidated")),t.h=e),e}))}(t,e,n);return t.J.push(r),r.oa((function(){Y(t.J,r)})),r.o((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=ih(e.w(),Th(t),I(t.jc,t))),n||e}))}function Hh(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[$a]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=t.stsTokenManager.expirationTime;r&&(n.expiresIn=(r-Date.now())/1e3);var i=new yh(e,n,t);return t.providerData&&W(t.providerData,(function(t){t&&Oh(i,ti(t))})),t.redirectEventId&&(i.ga=t.redirectEventId),i}function zh(t){this.a=t,this.b=ec()}th.prototype.Rc=function(t){var e=this;return t.sb(this.a.a,this.c).then((function(t){var n=gt(e.f);return delete n[eh],delete n[nh],yt(n,t),e.g(n)}))},S(rh,k),oh.prototype.sb=function(t,e,n){return e.type==uo?function(t,e,n,r){return n.Ha().then((function(n){return n={idToken:n},void 0!==r&&(n.displayName=r),yt(n,{phoneVerificationInfo:Fo(t.a)}),ru(e,Rs,n)}))}(this,t,e,n):function(t,e,n){return n.Ha().then((function(n){return yt(n={mfaPendingCredential:n},{phoneVerificationInfo:Fo(t.a)}),ru(e,Os,n)}))}(this,t,e)},S(ah,oh),S(sh,ah),S(uh,Ze),(e=ch.prototype).yc=function(t){hh(this,function(t){var e=[];return W(t.mfaInfo||[],(function(t){(t=ri(t))&&e.push(t)})),e}(t.hd))},e.Rb=function(){return this.a.I().then((function(t){return new so(t,null)}))},e.fc=function(t,e){var n=this,r=this.a.a;return this.Rb().then((function(n){return t.sb(r,n,e)})).then((function(t){return Uh(n.a,t),n.a.reload()}))},e.bd=function(t){var e=this,n="string"==typeof t?t:t.uid,r=this.a.a;return this.a.I().then((function(t){return ru(r,nu,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var r=H(e.b,(function(t){return t.uid!=n}));return hh(e,r),Uh(e.a,t),e.a.reload().o((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},e.w=function(){return{multiFactor:{enrolledFactors:z(this.b,(function(t){return t.w()}))}}},lh.prototype.start=function(){this.a=this.c,fh(this,!0)},lh.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},dh.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},dh.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?De(new k("user-token-expired")):t||!this.b||Date.now()>this.c-3e4?this.a?function(t,e){return function(t,e){return new Ie((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?us(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r(ou(t)):t.access_token&&t.refresh_token?n(t):r(new k("internal-error")):r(new k("network-request-failed"))}),"POST",$n(e).toString(),t.g,t.m.get()):r(new k("internal-error"))}))}(t.f,e).then((function(e){return t.b=Wi(e.access_token),t.a=e.refresh_token,ph(t,e.expires_in),{accessToken:t.b.toString(),refreshToken:t.a}})).o((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}(this,{grant_type:"refresh_token",refresh_token:this.a}):Ae(null):Ae({accessToken:this.b.toString(),refreshToken:this.a})},gh.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},S(yh,Tn),yh.prototype.wa=function(t){this.ya=t,is(this.a,t)},yh.prototype.la=function(){return this.ya},yh.prototype.Ga=function(){return $(this.$)},yh.prototype.hb=function(){this.u.b&&(this.u.stop(),this.u.start())},Zr(yh.prototype,"providerId","firebase"),(e=yh.prototype).reload=function(){var t=this;return Wh(this,Ph(this).then((function(){return Fh(t).then((function(){return kh(t)})).then(Dh)})))},e.oc=function(t){return this.I(t).then((function(t){return new $c(t)}))},e.I=function(t){var e=this;return Wh(this,Ph(this).then((function(){return e.b.getToken(t)})).then((function(t){if(!t)throw new k("internal-error");return t.accessToken!=e.za&&(Ch(e,t.accessToken),e.dispatchEvent(new uh("tokenChanged"))),Lh(e,"refreshToken",t.refreshToken),t.accessToken})))},e.Kc=function(t){if(!(t=t.users)||!t.length)throw new k("internal-error");Ah(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?z(t,(function(t){return new mh(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)Oh(this,e[n]);Lh(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new uh("userReloaded",{hd:t}))},e.Lc=function(t){return Yr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.tb(t)},e.tb=function(t){var e=this,n=null;return Wh(this,t.c(this.a,this.uid).then((function(t){return Uh(e,t),n=jh(e,t,"reauthenticate"),e.h=null,e.reload()})).then((function(){return n})),!0)},e.Cc=function(t){return Yr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.qb(t)},e.qb=function(t){var e=this,n=null;return Wh(this,qh(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=jh(e,t,"link"),Vh(e,t)})).then((function(){return n})))},e.Dc=function(t,e){var n=this;return Wh(this,qh(this,"phone").then((function(){return Zc(Th(n),t,e,I(n.qb,n))})))},e.Mc=function(t,e){var n=this;return Wh(this,Ae().then((function(){return Zc(Th(n),t,e,I(n.tb,n))})),!0)},e.Bb=function(t){var e=this;return Wh(this,this.I().then((function(n){return e.a.Bb(n,t)})).then((function(t){return Uh(e,t),e.reload()})))},e.ed=function(t){var e=this;return Wh(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return Uh(e,t),e.reload()})))},e.Cb=function(t){var e=this;return Wh(this,this.I().then((function(n){return e.a.Cb(n,t)})).then((function(t){return Uh(e,t),e.reload()})))},e.Db=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Ph(this);var e=this;return Wh(this,this.I().then((function(n){return e.a.Db(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return Uh(e,t),Lh(e,"displayName",t.displayName||null),Lh(e,"photoURL",t.photoUrl||null),W(e.providerData,(function(t){"password"===t.providerId&&(Zr(t,"displayName",e.displayName),Zr(t,"photoURL",e.photoURL))})),kh(e)})).then(Dh))},e.cd=function(t){var e=this;return Wh(this,Fh(this).then((function(n){return Q(Rh(e),t)?function(t,e,n){return ru(t,As,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return W(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),W(Rh(e),(function(t){n[t]||xh(e,t)})),n[Uo.PROVIDER_ID]||Zr(e,"phoneNumber",null),kh(e)})):kh(e).then((function(){throw new k("no-such-provider")}))})))},e.delete=function(){var t=this;return Wh(this,this.I().then((function(e){return ru(t.a,Ns,{idToken:e})})).then((function(){t.dispatchEvent(new uh("userDeleted"))}))).then((function(){for(var e=0;e<t.J.length;e++)t.J[e].cancel("app-deleted");bh(t,null),_h(t,null),Ih(t,null),t.J=[],t.D=!0,Sh(t),Zr(t,"refreshToken",null),t.i&&xc(t.i,t)}))},e.Fb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},e.na=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},e.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?I(this.Kb,this):"reauthViaPopup"==t&&e==(this.g||null)?I(this.Lb,this):"linkViaRedirect"==t&&(this.ga||null)==e?I(this.Kb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?I(this.Lb,this):null},e.Ec=function(t){var e=this;return Bh(this,"linkViaPopup",t,(function(){return qh(e,t.providerId).then((function(){return kh(e)}))}),!1)},e.Nc=function(t){return Bh(this,"reauthViaPopup",t,(function(){return Ae()}),!0)},e.Fc=function(t){var e=this;return Gh(this,"linkViaRedirect",t,(function(){return qh(e,t.providerId)}),!1)},e.Oc=function(t){return Gh(this,"reauthViaRedirect",t,(function(){return Ae()}),!0)},e.Kb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Wh(this,this.I().then((function(n){return ws(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=jh(i,t,"link"),Vh(i,t)})).then((function(){return o})))},e.Lb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Wh(this,Ae().then((function(){return lo(Is(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=jh(i,t,"reauthenticate"),Uh(i,t),i.h=null,i.reload()})).then((function(){return o})),!0)},e.ub=function(t){var e=this,n=null;return Wh(this,this.I().then((function(e){return n=e,void 0===t||vt(t)?{}:Bi(new Ri(t))})).then((function(t){return e.a.ub(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},e.Eb=function(t,e){var n=this,r=null;return Wh(this,this.I().then((function(t){return r=t,void 0===e||vt(e)?{}:Bi(new Ri(e))})).then((function(e){return n.a.Eb(r,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},e.jc=function(t){var e=null,n=this;return Wh(this,t=lo(Ae(t),n.uid).then((function(t){return e=jh(n,t,"reauthenticate"),Uh(n,t),n.h=null,n.reload()})).then((function(){return e})),!0)},e.toJSON=function(){return this.w()},e.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.b.w(),redirectEventId:this.ga||null};return this.metadata&&yt(t,this.metadata.w()),W(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),yt(t,this.O.w()),t};var Jh={name:"redirectUser",F:"session"};function Qh(t){return ic(t.b,Jh,t.a)}function Yh(t){this.a=t,this.b=ec(),this.c=null,this.f=function(t){var e=$h("local"),n=$h("session"),r=$h("none");return function(t,e,n){var r=rc(e,n),i=nc(t,e.F);return t.get(e,n).then((function(o){var a=null;try{a=jr(u.localStorage.getItem(r))}catch(t){}if(a&&!o)return u.localStorage.removeItem(r),t.set(e,a,n);a&&o&&"localStorage"!=i.type&&u.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(Zh,t.a).then((function(t){return t?$h(t):e}))}))}))})).then((function(e){return t.c=e,Xh(t,e.F)})).o((function(){t.c||(t.c=e)}))}(this),this.b.addListener($h("local"),this.a,I(this.g,this))}function Xh(t,e){var n,r=[];for(n in $u)$u[n]!==e&&r.push(ic(t.b,$h($u[n]),t.a));return r.push(ic(t.b,Zh,t.a)),function(t){return new Ie((function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},s=0;s<t.length;s++)Pe(t[s],T(o,s),a);else e(i)}))}(r)}Yh.prototype.g=function(){var t=this,e=$h("local");rl(this,(function(){return Ae().then((function(){return t.c&&"local"!=t.c.F?t.b.get(e,t.a):null})).then((function(n){if(n)return Xh(t,"local").then((function(){t.c=e}))}))}))};var Zh={name:"persistence",F:"session"};function $h(t){return{name:"authUser",F:t}}function tl(t,e){return rl(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function el(t){return rl(t,(function(){return ic(t.b,t.c,t.a)}))}function nl(t,e,n){return rl(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),Hh(t||{})}))}))}function rl(t,e){return t.f=t.f.then(e,e),t.f}function il(e){if(this.l=!1,Zr(this,"settings",new Yc),Zr(this,"app",e),!fl(this).options||!fl(this).options.apiKey)throw new k("invalid-api-key");e=t.Z.SDK_VERSION?Dr(t.Z.SDK_VERSION):null,this.a=new Xa(fl(this).options&&fl(this).options.apiKey,O(A),e),this.R=[],this.s=[],this.O=[],this.hb=t.Z.INTERNAL.createSubscribe(I(this.zc,this)),this.X=void 0,this.bc=t.Z.INTERNAL.createSubscribe(I(this.Ac,this)),hl(this,null),this.i=new Yh(fl(this).options.apiKey+":"+fl(this).name),this.D=new zh(fl(this).options.apiKey+":"+fl(this).name),this.$=gl(this,function(t){var e=fl(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Jh,t.a).then((function(t){return t&&e&&(t.authDomain=e),Hh(t||{})}))}(t.D,fl(t).options.authDomain).then((function(e){return(t.m=e)&&(e.ha=t.D),Qh(t.D)}));return gl(t,e)}(t).then((function(){return nl(t.i,e,t.P)})).then((function(e){return e?(e.ha=t.D,t.m&&(t.m.ga||null)==(e.ga||null)?e:e.reload().then((function(){return tl(t.i,e).then((function(){return e}))})).o((function(n){return"auth/network-request-failed"==n.code?e:el(t.i)}))):null})).then((function(e){hl(t,e||null)}));return gl(t,n)}(this)),this.h=gl(this,function(t){return t.$.then((function(){return cl(t)})).o((function(){})).then((function(){if(!t.l)return t.ja()})).o((function(){})).then((function(){if(!t.l){t.ba=!0;var e=t.i;e.b.addListener($h("local"),e.a,t.ja)}}))}(this)),this.ba=!1,this.ja=I(this.Zc,this),this.Ba=I(this.da,this),this.ya=I(this.mc,this),this.za=I(this.wc,this),this.Aa=I(this.xc,this),this.b=null,function(t){var e=fl(t).options.authDomain,n=fl(t).options.apiKey;e&&xr()&&(t.Oa=t.$.then((function(){if(!t.l){if(t.b=Gc(e,n,fl(t).name,t.P),Oc(t.b,t),dl(t)&&Nh(dl(t)),t.m){Nh(t.m);var r=t.m;r.wa(t.la()),bh(r,t),wh(r=t.m,t.J),Ih(r,t),os((r=t.m).a,t.P),_h(r,t),t.m=null}return t.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=I(this.delete,this),this.INTERNAL.logFramework=I(this.Gc,this),this.u=0,Tn.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.la()},set:function(t){this.wa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.T()},set:function(t){this.yb(t)},enumerable:!1}),t.S=null,Object.defineProperty(t,"emulatorConfig",{get:function(){if(this.P){var t=Vn(this.P.url);t=ti({protocol:t.c,host:t.a,port:t.g,options:ti({disableWarnings:this.P.ec})})}else t=null;return t},enumerable:!1})}(this),this.J=[],this.P=null}function ol(t){Ze.call(this,"languageCodeChanged"),this.h=t}function al(t){Ze.call(this,"emulatorConfigChanged"),this.c=t}function sl(t){Ze.call(this,"frameworkChanged"),this.f=t}function ul(t){return t.Oa||De(new k("auth-domain-config-required"))}function cl(t){if(!xr())return De(new k("operation-not-supported-in-this-environment"));var e=ul(t).then((function(){return t.b.qa()})).then((function(t){return t?ti(t):null}));return gl(t,e)}function hl(t,e){dl(t)&&(function(t,e){X(t.S,(function(t){return t==e}))}(dl(t),t.Ba),pn(dl(t),"tokenChanged",t.ya),pn(dl(t),"userDeleted",t.za),pn(dl(t),"userInvalidated",t.Aa),Sh(dl(t))),e&&(e.S.push(t.Ba),ln(e,"tokenChanged",t.ya),ln(e,"userDeleted",t.za),ln(e,"userInvalidated",t.Aa),0<t.u&&Eh(e)),Zr(t,"currentUser",e),e&&(e.wa(t.la()),bh(e,t),wh(e,t.J),Ih(e,t),os(e.a,t.P),_h(e,t))}function ll(t,e){var n=null,r=null;return gl(t,e.then((function(e){return n=jo(e),r=Xi(e),function(t,e){var n={};return n.apiKey=fl(t).options.apiKey,n.authDomain=fl(t).options.authDomain,n.appName=fl(t).name,t.P&&(n.emulatorConfig=t.P),t.$.then((function(){return function(t,e,n,r){var i=new yh(t,e);return n&&(i.ha=n),r&&wh(i,r),i.reload().then((function(){return i}))}(n,e,t.D,t.Ga())})).then((function(e){return dl(t)&&e.uid==dl(t).uid?(Mh(dl(t),e),t.da(e)):(hl(t,e),Nh(e),t.da(e))})).then((function(){vl(t)}))}(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=ih(e.w(),t,I(t.kc,t))),n||e})).then((function(){return ti({user:dl(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function fl(t){return t.app}function dl(t){return t.currentUser}function pl(t){return dl(t)&&dl(t)._lat||null}function vl(t){if(t.ba){for(var e=0;e<t.s.length;e++)t.s[e]&&t.s[e](pl(t));if(t.X!==t.getUid()&&t.O.length)for(t.X=t.getUid(),e=0;e<t.O.length;e++)t.O[e]&&t.O[e](pl(t))}}function gl(t,e){return t.R.push(e),e.oa((function(){Y(t.R,e)})),e}function ml(){}function yl(){this.a={},this.b=1e12}Yh.prototype.xb=function(t){var e=null,n=this;return function(t){var e=new k("invalid-persistence-type"),n=new k("unsupported-persistence-type");t:{for(r in $u)if($u[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(Er()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!Ru()&&"none"!==t)throw n;break;default:if(!Or()&&"none"!==t)throw n}}(t),rl(this,(function(){return t!=n.c.F?n.b.get(n.c,n.a).then((function(r){return e=r,Xh(n,t)})).then((function(){if(n.c=$h(t),e)return n.b.set(n.c,e,n.a)})):Ae()}))},S(il,Tn),S(ol,Ze),S(al,Ze),S(sl,Ze),(e=il.prototype).xb=function(t){return gl(this,t=this.i.xb(t))},e.wa=function(t){this.aa===t||this.l||(this.aa=t,is(this.a,this.aa),this.dispatchEvent(new ol(this.la())))},e.la=function(){return this.aa},e.fd=function(){var t=u.navigator;this.wa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},e.gd=function(t,e){if(!this.P){if(!/^https?:\/\//.test(t))throw new k("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");(function(t){"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),u.document&&!t&&_r().then((function(){var t=u.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#ff0000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),u.document.body.appendChild(t)}))})(e=!!e&&!!e.disableWarnings),this.P={url:t,ec:e},this.settings.ib=!0,os(this.a,this.P),this.dispatchEvent(new al(this.P))}},e.Gc=function(e){this.J.push(e),ss(this.a,t.Z.SDK_VERSION?Dr(t.Z.SDK_VERSION,this.J):null),this.dispatchEvent(new sl(this.J))},e.Ga=function(){return $(this.J)},e.yb=function(t){this.S===t||this.l||(this.S=t,this.a.b=this.S)},e.T=function(){return this.S},e.toJSON=function(){return{apiKey:fl(this).options.apiKey,authDomain:fl(this).options.authDomain,appName:fl(this).name,currentUser:dl(this)&&dl(this).w()}},e.Fb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},e.na=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},e.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?I(this.ic,this):null},e.ic=function(t,e,n,r){var i=this,o={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return ll(i,_s(i.a,o))}))},e.Xc=function(e){if(!xr())return De(new k("operation-not-supported-in-this-environment"));var n=this,r=Yi(e.providerId),i=Vr(),o=null;(!Fr()||Ir())&&fl(this).options.authDomain&&e.isOAuthProvider&&(o=yu(fl(this).options.authDomain,fl(this).options.apiKey,fl(this).name,"signInViaPopup",e,null,i,t.Z.SDK_VERSION||null,null,null,this.T(),this.P));var a=mr(o,r&&r.ua,r&&r.ta);return gl(this,r=ul(this).then((function(t){return Fc(t,a,"signInViaPopup",e,i,!!o,n.T())})).then((function(){return new Ie((function(t,e){n.na("signInViaPopup",null,new k("cancelled-popup-request"),n.g),n.f=t,n.C=e,n.g=i,n.c=jc(n.b,n,"signInViaPopup",a,i)}))})).then((function(t){return a&&gr(a),t?ti(t):null})).o((function(t){throw a&&gr(a),t})))},e.Yc=function(t){if(!xr())return De(new k("operation-not-supported-in-this-environment"));var e=this;return gl(this,ul(this).then((function(){return function(t){return rl(t,(function(){return t.b.set(Zh,t.c.F,t.a)}))}(e.i)})).then((function(){return qc(e.b,"signInViaRedirect",t,void 0,e.T())})))},e.qa=function(){var t=this;return cl(this).then((function(e){return t.b&&Hc(t.b.b),e})).o((function(e){throw t.b&&Hc(t.b.b),e}))},e.dd=function(t){if(!t)return De(new k("null-user"));if(this.S!=t.tenantId)return De(new k("tenant-id-mismatch"));var e=this,n={};n.apiKey=fl(this).options.apiKey,n.authDomain=fl(this).options.authDomain,n.appName=fl(this).name;var r=function(t,e,n,r){var i=t.b,o={};return o[$a]=i.b&&i.b.toString(),o.refreshToken=i.a,e=new yh(e||{apiKey:t.l,authDomain:t.s,appName:t.m},o),n&&(e.ha=n),r&&wh(e,r),Mh(e,t),e}(t,n,e.D,e.Ga());return gl(this,this.h.then((function(){if(fl(e).options.apiKey!=t.l)return r.reload()})).then((function(){return dl(e)&&t.uid==dl(e).uid?(Mh(dl(e),t),e.da(t)):(hl(e,r),Nh(r),e.da(r))})).then((function(){vl(e)})))},e.Ab=function(){var t=this;return gl(this,this.h.then((function(){return t.b&&Hc(t.b.b),dl(t)?(hl(t,null),el(t.i).then((function(){vl(t)}))):Ae()})))},e.Zc=function(){var t=this;return nl(this.i,fl(this).options.authDomain).then((function(e){if(!t.l){var n;if(n=dl(t)&&e){n=dl(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Mh(dl(t),e),dl(t).I();(dl(t)||e)&&(hl(t,e),e&&(Nh(e),e.ha=t.D),t.b&&Oc(t.b,t),vl(t))}}))},e.da=function(t){return tl(this.i,t)},e.mc=function(){vl(this),this.da(dl(this))},e.wc=function(){this.Ab()},e.xc=function(){this.Ab()},e.kc=function(t){var e=this;return this.h.then((function(){return ll(e,Ae(t))}))},e.zc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(dl(e))}))},e.Ac=function(t){var e=this;!function(t,e){t.O.push(e),gl(t,t.h.then((function(){!t.l&&Q(t.O,e)&&t.X!==t.getUid()&&(t.X=t.getUid(),e(pl(t)))})))}(this,(function(){t.next(dl(e))}))},e.Ic=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"==typeof t?t(dl(r)):"function"==typeof t.next&&t.next(dl(r))})),this.hb(t,e,n)},e.Hc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.X=r.getUid(),"function"==typeof t?t(dl(r)):"function"==typeof t.next&&t.next(dl(r))})),this.bc(t,e,n)},e.nc=function(t){var e=this;return gl(this,this.h.then((function(){return dl(e)?dl(e).I(t).then((function(t){return{accessToken:t}})):null})))},e.Tc=function(t){var e=this;return this.h.then((function(){return ll(e,ru(e.a,Xs,{token:t}))})).then((function(t){var n=t.user;return Lh(n,"isAnonymous",!1),e.da(n),t}))},e.Uc=function(t,e){var n=this;return this.h.then((function(){return ll(n,ru(n.a,Zs,{email:t,password:e}))}))},e.dc=function(t,e){var n=this;return this.h.then((function(){return ll(n,ru(n.a,Cs,{email:t,password:e}))}))},e.$a=function(t){var e=this;return this.h.then((function(){return ll(e,t.ka(e.a))}))},e.Sc=function(t){return Yr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.$a(t)},e.zb=function(){var t=this;return this.h.then((function(){var e=dl(t);if(e&&e.isAnonymous){var n=ti({providerId:null,isNewUser:!1});return ti({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return ll(t,t.a.zb()).then((function(e){var n=e.user;return Lh(n,"isAnonymous",!0),t.da(n),e}))}))},e.getUid=function(){return dl(this)&&dl(this).uid||null},e.cc=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&dl(this)&&Eh(dl(this))},e.Pc=function(t){var e=this;W(this.s,(function(n){n==t&&e.u--})),0>this.u&&(this.u=0),0==this.u&&dl(this)&&Sh(dl(this)),this.removeAuthTokenListener(t)},e.addAuthTokenListener=function(t){var e=this;this.s.push(t),gl(this,this.h.then((function(){e.l||Q(e.s,t)&&t(pl(e))})))},e.removeAuthTokenListener=function(t){X(this.s,(function(e){return e==t}))},e.delete=function(){this.l=!0;for(var t=0;t<this.R.length;t++)this.R[t].cancel("app-deleted");return this.R=[],this.i&&(t=this.i).b.removeListener($h("local"),t.a,this.ja),this.b&&(xc(this.b,this),Hc(this.b.b)),Promise.resolve()},e.hc=function(t){return gl(this,function(t,e){return ru(t,ks,{identifier:e,continueUri:Lr()?fr():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.a,t))},e.Bc=function(t){return!!xo(t)},e.wb=function(t,e){var n=this;return gl(this,Ae().then((function(){var t=new Ri(e);if(!t.c)throw new k("argument-error",Li+" must be true when sending sign in link to email");return Bi(t)})).then((function(e){return n.a.wb(t,e)})).then((function(){})))},e.jd=function(t){return this.Ra(t).then((function(t){return t.data.email}))},e.nb=function(t,e){return gl(this,this.a.nb(t,e).then((function(){})))},e.Ra=function(t){return gl(this,this.a.Ra(t).then((function(t){return new ci(t)})))},e.jb=function(t){return gl(this,this.a.jb(t).then((function(){})))},e.vb=function(t,e){var n=this;return gl(this,Ae().then((function(){return void 0===e||vt(e)?{}:Bi(new Ri(e))})).then((function(e){return n.a.vb(t,e)})).then((function(){})))},e.Wc=function(t,e){return gl(this,Zc(this,t,e,I(this.$a,this)))},e.Vc=function(t,e){var n=this;return gl(this,Ae().then((function(){var r=e||fr(),i=Oo(t,r);if(!(r=xo(r)))throw new k("argument-error","Invalid email link!");if(r.tenantId!==n.T())throw new k("tenant-id-mismatch");return n.$a(i)})))},ml.prototype.render=function(){},ml.prototype.reset=function(){},ml.prototype.getResponse=function(){},ml.prototype.execute=function(){};var bl=null;function _l(t,e){return(e=wl(e))&&t.a[e]||null}function wl(t){return(t=void 0===t?1e12:t)?t.toString():null}function Il(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=he(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():ln(this.f,"click",this.i)}function Tl(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function El(){}function Sl(){}yl.prototype.render=function(t,e){return this.a[this.b.toString()]=new Il(t,e),this.b++},yl.prototype.reset=function(t){var e=_l(this,t);t=wl(t),e&&t&&(e.delete(),delete this.a[t])},yl.prototype.getResponse=function(t){return(t=_l(this,t))?t.getResponse():null},yl.prototype.execute=function(t){(t=_l(this,t))&&t.execute()},Il.prototype.getResponse=function(){return Tl(this),this.b},Il.prototype.execute=function(){Tl(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(t){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()}),6e4)}),500))},Il.prototype.delete=function(){Tl(this),this.g=!0,clearTimeout(this.a),this.a=null,pn(this.f,"click",this.i)},Zr(El,"FACTOR_ID","phone"),Sl.prototype.g=function(){return bl||(bl=new yl),Ae(bl)},Sl.prototype.c=function(){};var Cl=null;function kl(){this.b=u.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Nl=new _t(Et,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Al=new Kr(3e4,6e4);kl.prototype.g=function(t){var e=this;return new Ie((function(n,r){var i=setTimeout((function(){r(new k("network-request-failed"))}),Al.get());!u.grecaptcha||t!==e.f&&!e.b?(u[e.a]=function(){if(u.grecaptcha){e.f=t;var o=u.grecaptcha.render;u.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(u.grecaptcha)}else clearTimeout(i),r(new k("internal-error"));delete u[e.a]},Ae(Ka(Nt(Nl,{onload:e.a,hl:t||""}))).o((function(){clearTimeout(i),r(new k("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(u.grecaptcha))}))},kl.prototype.c=function(){this.b--};var Dl=null;function Pl(t,e,n,r,i,o,a){if(Zr(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.v=e,this.g=null,a?(Cl||(Cl=new Sl),a=Cl):(Dl||(Dl=new kl),a=Dl),this.m=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[xl])throw new k("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Ll],!u.document)throw new k("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!he(e)||!this.i&&he(e).hasChildNodes())throw new k("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new Xa(t,o||null,i||null),this.u=r||function(){return null};var s=this;this.l=[];var c=this.a[Rl];this.a[Rl]=function(t){if(Ml(s,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=Rr(c,u);"function"==typeof e&&e(t)}};var h=this.a[Ol];this.a[Ol]=function(){if(Ml(s,null),"function"==typeof h)h();else if("string"==typeof h){var t=Rr(h,u);"function"==typeof t&&t()}}}var Rl="callback",Ol="expired-callback",xl="sitekey",Ll="size";function Ml(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(t){}}function Fl(t,e){return t.h.push(e),e.oa((function(){Y(t.h,e)})),e}function Ul(t){if(t.D)throw new k("internal-error","RecaptchaVerifier instance has been destroyed.")}function ql(e,n,r){var i=!1;try{this.b=r||t.Z.app()}catch(t){throw new k("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new k("invalid-api-key");r=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().Ga()}catch(t){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}a=t.Z.SDK_VERSION?Dr(t.Z.SDK_VERSION,a):null,Pl.call(this,r,e,n,(function(){try{var t=o.b.auth().la()}catch(e){t=null}return t}),a,O(A),i)}function jl(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new k("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=Vl.length)throw new k("internal-error","Argument validator received an unsupported number of arguments.");n=Vl[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new k("argument-error",t+" failed: "+r)}(e=Pl.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=Fl(this,Ae().then((function(){if(Lr()&&!Tr())return _r();throw new k("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.m.g(t.u())})).then((function(e){return t.g=e,ru(t.s,js,{})})).then((function(e){t.a[xl]=e.recaptchaSiteKey})).o((function(e){throw t.f=null,e})))},e.render=function(){Ul(this);var t=this;return Fl(this,this.Ia().then((function(){if(null===t.c){var e=t.v;if(!t.i){var n=he(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!ce&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Wt(a.name),'"'),a.type){o.push(' type="',Wt(a.type),'"');var s={};yt(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=ge(i,o),a&&("string"==typeof a?o.className=a:Array.isArray(a)?o.className=a.join(" "):le(o,a)),2<r.length&&ve(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},e.verify=function(){Ul(this);var t=this;return Fl(this,this.render().then((function(e){return new Ie((function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){X(t.l,(function(t){return t==e}))}(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}}))})))},e.reset=function(){Ul(this),null!==this.c&&this.g.reset(this.c)},e.clear=function(){Ul(this),this.D=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=he(this.v);for(var e;e=t.firstChild;)t.removeChild(e)}},S(ql,Pl);var Vl="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Bl(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:function(t){return"string"==typeof t}}}function Gl(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:function(t){return"boolean"==typeof t}}}function Kl(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:g}}function Wl(t,e){return{name:t||"",K:"a function",optional:!!e,M:function(t){return"function"==typeof t}}}function Hl(t,e){return{name:t||"",K:"null",optional:!!e,M:function(t){return null===t}}}function zl(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ka||!n)}}}function Jl(t,e){return g(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function Ql(t){return g(t)&&"string"==typeof t.uid}function Yl(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function Xl(t,e){for(var n in e){var r=e[n].name;t[r]=tf(r,t[n],e[n].j)}}function Zl(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:T((function(t){return this[t]}),n),set:T((function(t,e,n,r){jl(t,[n],[r],!0),this[e]=r}),r,n,e[n].kb),enumerable:!0})}}function $l(t,e,n,r){t[e]=tf(e,n,r)}function tf(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return jl(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}Xl(il.prototype,{jb:{name:"applyActionCode",j:[Bl("code")]},Ra:{name:"checkActionCode",j:[Bl("code")]},nb:{name:"confirmPasswordReset",j:[Bl("code"),Bl("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Bl("email"),Bl("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[Bl("email")]},qa:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[Bl("emailLink")]},Hc:{name:"onAuthStateChanged",j:[Yl(Kl(),Wl(),"nextOrObserver"),Wl("opt_error",!0),Wl("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[Yl(Kl(),Wl(),"nextOrObserver"),Wl("opt_error",!0),Wl("opt_completed",!0)]},vb:{name:"sendPasswordResetEmail",j:[Bl("email"),Yl(Kl("opt_actionCodeSettings",!0),Hl(null,!0),"opt_actionCodeSettings",!0)]},wb:{name:"sendSignInLinkToEmail",j:[Bl("email"),Kl("actionCodeSettings")]},xb:{name:"setPersistence",j:[Bl("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[zl()]},zb:{name:"signInAnonymously",j:[]},$a:{name:"signInWithCredential",j:[zl()]},Tc:{name:"signInWithCustomToken",j:[Bl("token")]},Uc:{name:"signInWithEmailAndPassword",j:[Bl("email"),Bl("password")]},Vc:{name:"signInWithEmailLink",j:[Bl("email"),Bl("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[Bl("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Xc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Yc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},dd:{name:"updateCurrentUser",j:[Yl({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof yh)}},Hl(),"user")]},Ab:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Bl(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[Bl("url"),Kl("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[Bl("code")]}}),Zl(il.prototype,{lc:{name:"languageCode",kb:Yl(Bl(),Hl(),"languageCode")},ti:{name:"tenantId",kb:Yl(Bl(),Hl(),"tenantId")}}),il.Persistence=$u,il.Persistence.LOCAL="local",il.Persistence.SESSION="session",il.Persistence.NONE="none",Xl(yh.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[Gl("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Gl("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[zl()]},qb:{name:"linkWithCredential",j:[zl()]},Dc:{name:"linkWithPhoneNumber",j:[Bl("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[zl()]},tb:{name:"reauthenticateWithCredential",j:[zl()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[Bl("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Nc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},ub:{name:"sendEmailVerification",j:[Yl(Kl("opt_actionCodeSettings",!0),Hl(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Bl(null,!0)]},cd:{name:"unlink",j:[Bl("provider")]},Bb:{name:"updateEmail",j:[Bl("email")]},Cb:{name:"updatePassword",j:[Bl("password")]},ed:{name:"updatePhoneNumber",j:[zl("phone")]},Db:{name:"updateProfile",j:[Kl("profile")]},Eb:{name:"verifyBeforeUpdateEmail",j:[Bl("email"),Yl(Kl("opt_actionCodeSettings",!0),Hl(null,!0),"opt_actionCodeSettings",!0)]}}),Xl(yl.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Xl(ml.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Xl(Ie.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),Zl(Yc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",kb:Gl("appVerificationDisabledForTesting")}}),Xl(Xc.prototype,{confirm:{name:"confirm",j:[Bl("verificationCode")]}}),$l(ho,"fromJSON",(function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[yo,Po,Mo,vo],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[Yl(Bl(),Kl(),"json")]),$l(Ro,"credential",(function(t,e){return new Do(t,e)}),[Bl("email"),Bl("password")]),Xl(Do.prototype,{w:{name:"toJSON",j:[Bl(null,!0)]}}),Xl(Io.prototype,{Ca:{name:"addScope",j:[Bl("scope")]},Ka:{name:"setCustomParameters",j:[Kl("customOAuthParameters")]}}),$l(Io,"credential",To,[Yl(Bl(),Kl(),"token")]),$l(Ro,"credentialWithLink",Oo,[Bl("email"),Bl("emailLink")]),Xl(Eo.prototype,{Ca:{name:"addScope",j:[Bl("scope")]},Ka:{name:"setCustomParameters",j:[Kl("customOAuthParameters")]}}),$l(Eo,"credential",So,[Yl(Bl(),Kl(),"token")]),Xl(Co.prototype,{Ca:{name:"addScope",j:[Bl("scope")]},Ka:{name:"setCustomParameters",j:[Kl("customOAuthParameters")]}}),$l(Co,"credential",ko,[Yl(Bl(),Yl(Kl(),Hl()),"idToken"),Yl(Bl(),Hl(),"accessToken",!0)]),Xl(No.prototype,{Ka:{name:"setCustomParameters",j:[Kl("customOAuthParameters")]}}),$l(No,"credential",Ao,[Yl(Bl(),Kl(),"token"),Bl("secret",!0)]),Xl(wo.prototype,{Ca:{name:"addScope",j:[Bl("scope")]},credential:{name:"credential",j:[Yl(Bl(),Yl(Kl(),Hl()),"optionsOrIdToken"),Yl(Bl(),Hl(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Kl("customOAuthParameters")]}}),Xl(go.prototype,{w:{name:"toJSON",j:[Bl(null,!0)]}}),Xl(fo.prototype,{w:{name:"toJSON",j:[Bl(null,!0)]}}),$l(Uo,"credential",qo,[Bl("verificationId"),Bl("verificationCode")]),Xl(Uo.prototype,{fb:{name:"verifyPhoneNumber",j:[Yl(Bl(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(t){return!!t&&(t.session&&t.phoneNumber?Jl(t.session,uo)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?Jl(t.session,co)&&Ql(t.multiFactorHint):t.session&&t.multiFactorUid?Jl(t.session,co)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]}}),Xl(Lo.prototype,{w:{name:"toJSON",j:[Bl(null,!0)]}}),Xl(k.prototype,{toJSON:{name:"toJSON",j:[Bl(null,!0)]}}),Xl(Jo.prototype,{toJSON:{name:"toJSON",j:[Bl(null,!0)]}}),Xl(zo.prototype,{toJSON:{name:"toJSON",j:[Bl(null,!0)]}}),Xl(rh.prototype,{toJSON:{name:"toJSON",j:[Bl(null,!0)]}}),Xl(th.prototype,{Rc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.sb}}]}}),Xl(ch.prototype,{Rb:{name:"getSession",j:[]},fc:{name:"enroll",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.sb}},Bl("displayName",!0)]},bd:{name:"unenroll",j:[Yl({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:Ql},Bl(),"multiFactorInfoIdentifier")]}}),Xl(ql.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),$l(Ti,"parseLink",Pi,[Bl("link")]),$l(El,"assertion",(function(t){return new sh(t)}),[zl("phone")]),function(){if(void 0===t.Z||!t.Z.INTERNAL||!t.Z.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var e={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:li,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:hi,VERIFY_AND_CHANGE_EMAIL:fi,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:il,AuthCredential:ho,Error:k};$l(e,"EmailAuthProvider",Ro,[]),$l(e,"FacebookAuthProvider",Io,[]),$l(e,"GithubAuthProvider",Eo,[]),$l(e,"GoogleAuthProvider",Co,[]),$l(e,"TwitterAuthProvider",No,[]),$l(e,"OAuthProvider",wo,[Bl("providerId")]),$l(e,"SAMLAuthProvider",_o,[Bl("providerId")]),$l(e,"PhoneAuthProvider",Uo,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof il)}}]),$l(e,"RecaptchaVerifier",ql,[Yl(Bl(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Kl("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(e){return!!(e&&e instanceof t.Z.app.App)}}]),$l(e,"ActionCodeURL",Ti,[]),$l(e,"PhoneMultiFactorGenerator",El,[]),t.Z.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new il(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:e,instantiationMode:"LAZY",type:"PUBLIC"}),t.Z.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:I((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:I(t.nc,t),addAuthTokenListener:I(t.cc,t),removeAuthTokenListener:I(t.Pc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),t.Z.registerVersion("@firebase/auth","0.16.5"),t.Z.INTERNAL.extendNamespace({User:yh})}()}).apply(void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),n(446);var e=n(589),r=n(594),i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function o(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var a,s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},u=u||{},c=s||self;function h(){}function l(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function f(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var d="closure_uid_"+(1e9*Math.random()>>>0),p=0;function v(t,e,n){return t.call.apply(t.bind,arguments)}function g(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function m(t,e,n){return(m=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?v:g).apply(null,arguments)}function y(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function b(){return Date.now()}function _(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function w(){this.j=this.j,this.i=this.i}w.prototype.j=!1,w.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&function(t){Object.prototype.hasOwnProperty.call(t,d)&&t[d]||(t[d]=++p)}(this)},w.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var I=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},T=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function E(t){return Array.prototype.concat.apply([],arguments)}function S(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function C(t){return/^[\s\xa0]*$/.test(t)}var k,N=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function A(t,e){return-1!=t.indexOf(e)}function D(t,e){return t<e?-1:t>e?1:0}t:{var P=c.navigator;if(P){var R=P.userAgent;if(R){k=R;break t}}k=""}function O(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function x(t){var e={};for(var n in t)e[n]=t[n];return e}var L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<L.length;o++)n=L[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function F(t){return F[" "](t),t}F[" "]=h;var U,q,j=A(k,"Opera"),V=A(k,"Trident")||A(k,"MSIE"),B=A(k,"Edge"),G=B||V,K=A(k,"Gecko")&&!(A(k.toLowerCase(),"webkit")&&!A(k,"Edge"))&&!(A(k,"Trident")||A(k,"MSIE"))&&!A(k,"Edge"),W=A(k.toLowerCase(),"webkit")&&!A(k,"Edge");function H(){var t=c.document;return t?t.documentMode:void 0}t:{var z="",J=(q=k,K?/rv:([^\);]+)(\)|;)/.exec(q):B?/Edge\/([\d\.]+)/.exec(q):V?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(q):W?/WebKit\/(\S+)/.exec(q):j?/(?:Version)[ \/]?(\S+)/.exec(q):void 0);if(J&&(z=J?J[1]:""),V){var Q=H();if(null!=Q&&Q>parseFloat(z)){U=String(Q);break t}}U=z}var Y,X={};function Z(t){return function(t,e){var n=X;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e()}(t,(function(){for(var e=0,n=N(String(U)).split("."),r=N(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=D(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||D(0==a[2].length,0==s[2].length)||D(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}c.document&&V?Y=H()||parseInt(U,10)||void 0:Y=void 0;var $=Y,tt=!V||9<=Number($),et=V&&!Z("9"),nt=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{c.addEventListener("test",h,e),c.removeEventListener("test",h,e)}catch(t){}return t}();function rt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function it(t,e){if(rt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(K){t:{try{F(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:ot[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}rt.prototype.b=function(){this.defaultPrevented=!0},_(it,rt);var ot={2:"touch",3:"pen",4:"mouse"};it.prototype.b=function(){it.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,et)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var at="closure_listenable_"+(1e6*Math.random()|0),st=0;function ut(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++st,this.Y=this.Z=!1}function ct(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function ht(t){this.src=t,this.a={},this.b=0}function lt(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=I(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ct(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function ft(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}ht.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=ft(t,e,r,i);return-1<a?(e=t[a],n||(e.Z=!1)):((e=new ut(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var dt="closure_lm_"+(1e6*Math.random()|0),pt={};function vt(t,e,n,r,i){if(r&&r.once)return mt(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)vt(t,e[o],n,r,i);return null}return n=St(n),t&&t[at]?t.va(e,n,f(r)?!!r.capture:!!r,i):gt(t,e,n,!1,r,i)}function gt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=f(i)?!!i.capture:!!i;if(a&&!tt)return null;var s=Tt(t);if(s||(t[dt]=s=new ht(t)),(n=s.add(e,n,r,a,o)).proxy)return n;if(r=function(){var t=It,e=tt?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)nt||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(_t(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function mt(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)mt(t,e[o],n,r,i);return null}return n=St(n),t&&t[at]?t.wa(e,n,f(r)?!!r.capture:!!r,i):gt(t,e,n,!0,r,i)}function yt(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)yt(t,e[o],n,r,i);else r=f(r)?!!r.capture:!!r,n=St(n),t&&t[at]?(t=t.c,(e=String(e).toString())in t.a&&-1<(n=ft(o=t.a[e],n,r,i))&&(ct(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=Tt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=ft(e,n,r,i)),(n=-1<t?e[t]:null)&&bt(n))}function bt(t){if("number"!=typeof t&&t&&!t.Y){var e=t.src;if(e&&e[at])lt(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(_t(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Tt(e))?(lt(n,t),0==n.b&&(n.src=null,e[dt]=null)):ct(t)}}}function _t(t){return t in pt?pt[t]:pt[t]="on"+t}function wt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&bt(t),n.call(r,e)}function It(t,e){if(t.Y)return!0;if(!tt){if(!e)t:{e=["window","event"];for(var n=c,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return wt(t,e=new it(e,this))}return wt(t,new it(e,this))}function Tt(t){return(t=t[dt])instanceof ht?t:null}var Et="__closure_events_fn_"+(1e9*Math.random()>>>0);function St(t){return"function"==typeof t?t:(t[Et]||(t[Et]=function(e){return t.handleEvent(e)}),t[Et])}function Ct(){w.call(this),this.c=new ht(this),this.J=this,this.C=null}function kt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e)e=new rt(e,t);else if(e instanceof rt)e.target=e.target||t;else{var i=e;M(e=new rt(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var a=e.a=n[o];i=Nt(a,r,!0,e)&&i}if(i=Nt(a=e.a=t,r,!0,e)&&i,i=Nt(a,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Nt(a=e.a=n[o],r,!1,e)&&i}function Nt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.Y&&a.capture==n){var s=a.listener,u=a.ca||a.src;a.Z&&lt(t.c,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}_(Ct,w),Ct.prototype[at]=!0,(a=Ct.prototype).addEventListener=function(t,e,n,r){vt(this,t,e,n,r)},a.removeEventListener=function(t,e,n,r){yt(this,t,e,n,r)},a.G=function(){if(Ct.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)ct(n[r]);delete e.a[t],e.b--}}this.C=null},a.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},a.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var At=c.JSON.stringify;function Dt(){this.b=this.a=null}var Pt,Rt=new(function(){function t(t,e){this.c=t,this.f=e,this.b=0,this.a=null}return t.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},t}())((function(){return new xt}),(function(t){t.reset()}));function Ot(){var t=Ut,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function xt(){this.next=this.b=this.a=null}function Lt(t){c.setTimeout((function(){throw t}),0)}function Mt(t,e){Pt||function(){var t=c.Promise.resolve(void 0);Pt=function(){t.then(qt)}}(),Ft||(Pt(),Ft=!0),Ut.add(t,e)}Dt.prototype.add=function(t,e){var n=Rt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},xt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},xt.prototype.reset=function(){this.next=this.b=this.a=null};var Ft=!1,Ut=new Dt;function qt(){for(var t;t=Ot();){try{t.a.call(t.b)}catch(t){Lt(t)}var e=Rt;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Ft=!1}function jt(t,e){Ct.call(this),this.b=t||1,this.a=e||c,this.f=m(this.Za,this),this.g=b()}function Vt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Bt(t,e,n){if("function"==typeof t)n&&(t=m(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=m(t.handleEvent,t)}return 2147483647<Number(e)?-1:c.setTimeout(t,e||0)}function Gt(t){t.a=Bt((function(){t.a=null,t.c&&(t.c=!1,Gt(t))}),t.h);var e=t.b;t.b=null,t.g.apply(null,e)}_(jt,Ct),(a=jt.prototype).aa=!1,a.M=null,a.Za=function(){if(this.aa){var t=b()-this.g;0<t&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),kt(this,"tick"),this.aa&&(Vt(this),this.start()))}},a.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=b())},a.G=function(){jt.X.G.call(this),Vt(this),delete this.a};var Kt=function(t){function e(e,n){var r=t.call(this)||this;return r.g=e,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:Gt(this)},e.prototype.G=function(){t.prototype.G.call(this),this.a&&(c.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},e}(w);function Wt(t){w.call(this),this.b=t,this.a={}}_(Wt,w);var Ht=[];function zt(t,e,n,r){Array.isArray(n)||(n&&(Ht[0]=n.toString()),n=Ht);for(var i=0;i<n.length;i++){var o=vt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Jt(t){O(t.a,(function(t,e){this.a.hasOwnProperty(e)&&bt(t)}),t),t.a={}}function Qt(){this.a=!0}function Yt(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var a=1;a<i.length;a++)i[a]=""}}}return At(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}Wt.prototype.G=function(){Wt.X.G.call(this),Jt(this)},Wt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Qt.prototype.info=function(){};var Xt={},Zt=null;function $t(){return Zt=Zt||new Ct}function te(t){rt.call(this,Xt.Fa,t)}function ee(t){var e=$t();kt(e,new te(e,t))}function ne(t,e){rt.call(this,Xt.STAT_EVENT,t),this.stat=e}function re(t){var e=$t();kt(e,new ne(e,t))}function ie(t){rt.call(this,Xt.Ga,t)}function oe(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return c.setTimeout((function(){t()}),e)}Xt.Fa="serverreachability",_(te,rt),Xt.STAT_EVENT="statevent",_(ne,rt),Xt.Ga="timingevent",_(ie,rt);var ae={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},se={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function ue(){}function ce(t){var e;return(e=t.a)||(e=t.a={}),e}function he(){}ue.prototype.a=null;var le,fe={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function de(){rt.call(this,"d")}function pe(){rt.call(this,"c")}function ve(){}function ge(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new Wt(this),this.P=me,t=G?125:void 0,this.R=new jt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}_(de,rt),_(pe,rt),_(ve,ue),le=new ve;var me=45e3,ye={},be={};function _e(t,e,n){t.H=1,t.i=Be(Me(e)),t.j=n,t.I=!0,we(t,null)}function we(t,e){t.u=b(),Ee(t),t.l=Me(t.i);var n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),en(n.b,"t",r),t.D=0,t.a=Yn(t.g,t.g.C?e:null),0<t.O&&(t.F=new Kt(m(t.Ca,t,t.a),t.O)),zt(t.J,t.a,"readystatechange",t.Xa),e=t.B?x(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ee(1),function(t,e,n,r,i,o){t.info((function(){if(t.a)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var h=c[0];c=c[1];var l=h.split("_");a=2<=l.length&&"type"==l[1]?a+(h+"=")+c+"&":a+(h+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+a}))}(t.c,t.m,t.l,t.f,t.S,t.j)}function Ie(t,e,n){for(var r=!0;!t.A&&t.D<n.length;){var i=Te(t,n);if(i==be){4==e&&(t.h=4,re(14),r=!1),Yt(t.c,t.f,null,"[Incomplete Response]");break}if(i==ye){t.h=4,re(15),Yt(t.c,t.f,n,"[Invalid Chunk]"),r=!1;break}Yt(t.c,t.f,i,null),Ae(t,i)}4==e&&0==n.length&&(t.h=1,re(16),r=!1),t.b=t.b&&r,r?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Bn(e),e.F=!0,re(11))):(Yt(t.c,t.f,n,"[Invalid Chunked Response]"),Ne(t),ke(t))}function Te(t,e){var n=t.D,r=e.indexOf("\n",n);return-1==r?be:(n=Number(e.substring(n,r)),isNaN(n)?ye:(r+=1)+n>e.length?be:(e=e.substr(r,n),t.D=r+n,e))}function Ee(t){t.T=b()+t.P,Se(t,t.P)}function Se(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=oe(m(t.Va,t),e)}function Ce(t){t.o&&(c.clearTimeout(t.o),t.o=null)}function ke(t){0==t.g.v||t.A||Wn(t.g,t)}function Ne(t){Ce(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Vt(t.R),Jt(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ae(t,e){try{var n=t.g;if(0!=n.v&&(n.a==t||cn(n.b,t)))if(n.I=t.N,!t.C&&cn(n.b,t)&&3==n.v){try{var r=n.ka.a.parse(e)}catch(t){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.j){if(n.a){if(!(n.a.u+3e3<t.u))break t;Kn(n),On(n)}Vn(n),re(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=oe(m(n.Sa,n),6e3));if(1>=un(n.b)&&n.ea){try{n.ea()}catch(t){}n.ea=void 0}}else zn(n,11)}else if((t.C||n.a==t)&&Kn(n),!C(e))for(e=r=n.ka.a.parse(e),r=0;r<e.length;r++)if(i=e[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var a=i[4];null!=a&&(n.pa=a,n.c.info("SVER="+n.pa));var s=i[5];if(null!=s&&"number"==typeof s&&0<s){var u=1.5*s;n.D=u,n.c.info("backChannelRequestTimeoutMs_="+u)}u=n;var c=t.a;if(c){var h=c.a?c.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(h){var l=u.b;!l.a&&(A(h,"spdy")||A(h,"quic")||A(h,"h2"))&&(l.f=l.g,l.a=new Set,l.b&&(hn(l,l.b),l.b=null))}if(u.A){var f=c.a?c.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(u.na=f,Ve(u.B,u.A,f))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=b()-t.u,n.c.info("Handshake RTT: "+n.N+"ms"));var d=t;if((u=n).la=Qn(u,u.C?u.ga:null,u.fa),d.C){ln(u.b,d);var p=d,v=u.D;v&&p.setTimeout(v),p.o&&(Ce(p),Ee(p)),u.a=d}else jn(u);0<n.g.length&&Mn(n)}else"stop"!=i[0]&&"close"!=i[0]||zn(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?zn(n,7):Rn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);ee(4)}catch(t){}}function De(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(l(t)||"string"==typeof t)T(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(l(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(l(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Pe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Pe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Re(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Oe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Oe(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Oe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(a=ge.prototype).setTimeout=function(t){this.P=t},a.Xa=function(t){t=t.target;var e=this.F;e&&3==Nn(t)?e.f():this.Ca(t)},a.Ca=function(t){try{if(t==this.a)t:{var e=Nn(this.a),n=this.a.ua(),r=this.a.W();if(!(3>e||3==e&&!G&&!this.a.$())){this.A||4!=e||7==n||ee(8==n||0>=r?3:2),Ce(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(t,e,n,r,i,o,a){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+a}))}(this.c,this.m,this.l,this.f,this.S,e,i),this.b){if(this.U&&!this.C){e:{if(this.a){var a,s=this.a;if((a=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!C(a)){var u=a;break e}}u=null}if(!u){this.b=!1,this.h=3,re(12),Ne(this),ke(this);break t}Yt(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ae(this,u)}this.I?(Ie(this,e,o),G&&this.b&&3==e&&(zt(this.J,this.R,"tick",this.Wa),this.R.start())):(Yt(this.c,this.f,o,null),Ae(this,o)),4==e&&Ne(this),this.b&&!this.A&&(4==e?Wn(this.g,this):(this.b=!1,Ee(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,re(12)):(this.h=0,re(13)),Ne(this),ke(this)}}}catch(t){}},a.Wa=function(){if(this.a){var t=Nn(this.a),e=this.a.$();this.D<e.length&&(Ce(this),Ie(this,t,e),this.b&&4!=t&&Ee(this))}},a.cancel=function(){this.A=!0,Ne(this)},a.Va=function(){this.o=null;var t=b();0<=t-this.T?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.c,this.l),2!=this.H&&(ee(3),re(17)),Ne(this),this.h=2,ke(this)):Se(this,this.T-t)},(a=Pe.prototype).K=function(){Re(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},a.L=function(){return Re(this),this.a.concat()},a.get=function(t,e){return Oe(this.b,t)?this.b[t]:e},a.set=function(t,e){Oe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},a.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var xe=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Le(t,e){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Le){this.a=void 0!==e?e:t.a,Fe(this,t.f),this.j=t.j,Ue(this,t.c),qe(this,t.h),this.g=t.g,e=t.b;var n=new Xe;n.c=e.c,e.a&&(n.a=new Pe(e.a),n.b=e.b),je(this,n),this.i=t.i}else t&&(n=String(t).match(xe))?(this.a=!!e,Fe(this,n[1]||"",!0),this.j=Ge(n[2]||""),Ue(this,n[3]||"",!0),qe(this,n[4]),this.g=Ge(n[5]||"",!0),je(this,n[6]||"",!0),this.i=Ge(n[7]||"")):(this.a=!!e,this.b=new Xe(null,this.a))}function Me(t){return new Le(t)}function Fe(t,e,n){t.f=n?Ge(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ue(t,e,n){t.c=n?Ge(e,!0):e}function qe(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.h=e}else t.h=null}function je(t,e,n){e instanceof Xe?(t.b=e,function(t,e){e&&!t.f&&(Ze(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&($e(this,e),en(this,n,t))}),t)),t.f=e}(t.b,t.a)):(n||(e=Ke(e,Qe)),t.b=new Xe(e,t.a))}function Ve(t,e,n){t.b.set(e,n)}function Be(t){return Ve(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^b()).toString(36)),t}function Ge(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ke(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,We),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function We(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Le.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Ke(e,He,!0),":");var n=this.c;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(Ke(e,He,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ke(n,"/"==n.charAt(0)?Je:ze,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",Ke(n,Ye)),t.join("")};var He=/[#\/\?@]/g,ze=/[#\?:]/g,Je=/[#\?]/g,Qe=/[#\?@]/g,Ye=/#/g;function Xe(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Ze(t){t.a||(t.a=new Pe,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function $e(t,e){Ze(t),e=nn(t,e),Oe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Oe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Re(t)))}function tn(t,e){return Ze(t),e=nn(t,e),Oe(t.a.b,e)}function en(t,e,n){$e(t,e),0<n.length&&(t.c=null,t.a.set(nn(t,e),S(n)),t.b+=n.length)}function nn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(a=Xe.prototype).add=function(t,e){Ze(this),this.c=null,t=nn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},a.forEach=function(t,e){Ze(this),this.a.forEach((function(n,r){T(n,(function(n){t.call(e,n,r,this)}),this)}),this)},a.L=function(){Ze(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},a.K=function(t){Ze(this);var e=[];if("string"==typeof t)tn(this,t)&&(e=E(e,this.a.get(nn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=E(e,t[n])}return e},a.set=function(t,e){return Ze(this),this.c=null,tn(this,t=nn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},a.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},a.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var rn=function(t,e){this.b=t,this.a=e};function on(t){this.g=t||an,t=c.PerformanceNavigationTiming?0<(t=c.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(c.ia&&c.ia.ya&&c.ia.ya()&&c.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var an=10;function sn(t){return!!t.b||!!t.a&&t.a.size>=t.f}function un(t){return t.b?1:t.a?t.a.size:0}function cn(t,e){return t.b?t.b==e:!!t.a&&t.a.has(e)}function hn(t,e){t.a?t.a.add(e):t.b=e}function ln(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function fn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null!=t.a&&0!==t.a.size){var r=t.c;try{for(var i=o(t.a.values()),a=i.next();!a.done;a=i.next()){var s=a.value;r=r.concat(s.s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return S(t.c)}function dn(){}function pn(){this.a=new dn}function vn(t,e,n){var r=n||"";try{De(t,(function(t,n){var i=t;f(t)&&(i=At(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function gn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}on.prototype.cancel=function(){var t,e;if(this.c=fn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=o(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},dn.prototype.stringify=function(t){return c.JSON.stringify(t,void 0)},dn.prototype.parse=function(t){return c.JSON.parse(t,void 0)};var mn=c.JSON.parse;function yn(t){Ct.call(this),this.headers=new Pe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=bn,this.D=this.F=!1}_(yn,Ct);var bn="",_n=/^https?$/i,wn=["POST","PUT"];function In(t){return"content-type"==t.toLowerCase()}function Tn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,En(t),Cn(t)}function En(t){t.u||(t.u=!0,kt(t,"complete"),kt(t,"error"))}function Sn(t){if(t.b&&void 0!==u&&(!t.s[1]||4!=Nn(t)||2!=t.W()))if(t.l&&4==Nn(t))Bt(t.za,0,t);else if(kt(t,"readystatechange"),4==Nn(t)){t.b=!1;try{var e,n=t.W();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.B).match(xe)[1]||null;if(!o&&c.self&&c.self.location){var a=c.self.location.protocol;o=a.substr(0,a.length-1)}i=!_n.test(o?o.toLowerCase():"")}e=i}if(e)kt(t,"complete"),kt(t,"success");else{t.h=6;try{var s=2<Nn(t)?t.a.statusText:""}catch(n){s=""}t.f=s+" ["+t.W()+"]",En(t)}}finally{Cn(t)}}}function Cn(t,e){if(t.a){kn(t);var n=t.a,r=t.s[0]?h:null;t.a=null,t.s=null,e||kt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function kn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(c.clearTimeout(t.m),t.m=null)}function Nn(t){return t.a?t.a.readyState:0}function An(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return O(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ve(t,e,n))}function Dn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Pn(t){this.pa=0,this.g=[],this.c=new Qt,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Dn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Dn("baseRetryDelayMs",5e3,t),this.Ra=Dn("retryDelaySeedMs",1e4,t),this.Ma=Dn("forwardChannelMaxRetries",2,t),this.ma=Dn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new on(t&&t.concurrentRequestLimit),this.ka=new pn,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Rn(t){if(xn(t),3==t.v){var e=t.R++,n=Me(t.B);Ve(n,"SID",t.J),Ve(n,"RID",e),Ve(n,"TYPE","terminate"),Un(t,n),(e=new ge(t,t.c,e,void 0)).H=2,e.i=Be(Me(n)),n=!1,c.navigator&&c.navigator.sendBeacon&&(n=c.navigator.sendBeacon(e.i.toString(),"")),!n&&c.Image&&((new Image).src=e.i,n=!0),n||(e.a=Yn(e.g,null),e.a.ba(e.i)),e.u=b(),Ee(e)}Jn(t)}function On(t){t.a&&(Bn(t),t.a.cancel(),t.a=null)}function xn(t){On(t),t.j&&(c.clearTimeout(t.j),t.j=null),Kn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&c.clearTimeout(t.h),t.h=null)}function Ln(t,e){t.g.push(new rn(t.Oa++,e)),3==t.v&&Mn(t)}function Mn(t){sn(t.b)||t.h||(t.h=!0,Mt(t.Ba,t),t.u=0)}function Fn(t,e){var n;n=e?e.f:t.R++;var r=Me(t.B);Ve(r,"SID",t.J),Ve(r,"RID",n),Ve(r,"AID",t.P),Un(t,r),t.i&&t.l&&An(r,t.i,t.l),n=new ge(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=qn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),hn(t.b,n),_e(n,r,e)}function Un(t,e){t.f&&De({},(function(t,n){Ve(e,n,t)}))}function qn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?m(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if(0>(c-=o))o=Math.max(0,i[u].b-100),s=!1;else try{vn(h,a,"req"+c+"_")}catch(t){r&&r(h)}}if(s){r=a.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function jn(t){t.a||t.j||(t.T=1,Mt(t.Aa,t),t.o=0)}function Vn(t){return!(t.a||t.j||3<=t.o||(t.T++,t.j=oe(m(t.Aa,t),Hn(t,t.o)),t.o++,0))}function Bn(t){null!=t.s&&(c.clearTimeout(t.s),t.s=null)}function Gn(t){t.a=new ge(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Me(t.la);Ve(e,"RID","rpc"),Ve(e,"SID",t.J),Ve(e,"CI",t.H?"0":"1"),Ve(e,"AID",t.P),Un(t,e),Ve(e,"TYPE","xmlhttp"),t.i&&t.l&&An(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Be(Me(e)),n.j=null,n.I=!0,we(n,t)}function Kn(t){null!=t.m&&(c.clearTimeout(t.m),t.m=null)}function Wn(t,e){var n=null;if(t.a==e){Kn(t),Bn(t),t.a=null;var r=2}else{if(!cn(t.b,e))return;n=e.s,ln(t.b,e),r=1}if(t.I=e.N,0!=t.v)if(e.b)if(1==r){n=e.j?e.j.length:0,e=b()-e.u;var i=t.u;kt(r=$t(),new ie(r,n,e,i)),Mn(t)}else jn(t);else if(3==(i=e.h)||0==i&&0<t.I||!(1==r&&function(t,e){return!(un(t.b)>=t.b.f-(t.h?1:0)||(t.h?(t.g=e.s.concat(t.g),0):1==t.v||2==t.v||t.u>=(t.La?0:t.Ma)||(t.h=oe(m(t.Ba,t,e),Hn(t,t.u)),t.u++,0)))}(t,e)||2==r&&Vn(t)))switch(n&&0<n.length&&(e=t.b,e.c=e.c.concat(n)),i){case 1:zn(t,5);break;case 4:zn(t,10);break;case 3:zn(t,6);break;default:zn(t,2)}}function Hn(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function zn(t,e){if(t.c.info("Error code "+e),2==e){var n=null;t.f&&(n=null);var r=m(t.Ya,t);n||(n=new Le("//www.google.com/images/cleardot.gif"),c.location&&"http"==c.location.protocol||Fe(n,"https"),Be(n)),function(t,e){var n=new Qt;if(c.Image){var r=new Image;r.onload=y(gn,n,r,"TestLoadImage: loaded",!0,e),r.onerror=y(gn,n,r,"TestLoadImage: error",!1,e),r.onabort=y(gn,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=y(gn,n,r,"TestLoadImage: timeout",!1,e),c.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else re(2);t.v=0,t.f&&t.f.ra(e),Jn(t),xn(t)}function Jn(t){t.v=0,t.I=-1,t.f&&(0==fn(t.b).length&&0==t.g.length||(t.b.c.length=0,S(t.g),t.g.length=0),t.f.qa())}function Qn(t,e,n){var r=function(t){return t instanceof Le?Me(t):new Le(t,void 0)}(n);if(""!=r.c)e&&Ue(r,e+"."+r.c),qe(r,r.h);else{var i=c.location;r=function(t,e,n,r){var i=new Le(null,void 0);return t&&Fe(i,t),e&&Ue(i,e),n&&qe(i,n),r&&(i.g=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.V&&O(t.V,(function(t,e){Ve(r,e,t)})),e=t.A,n=t.na,e&&n&&Ve(r,e,n),Ve(r,"VER",t.ha),Un(t,r),r}function Yn(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new yn(t.Na)).F=t.C,e}function Xn(){}function Zn(){if(V&&!(10<=Number($)))throw Error("Environmental error: no available transport.")}function $n(t,e){Ct.call(this),this.a=new Pn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!C(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!C(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new nr(this)}function tr(t){de.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function er(){pe.call(this),this.status=1}function nr(t){this.a=t}(a=yn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?ce(this.H):ce(le),this.a.onreadystatechange=m(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Tn(this,t)}t=n||"";var i=new Pe(this.headers);r&&De(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=In,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.L()),n=c.FormData&&t instanceof c.FormData,!(0<=I(wn,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.a.setRequestHeader(e,t)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{kn(this),0<this.o&&((this.D=function(t){return V&&Z(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=m(this.xa,this)):this.m=Bt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Tn(this,t)}},a.xa=function(){void 0!==u&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,kt(this,"timeout"),this.abort(8))},a.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,kt(this,"complete"),kt(this,"abort"),Cn(this))},a.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Cn(this,!0)),yn.X.G.call(this)},a.za=function(){this.j||(this.A||this.l||this.g?Sn(this):this.Ua())},a.Ua=function(){Sn(this)},a.W=function(){try{return 2<Nn(this)?this.a.status:-1}catch(t){return-1}},a.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},a.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),mn(e)}},a.ua=function(){return this.h},a.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(a=Pn.prototype).ha=8,a.v=1,a.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new ge(this,this.c,t,void 0),r=this.l;if(this.O&&(r?M(r=x(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=qn(this,n,e),Ve(i=Me(this.B),"RID",t),Ve(i,"CVER",22),this.A&&Ve(i,"X-HTTP-Session-Id",this.A),Un(this,i),this.i&&r&&An(i,this.i,r),hn(this.b,n),this.Ia&&Ve(i,"TYPE","init"),this.da?(Ve(i,"$req",e),Ve(i,"SID","null"),n.U=!0,_e(n,i,null)):_e(n,i,e),this.v=2}}else 3==this.v&&(t?Fn(this,t):0==this.g.length||sn(this.b)||Fn(this))},a.Aa=function(){if(this.j=null,Gn(this),this.U&&!(this.F||null==this.a||0>=this.N)){var t=2*this.N;this.c.info("BP detection timer enabled: "+t),this.s=oe(m(this.Ta,this),t)}},a.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,re(10),On(this),Gn(this))},a.Sa=function(){null!=this.m&&(this.m=null,On(this),Vn(this),re(19))},a.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),re(2)):(this.c.info("Failed to ping google.com"),re(1))},(a=Xn.prototype).ta=function(){},a.sa=function(){},a.ra=function(){},a.qa=function(){},a.Ja=function(){},Zn.prototype.a=function(t,e){return new $n(t,e)},_($n,Ct),$n.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;re(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=Qn(t,null,t.fa),Mn(t)},$n.prototype.close=function(){Rn(this.a)},$n.prototype.h=function(t){if("string"==typeof t){var e={};e.__data__=t,Ln(this.a,e)}else this.l?((e={}).__data__=At(t),Ln(this.a,e)):Ln(this.a,t)},$n.prototype.G=function(){this.a.f=null,delete this.f,Rn(this.a),delete this.a,$n.X.G.call(this)},_(tr,de),_(er,pe),_(nr,Xn),nr.prototype.ta=function(){kt(this.a,"a")},nr.prototype.sa=function(t){kt(this.a,new tr(t))},nr.prototype.ra=function(t){kt(this.a,new er(t))},nr.prototype.qa=function(){kt(this.a,"b")},Zn.prototype.createWebChannel=Zn.prototype.a,$n.prototype.send=$n.prototype.h,$n.prototype.open=$n.prototype.g,$n.prototype.close=$n.prototype.close,ae.NO_ERROR=0,ae.TIMEOUT=8,ae.HTTP_ERROR=6,se.COMPLETE="complete",he.EventType=fe,fe.OPEN="a",fe.CLOSE="b",fe.ERROR="c",fe.MESSAGE="d",Ct.prototype.listen=Ct.prototype.va,yn.prototype.listenOnce=yn.prototype.wa,yn.prototype.getLastError=yn.prototype.Qa,yn.prototype.getLastErrorCode=yn.prototype.ua,yn.prototype.getStatus=yn.prototype.W,yn.prototype.getResponseJson=yn.prototype.Pa,yn.prototype.getResponseText=yn.prototype.$,yn.prototype.send=yn.prototype.ba;var rr=ae,ir=se,or=Xt,ar=10,sr=11,ur=he,cr=yn,hr=n(655),lr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();lr.o=-1;var fr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},dr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return(0,hr.ZT)(e,t),e}(Error),pr=new r.Yd("@firebase/firestore");function vr(){return pr.logLevel}function gr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(pr.logLevel<=r.in.DEBUG){var i=e.map(br);pr.debug.apply(pr,(0,hr.ev)(["Firestore (8.4.2): "+t],i))}}function mr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(pr.logLevel<=r.in.ERROR){var i=e.map(br);pr.error.apply(pr,(0,hr.ev)(["Firestore (8.4.2): "+t],i))}}function yr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(pr.logLevel<=r.in.WARN){var i=e.map(br);pr.warn.apply(pr,(0,hr.ev)(["Firestore (8.4.2): "+t],i))}}function br(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function _r(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.4.2) INTERNAL ASSERTION FAILED: "+t;throw mr(e),new Error(e)}function wr(t,e){t||_r()}function Ir(t,e){return t}function Tr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Er=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=Tr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Sr(t,e){return t<e?-1:t>e?1:0}function Cr(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function kr(t){return t+"\0"}var Nr=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new dr(fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new dr(fr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new dr(fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new dr(fr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Sr(this.nanoseconds,t.nanoseconds):Sr(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Ar=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new Nr(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function Dr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Pr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Rr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Or=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&_r(),void 0===n?n=t.length-e:n>t.length-e&&_r(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),xr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,hr.ZT)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var a=o[i];if(a.indexOf("//")>=0)throw new dr(fr.INVALID_ARGUMENT,"Invalid segment ("+a+"). Paths must not contain // in them.");r.push.apply(r,a.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(Or),Lr=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Mr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,hr.ZT)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return Lr.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new dr(fr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new dr(fr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new dr(fr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new dr(fr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(Or),Fr=function(){function t(t){this.fields=t,t.sort(Mr.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return Cr(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),Ur=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return Sr(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();Ur.EMPTY_BYTE_STRING=new Ur("");var qr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function jr(t){if(wr(!!t),"string"==typeof t){var e=0,n=qr.exec(t);if(wr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Vr(t.seconds),nanos:Vr(t.nanos)}}function Vr(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Br(t){return"string"==typeof t?Ur.fromBase64String(t):Ur.fromUint8Array(t)}function Gr(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Kr(t){var e=t.mapValue.fields.__previous_value__;return Gr(e)?Kr(e):e}function Wr(t){var e=jr(t.mapValue.fields.__local_write_time__.timestampValue);return new Nr(e.seconds,e.nanos)}function Hr(t){return null==t}function zr(t){return 0===t&&1/t==-1/0}function Jr(t){return"number"==typeof t&&Number.isInteger(t)&&!zr(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Qr=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(xr.fromString(e))},t.fromName=function(e){return new t(xr.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===xr.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return xr.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new xr(e.slice()))},t}();function Yr(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Gr(t)?4:10:_r()}function Xr(t,e){var n=Yr(t);if(n!==Yr(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Wr(t).isEqual(Wr(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=jr(t.timestampValue),r=jr(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return Br(t.bytesValue).isEqual(Br(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return Vr(t.geoPointValue.latitude)===Vr(e.geoPointValue.latitude)&&Vr(t.geoPointValue.longitude)===Vr(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return Vr(t.integerValue)===Vr(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=Vr(t.doubleValue),r=Vr(e.doubleValue);return n===r?zr(n)===zr(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Cr(t.arrayValue.values||[],e.arrayValue.values||[],Xr);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Dr(n)!==Dr(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Xr(n[i],r[i])))return!1;return!0}(t,e);default:return _r()}}function Zr(t,e){return void 0!==(t.values||[]).find((function(t){return Xr(t,e)}))}function $r(t,e){var n=Yr(t),r=Yr(e);if(n!==r)return Sr(n,r);switch(n){case 0:return 0;case 1:return Sr(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=Vr(t.integerValue||t.doubleValue),r=Vr(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return ti(t.timestampValue,e.timestampValue);case 4:return ti(Wr(t),Wr(e));case 5:return Sr(t.stringValue,e.stringValue);case 6:return function(t,e){var n=Br(t),r=Br(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Sr(n[i],r[i]);if(0!==o)return o}return Sr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Sr(Vr(t.latitude),Vr(e.latitude));return 0!==n?n:Sr(Vr(t.longitude),Vr(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=$r(n[i],r[i]);if(o)return o}return Sr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var s=Sr(r[a],o[a]);if(0!==s)return s;var u=$r(n[r[a]],i[o[a]]);if(0!==u)return u}return Sr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw _r()}}function ti(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Sr(t,e);var n=jr(t),r=jr(e),i=Sr(n.seconds,r.seconds);return 0!==i?i:Sr(n.nanos,r.nanos)}function ei(t){return ni(t)}function ni(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=jr(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Br(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,Qr.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=ni(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+ni(t.fields[o])}return e+"}"}(t.mapValue):_r();var e,n}function ri(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function ii(t){return!!t&&"integerValue"in t}function oi(t){return!!t&&"arrayValue"in t}function ai(t){return!!t&&"nullValue"in t}function si(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ui(t){return!!t&&"mapValue"in t}var ci=function(){function t(t){this.overlayMap=new Map,this.partialValue=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(e){return t.extractNestedValue(this.buildProto(),e)},t.prototype.toProto=function(){return this.field(Mr.emptyPath())},t.prototype.set=function(t,e){this.setOverlay(t,e)},t.prototype.setAll=function(t){var e=this;t.forEach((function(t,n){t?e.set(n,t):e.delete(n)}))},t.prototype.delete=function(t){this.setOverlay(t,null)},t.prototype.isEqual=function(t){return Xr(this.buildProto(),t.buildProto())},t.prototype.setOverlay=function(t,e){for(var n=this.overlayMap,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===Yr(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(t.lastSegment(),e)},t.prototype.applyOverlay=function(e,n){var r=this,i=!1,o=t.extractNestedValue(this.partialValue,e),a=ui(o)?Object.assign({},o.mapValue.fields):{};return n.forEach((function(t,n){if(t instanceof Map){var o=r.applyOverlay(e.child(n),t);null!=o&&(a[n]=o,i=!0)}else null!==t?(a[n]=t,i=!0):a.hasOwnProperty(n)&&(delete a[n],i=!0)})),i?{mapValue:{fields:a}}:null},t.prototype.buildProto=function(){var t=this.applyOverlay(Mr.emptyPath(),this.overlayMap);return null!=t&&(this.partialValue=t,this.overlayMap.clear()),this.partialValue},t.extractNestedValue=function(t,e){if(e.isEmpty())return t;for(var n=t,r=0;r<e.length-1;++r){if(!n.mapValue.fields)return null;if(!ui(n=n.mapValue.fields[e.get(r)]))return null}return(n=(n.mapValue.fields||{})[e.lastSegment()])||null},t.prototype.clone=function(){return new t(this.buildProto())},t}();function hi(t){var e=[];return Pr(t.fields||{},(function(t,n){var r=new Mr([t]);if(ui(n)){var i=hi(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,a=i;o<a.length;o++){var s=a[o];e.push(r.child(s))}}else e.push(r)})),new Fr(e)}var li=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,Ar.min(),ci.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,ci.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,ci.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=ci.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=ci.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.toProto())+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),fi=function(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.h=null};function di(t,e,n,r,i,o,a){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),new fi(t,e,n,r,i,o,a)}function pi(t){var e=Ir(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+ei(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),Hr(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=ki(e.startAt)),e.endAt&&(n+="|ub:",n+=ki(e.endAt)),e.h=n}return e.h}function vi(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Ai(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!Xr(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Pi(t.startAt,e.startAt)&&Pi(t.endAt,e.endAt)}function gi(t){return Qr.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var mi=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return(0,hr.ZT)(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new yi(t,n,r):"array-contains"===n?new Ii(t,r):"in"===n?new Ti(t,r):"not-in"===n?new Ei(t,r):"array-contains-any"===n?new Si(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new bi(t,n):new _i(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m($r(e,this.value)):null!==e&&Yr(this.value)===Yr(e)&&this.m($r(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return _r()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),yi=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=Qr.fromName(r.referenceValue),i}return(0,hr.ZT)(e,t),e.prototype.matches=function(t){var e=Qr.comparator(t.key,this.key);return this.m(e)},e}(mi),bi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=wi(0,n),r}return(0,hr.ZT)(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(mi),_i=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=wi(0,n),r}return(0,hr.ZT)(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(mi);function wi(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return Qr.fromName(t.referenceValue)}))}var Ii=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return(0,hr.ZT)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return oi(e)&&Zr(e.arrayValue,this.value)},e}(mi),Ti=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return(0,hr.ZT)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&Zr(this.value.arrayValue,e)},e}(mi),Ei=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return(0,hr.ZT)(e,t),e.prototype.matches=function(t){if(Zr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!Zr(this.value.arrayValue,e)},e}(mi),Si=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return(0,hr.ZT)(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!oi(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return Zr(e.value.arrayValue,t)}))},e}(mi),Ci=function(t,e){this.position=t,this.before=e};function ki(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return ei(t)})).join(",")}var Ni=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ai(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function Di(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],a=t.position[i];if(r=o.field.isKeyField()?Qr.comparator(Qr.fromName(a.referenceValue),n.key):$r(a,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Pi(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Xr(t.position[n],e.position[n]))return!1;return!0}var Ri=function(t,e,n,r,i,o,a,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===a&&(a=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.p=null,this.T=null,this.startAt,this.endAt};function Oi(t,e,n,r,i,o,a,s){return new Ri(t,e,n,r,i,o,a,s)}function xi(t){return new Ri(t)}function Li(t){return!Hr(t.limit)&&"F"===t.limitType}function Mi(t){return!Hr(t.limit)&&"L"===t.limitType}function Fi(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Ui(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function qi(t){return null!==t.collectionGroup}function ji(t){var e=Ir(t);if(null===e.p){e.p=[];var n=Ui(e),r=Fi(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new Ni(n)),e.p.push(new Ni(Mr.keyField(),"asc"));else{for(var i=!1,o=0,a=e.explicitOrderBy;o<a.length;o++){var s=a[o];e.p.push(s),s.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new Ni(Mr.keyField(),u))}}}return e.p}function Vi(t){var e=Ir(t);if(!e.T)if("F"===e.limitType)e.T=di(e.path,e.collectionGroup,ji(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ji(e);r<i.length;r++){var o=i[r],a="desc"===o.dir?"asc":"desc";n.push(new Ni(o.field,a))}var s=e.endAt?new Ci(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Ci(e.startAt.position,!e.startAt.before):null;e.T=di(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.T}function Bi(t,e,n){return new Ri(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Gi(t,e){return vi(Vi(t),Vi(e))&&t.limitType===e.limitType}function Ki(t){return pi(Vi(t))+"|lt:"+t.limitType}function Wi(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+ei(e.value);var e})).join(", ")+"]"),Hr(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+ki(t.startAt)),t.endAt&&(e+=", endAt: "+ki(t.endAt)),"Target("+e+")"}(Vi(t))+"; limitType="+t.limitType+")"}function Hi(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):Qr.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!Di(t.startAt,ji(t),e)||t.endAt&&Di(t.endAt,ji(t),e))}(t,e)}function zi(t){return function(e,n){for(var r=!1,i=0,o=ji(t);i<o.length;i++){var a=o[i],s=Ji(a,e,n);if(0!==s)return s;r=r||a.field.isKeyField()}return 0}}function Ji(t,e,n){var r=t.field.isKeyField()?Qr.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?$r(r,i):_r()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return _r()}}function Qi(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zr(e)?"-0":e}}function Yi(t){return{integerValue:""+t}}function Xi(t,e){return Jr(e)?Yi(e):Qi(t,e)}var Zi=function(){this._=void 0};function $i(t,e,n){return t instanceof no?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof ro?io(t,e):t instanceof oo?ao(t,e):function(t,e){var n=eo(t,e),r=uo(n)+uo(t.A);return ii(n)&&ii(t.A)?Yi(r):Qi(t.R,r)}(t,e)}function to(t,e,n){return t instanceof ro?io(t,e):t instanceof oo?ao(t,e):n}function eo(t,e){return t instanceof so?ii(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var no=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,hr.ZT)(e,t),e}(Zi),ro=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,hr.ZT)(e,t),e}(Zi);function io(t,e){for(var n=co(e),r=function(t){n.some((function(e){return Xr(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var oo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,hr.ZT)(e,t),e}(Zi);function ao(t,e){for(var n=co(e),r=function(t){n=n.filter((function(e){return!Xr(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var so=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return(0,hr.ZT)(e,t),e}(Zi);function uo(t){return Vr(t.integerValue||t.doubleValue)}function co(t){return oi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var ho=function(t,e){this.field=t,this.transform=e},lo=function(t,e){this.version=t,this.transformResults=e},fo=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function po(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var vo=function(){};function go(t,e,n){t instanceof wo?function(t,e,n){var r=t.value.clone(),i=Eo(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof Io?function(t,e,n){if(po(t.precondition,e)){var r=Eo(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(To(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function mo(t,e,n){t instanceof wo?function(t,e,n){if(po(t.precondition,e)){var r=t.value.clone(),i=So(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(_o(e),r).setHasLocalMutations()}}(t,e,n):t instanceof Io?function(t,e,n){if(po(t.precondition,e)){var r=So(t.fieldTransforms,n,e),i=e.data;i.setAll(To(t)),i.setAll(r),e.convertToFoundDocument(_o(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){po(t.precondition,e)&&e.convertToNoDocument(Ar.min())}(t,e)}function yo(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],a=e.data.field(o.field),s=eo(o.transform,a||null);null!=s&&(null==n&&(n=ci.empty()),n.set(o.field,s))}return n||null}function bo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Cr(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof ro&&e instanceof ro||t instanceof oo&&e instanceof oo?Cr(t.elements,e.elements,Xr):t instanceof so&&e instanceof so?Xr(t.A,e.A):t instanceof no&&e instanceof no}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function _o(t){return t.isFoundDocument()?t.version:Ar.min()}var wo=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return(0,hr.ZT)(e,t),e}(vo),Io=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var a=this;return(a=t.call(this)||this).key=e,a.data=n,a.fieldMask=r,a.precondition=i,a.fieldTransforms=o,a.type=1,a}return(0,hr.ZT)(e,t),e}(vo);function To(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function Eo(t,e,n){var r=new Map;wr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],a=o.transform,s=e.data.field(o.field);r.set(o.field,to(a,s,n[i]))}return r}function So(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var a=o[i],s=a.transform,u=n.data.field(a.field);r.set(a.field,$i(s,u,e))}return r}var Co,ko,No=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return(0,hr.ZT)(e,t),e}(vo),Ao=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return(0,hr.ZT)(e,t),e}(vo),Do=function(t){this.count=t};function Po(t){switch(t){case fr.OK:return _r();case fr.CANCELLED:case fr.UNKNOWN:case fr.DEADLINE_EXCEEDED:case fr.RESOURCE_EXHAUSTED:case fr.INTERNAL:case fr.UNAVAILABLE:case fr.UNAUTHENTICATED:return!1;case fr.INVALID_ARGUMENT:case fr.NOT_FOUND:case fr.ALREADY_EXISTS:case fr.PERMISSION_DENIED:case fr.FAILED_PRECONDITION:case fr.ABORTED:case fr.OUT_OF_RANGE:case fr.UNIMPLEMENTED:case fr.DATA_LOSS:return!0;default:return _r()}}function Ro(t){if(void 0===t)return mr("GRPC error has no .code"),fr.UNKNOWN;switch(t){case Co.OK:return fr.OK;case Co.CANCELLED:return fr.CANCELLED;case Co.UNKNOWN:return fr.UNKNOWN;case Co.DEADLINE_EXCEEDED:return fr.DEADLINE_EXCEEDED;case Co.RESOURCE_EXHAUSTED:return fr.RESOURCE_EXHAUSTED;case Co.INTERNAL:return fr.INTERNAL;case Co.UNAVAILABLE:return fr.UNAVAILABLE;case Co.UNAUTHENTICATED:return fr.UNAUTHENTICATED;case Co.INVALID_ARGUMENT:return fr.INVALID_ARGUMENT;case Co.NOT_FOUND:return fr.NOT_FOUND;case Co.ALREADY_EXISTS:return fr.ALREADY_EXISTS;case Co.PERMISSION_DENIED:return fr.PERMISSION_DENIED;case Co.FAILED_PRECONDITION:return fr.FAILED_PRECONDITION;case Co.ABORTED:return fr.ABORTED;case Co.OUT_OF_RANGE:return fr.OUT_OF_RANGE;case Co.UNIMPLEMENTED:return fr.UNIMPLEMENTED;case Co.DATA_LOSS:return fr.DATA_LOSS;default:return _r()}}(ko=Co||(Co={}))[ko.OK=0]="OK",ko[ko.CANCELLED=1]="CANCELLED",ko[ko.UNKNOWN=2]="UNKNOWN",ko[ko.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ko[ko.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ko[ko.NOT_FOUND=5]="NOT_FOUND",ko[ko.ALREADY_EXISTS=6]="ALREADY_EXISTS",ko[ko.PERMISSION_DENIED=7]="PERMISSION_DENIED",ko[ko.UNAUTHENTICATED=16]="UNAUTHENTICATED",ko[ko.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ko[ko.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ko[ko.ABORTED=10]="ABORTED",ko[ko.OUT_OF_RANGE=11]="OUT_OF_RANGE",ko[ko.UNIMPLEMENTED=12]="UNIMPLEMENTED",ko[ko.INTERNAL=13]="INTERNAL",ko[ko.UNAVAILABLE=14]="UNAVAILABLE",ko[ko.DATA_LOSS=15]="DATA_LOSS";var Oo=function(){function t(t,e){this.comparator=t,this.root=e||Lo.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Lo.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Lo.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new xo(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new xo(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new xo(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new xo(this.root,t,this.comparator,!0)},t}(),xo=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Lo=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw _r();if(this.right.isRed())throw _r();var t=this.left.check();if(t!==this.right.check())throw _r();return t+(this.isRed()?0:1)},t}();Lo.EMPTY=null,Lo.RED=!0,Lo.BLACK=!1,Lo.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw _r()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw _r()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Lo(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var Mo=function(){function t(t){this.comparator=t,this.data=new Oo(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new Fo(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new Fo(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),Fo=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Uo=new Oo(Qr.comparator);function qo(){return Uo}var jo=new Oo(Qr.comparator);function Vo(){return jo}var Bo=new Oo(Qr.comparator);function Go(){return Bo}var Ko=new Mo(Qr.comparator);function Wo(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Ko,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Ho=new Mo(Sr);function zo(){return Ho}var Jo=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Qo.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(Ar.min(),r,zo(),qo(),Wo())},t}(),Qo=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(Ur.EMPTY_BYTE_STRING,n,Wo(),Wo(),Wo())},t}(),Yo=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},Xo=function(t,e){this.targetId=t,this.V=e},Zo=function(t,e,n,r){void 0===n&&(n=Ur.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},$o=function(){function t(){this.S=0,this.D=na(),this.C=Ur.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"O",{get:function(){return this.F},enumerable:!1,configurable:!0}),t.prototype.$=function(t){t.approximateByteSize()>0&&(this.F=!0,this.C=t)},t.prototype.M=function(){var t=Wo(),e=Wo(),n=Wo();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:_r()}})),new Qo(this.C,this.N,t,e,n)},t.prototype.L=function(){this.F=!1,this.D=na()},t.prototype.B=function(t,e){this.F=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.F=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.F=!0,this.N=!0},t}(),ta=function(){function t(t){this.W=t,this.G=new Map,this.H=qo(),this.J=ea(),this.Y=new Mo(Sr)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.$(t.resumeToken);break;case 1:r.K(),r.k||r.L(),r.$(t.resumeToken);break;case 2:r.K(),r.k||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.$(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.$(t.resumeToken));break;default:_r()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(gi(i))if(0===n){var o=new Qr(i.path);this.tt(e,o,li.newNoDocument(o,Ar.min()))}else wr(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&gi(o.target)){var a=new Qr(o.target.path);null!==e.H.get(a)||e.at(i,a)||e.tt(i,a,li.newNoDocument(a,t))}r.O&&(n.set(i,r.M()),r.L())}}));var r=Wo();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new Jo(t,n,this.Y,this.H,r);return this.H=qo(),this.J=ea(),this.Y=new Mo(Sr),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new $o,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new Mo(Sr),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||gr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.k?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new $o),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function ea(){return new Oo(Qr.comparator)}function na(){return new Oo(Qr.comparator)}var ra={asc:"ASCENDING",desc:"DESCENDING"},ia={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},oa=function(t,e){this.databaseId=t,this.I=e};function aa(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function sa(t,e){return t.I?e.toBase64():e.toUint8Array()}function ua(t,e){return aa(t,e.toTimestamp())}function ca(t){return wr(!!t),Ar.fromTimestamp(function(t){var e=jr(t);return new Nr(e.seconds,e.nanos)}(t))}function ha(t,e){return function(t){return new xr(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function la(t){var e=xr.fromString(t);return wr(La(e)),e}function fa(t,e){return ha(t.databaseId,e.path)}function da(t,e){var n=la(e);if(n.get(1)!==t.databaseId.projectId)throw new dr(fr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new dr(fr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Qr(ma(n))}function pa(t,e){return ha(t.databaseId,e)}function va(t){var e=la(t);return 4===e.length?xr.emptyPath():ma(e)}function ga(t){return new xr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ma(t){return wr(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function ya(t,e,n){return{name:fa(t,e),fields:n.toProto().mapValue.fields}}function ba(t,e,n){var r=da(t,e.name),i=ca(e.updateTime),o=new ci({mapValue:{fields:e.fields}}),a=li.newFoundDocument(r,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function _a(t,e){var n;if(e instanceof wo)n={update:ya(t,e.key,e.value)};else if(e instanceof No)n={delete:fa(t,e.key)};else if(e instanceof Io)n={update:ya(t,e.key,e.data),updateMask:xa(e.fieldMask)};else{if(!(e instanceof Ao))return _r();n={verify:fa(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof no)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof ro)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof oo)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof so)return{fieldPath:e.field.canonicalString(),increment:n.A};throw _r()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:ua(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:_r()}(t,e.precondition)),n}function wa(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?fo.updateTime(ca(t.updateTime)):void 0!==t.exists?fo.exists(t.exists):fo.none()}(e.currentDocument):fo.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)wr("REQUEST_TIME"===e.setToServerValue),n=new no;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new ro(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new oo(i)}else"increment"in e?n=new so(t,e.increment):_r();var o=Mr.fromServerFormat(e.fieldPath);return new ho(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=da(t,e.update.name),o=new ci({mapValue:{fields:e.update.fields}});if(e.updateMask){var a=function(t){var e=t.fieldPaths||[];return new Fr(e.map((function(t){return Mr.fromServerFormat(t)})))}(e.updateMask);return new Io(i,o,a,n,r)}return new wo(i,o,n,r)}if(e.delete){var s=da(t,e.delete);return new No(s,n)}if(e.verify){var u=da(t,e.verify);return new Ao(u,n)}return _r()}function Ia(t,e){return{documents:[pa(t,e.path)]}}function Ta(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=pa(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=pa(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(si(t.value))return{unaryFilter:{field:Da(t.field),op:"IS_NAN"}};if(ai(t.value))return{unaryFilter:{field:Da(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(si(t.value))return{unaryFilter:{field:Da(t.field),op:"IS_NOT_NAN"}};if(ai(t.value))return{unaryFilter:{field:Da(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Da(t.field),op:Aa(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:Da(t.field),direction:Na(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var a=function(t,e){return t.I||Hr(e)?e:{value:e}}(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=Ca(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ca(e.endAt)),n}function Ea(t){var e=va(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){wr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=Sa(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(t){return function(t){return new Ni(Pa(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return Hr(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=ka(n.startAt));var h=null;return n.endAt&&(h=ka(n.endAt)),Oi(e,i,s,a,u,"F",c,h)}function Sa(t){return t?void 0!==t.unaryFilter?[Oa(t)]:void 0!==t.fieldFilter?[Ra(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Sa(t)})).reduce((function(t,e){return t.concat(e)})):_r():[]}function Ca(t){return{before:t.before,values:t.position}}function ka(t){var e=!!t.before,n=t.values||[];return new Ci(n,e)}function Na(t){return ra[t]}function Aa(t){return ia[t]}function Da(t){return{fieldPath:t.canonicalString()}}function Pa(t){return Mr.fromServerFormat(t.fieldPath)}function Ra(t){return mi.create(Pa(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return _r()}}(t.fieldFilter.op),t.fieldFilter.value)}function Oa(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Pa(t.unaryFilter.field);return mi.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Pa(t.unaryFilter.field);return mi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Pa(t.unaryFilter.field);return mi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Pa(t.unaryFilter.field);return mi.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return _r()}}function xa(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function La(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function Ma(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=Ua(e)),e=Fa(t.get(n),e);return Ua(e)}function Fa(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function Ua(t){return t+""}function qa(t){var e=t.length;if(wr(e>=2),2===e)return wr(""===t.charAt(0)&&""===t.charAt(1)),xr.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf("",o);switch((a<0||a>n)&&_r(),t.charAt(a+1)){case"":var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case"":i+=t.substring(o,a),i+="\0";break;case"":i+=t.substring(o,a+1);break;default:_r()}o=a+2}return new xr(r)}var ja=function(t,e){this.seconds=t,this.nanoseconds=e},Va=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Va.store="owner",Va.key="owner";var Ba=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Ba.store="mutationQueues",Ba.keyPath="userId";var Ga=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Ga.store="mutations",Ga.keyPath="batchId",Ga.userMutationsIndex="userMutationsIndex",Ga.userMutationsKeyPath=["userId","batchId"];var Ka=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Ma(e)]},t.key=function(t,e,n){return[t,Ma(e),n]},t}();Ka.store="documentMutations",Ka.PLACEHOLDER=new Ka;var Wa=function(t,e){this.path=t,this.readTime=e},Ha=function(t,e){this.path=t,this.version=e},za=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};za.store="remoteDocuments",za.readTimeIndex="readTimeIndex",za.readTimeIndexPath="readTime",za.collectionReadTimeIndex="collectionReadTimeIndex",za.collectionReadTimeIndexPath=["parentPath","readTime"];var Ja=function(t){this.byteSize=t};Ja.store="remoteDocumentGlobal",Ja.key="remoteDocumentGlobalKey";var Qa=function(t,e,n,r,i,o,a){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a};Qa.store="targets",Qa.keyPath="targetId",Qa.queryTargetsIndexName="queryTargetsIndex",Qa.queryTargetsKeyPath=["canonicalId","targetId"];var Ya=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};Ya.store="targetDocuments",Ya.keyPath=["targetId","path"],Ya.documentTargetsIndex="documentTargetsIndex",Ya.documentTargetsKeyPath=["path","targetId"];var Xa=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Xa.key="targetGlobalKey",Xa.store="targetGlobal";var Za=function(t,e){this.collectionId=t,this.parent=e};Za.store="collectionParents",Za.keyPath=["collectionId","parent"];var $a=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};$a.store="clientMetadata",$a.keyPath="clientId";var ts=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};ts.store="bundles",ts.keyPath="bundleId";var es=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};es.store="namedQueries",es.keyPath="name";var ns=(0,hr.ev)((0,hr.ev)([],(0,hr.ev)((0,hr.ev)([],(0,hr.ev)((0,hr.ev)([],(0,hr.ev)((0,hr.ev)([],[Ba.store,Ga.store,Ka.store,za.store,Qa.store,Va.store,Xa.store,Ya.store]),[$a.store])),[Ja.store])),[Za.store])),[ts.store,es.store]),rs="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",is=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),os=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},as=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&_r(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),ss=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new os,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new hs(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=vs(e.target.error);n.ft.reject(new hs(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new hs(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(gr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new fs(e)},t}(),us=function(){function t(n,r,i){this.name=n,this.version=r,this.wt=i,12.2===t._t((0,e.z$)())&&mr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return gr("SimpleDb","Removing database:",t),ds(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var n=(0,e.z$)(),r=t._t(n),i=0<r&&r<10,o=t.Et(n),a=0<o&&o<4.5;return!(n.indexOf("MSIE ")>0||n.indexOf("Trident/")>0||n.indexOf("Edge/")>0||i||a)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n=this;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(gr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new hs(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new dr(fr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new hs(t,n))},i.onupgradeneeded=function(t){gr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){gr("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return(0,hr.mG)(this,void 0,void 0,(function(){var i,o,a,s,u;return(0,hr.Jh)(this,(function(c){switch(c.label){case 0:i="readonly"===e,o=0,a=function(){var e,a,u,c,h;return(0,hr.Jh)(this,(function(l){switch(l.label){case 0:++o,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,s.At(t)];case 2:return s.db=l.sent(),e=ss.open(s.db,t,i?"readonly":"readwrite",n),a=r(e).catch((function(t){return e.abort(t),as.reject(t)})).toPromise(),u={},a.catch((function(){})),[4,e.dt];case 3:return[2,(u.value=(l.sent(),a),u)];case 4:return c=l.sent(),h="FirebaseError"!==c.name&&o<3,gr("SimpleDb","Transaction failed with error:",c.message,"Retrying:",h),s.close(),h?[3,5]:[2,{value:Promise.reject(c)}];case 5:return[2]}}))},s=this,c.label=1;case 1:return[5,a()];case 2:if("object"==typeof(u=c.sent()))return[2,u.value];c.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),cs=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return ds(this.Pt.delete())},t}(),hs=function(t){function e(e,n){var r=this;return(r=t.call(this,fr.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return(0,hr.ZT)(e,t),e}(dr);function ls(t){return"IndexedDbTransactionError"===t.name}var fs=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(gr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(gr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),ds(n)},t.prototype.add=function(t){return gr("SimpleDb","ADD",this.store.name,t,t),ds(this.store.add(t))},t.prototype.get=function(t){var e=this;return ds(this.store.get(t)).next((function(n){return void 0===n&&(n=null),gr("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return gr("SimpleDb","DELETE",this.store.name,t),ds(this.store.delete(t))},t.prototype.count=function(){return gr("SimpleDb","COUNT",this.store.name),ds(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.Ft=function(t,e){gr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.Ot=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.$t=function(t){var e=this.cursor({});return new as((function(n,r){e.onerror=function(t){var e=vs(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new as((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new cs(i),a=e(i.primaryKey,i.value,o);if(a instanceof as){var s=a.catch((function(t){return o.done(),as.reject(t)}));n.push(s)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return as.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.kt?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function ds(t){return new as((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=vs(t.target.error);n(e)}}))}var ps=!1;function vs(t){var n=us._t((0,e.z$)());if(n>=12.2&&n<13){var r="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(r)>=0){var i=new dr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+r+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ps||(ps=!0,setTimeout((function(){throw i}),0)),i}}return t}var gs=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return(0,hr.ZT)(e,t),e}(is);function ms(t,e){var n=Ir(t);return us.It(n.Mt,e)}var ys=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&go(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&mo(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&mo(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(Ar.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),Wo())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Cr(this.mutations,t.mutations,(function(t,e){return bo(t,e)}))&&Cr(this.baseMutations,t.baseMutations,(function(t,e){return bo(t,e)}))},t}(),bs=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){wr(e.mutations.length===r.length);for(var i=Go(),o=e.mutations,a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new t(e,n,r,i)},t}(),_s=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=Ar.min()),void 0===o&&(o=Ar.min()),void 0===a&&(a=Ur.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),ws=function(t){this.Lt=t};function Is(t,e){if(e.document)return ba(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=Qr.fromSegments(e.noDocument.path),r=ks(e.noDocument.readTime),i=li.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=Qr.fromSegments(e.unknownDocument.path);return r=ks(e.unknownDocument.version),li.newUnknownDocument(o,r)}return _r()}function Ts(t,e,n){var r=Es(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:fa(t,e.key),fields:e.data.toProto().mapValue.fields,updateTime:aa(t,e.version.toTimestamp())}}(t.Lt,e),a=e.hasCommittedMutations;return new za(null,null,o,a,r,i)}if(e.isNoDocument()){var s=e.key.path.toArray(),u=Cs(e.version);return a=e.hasCommittedMutations,new za(null,new Wa(s,u),null,a,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),h=Cs(e.version);return new za(new Ha(c,h),null,null,!0,r,i)}return _r()}function Es(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ss(t){var e=new Nr(t[0],t[1]);return Ar.fromTimestamp(e)}function Cs(t){var e=t.toTimestamp();return new ja(e.seconds,e.nanoseconds)}function ks(t){var e=new Nr(t.seconds,t.nanoseconds);return Ar.fromTimestamp(e)}function Ns(t,e){for(var n=(e.baseMutations||[]).map((function(e){return wa(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var a=e.mutations.map((function(e){return wa(t.Lt,e)})),s=Nr.fromMillis(e.localWriteTimeMs);return new ys(e.batchId,s,n,a)}function As(t){var e,n,r=ks(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?ks(t.lastLimboFreeSnapshotVersion):Ar.min();return void 0!==t.query.documents?(wr(1===(n=t.query).documents.length),e=Vi(xi(va(n.documents[0])))):e=function(t){return Vi(Ea(t))}(t.query),new _s(e,t.targetId,0,t.lastListenSequenceNumber,r,i,Ur.fromBase64String(t.resumeToken))}function Ds(t,e){var n,r=Cs(e.snapshotVersion),i=Cs(e.lastLimboFreeSnapshotVersion);n=gi(e.target)?Ia(t.Lt,e.target):Ta(t.Lt,e.target);var o=e.resumeToken.toBase64();return new Qa(e.targetId,pi(e.target),r,o,e.sequenceNumber,i,n)}function Ps(t){var e=Ea({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Bi(e,e.limit,"L"):e}var Rs=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return Os(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:ks(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return Os(t).put({bundleId:(n=e).id,createTime:Cs(ca(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return xs(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:Ps(e.bundledQuery),readTime:ks(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return xs(t).put(function(t){return{name:t.name,readTime:Cs(ca(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Os(t){return ms(t,ts.store)}function xs(t){return ms(t,es.store)}var Ls=function(){function t(){this.Bt=new Ms}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),as.resolve()},t.prototype.getCollectionParents=function(t,e){return as.resolve(this.Bt.getEntries(e))},t}(),Ms=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Mo(xr.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Mo(xr.comparator)).toArray()},t}(),Fs=function(){function t(){this.qt=new Ms}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:Ma(i)};return Us(t).put(o)}return as.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[kr(e),""],!1,!0);return Us(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(qa(o.parent))}return n}))},t}();function Us(t){return ms(t,Za.store)}var qs={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},js=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function Vs(t,e,n){var r=t.store(Ga.store),i=t.store(Ka.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.Ot({range:a},(function(t,e,n){return s++,n.delete()}));o.push(u.next((function(){wr(1===s)})));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],d=Ka.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return as.waitFor(o).next((function(){return c}))}function Bs(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw _r();e=t.noDocument}return JSON.stringify(e).length}js.DEFAULT_COLLECTION_PERCENTILE=10,js.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,js.DEFAULT=new js(41943040,js.DEFAULT_COLLECTION_PERCENTILE,js.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),js.DISABLED=new js(-1,0,0);var Gs=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Qt={}}return t.Kt=function(e,n,r,i){return wr(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ws(t).Ot({index:Ga.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=Hs(t),a=Ws(t);return a.add({}).next((function(s){wr("number"==typeof s);for(var u=new ys(s,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return _a(t.Lt,e)})),i=n.mutations.map((function(e){return _a(t.Lt,e)}));return new Ga(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),h=[],l=new Mo((function(t,e){return Sr(t.canonicalString(),e.canonicalString())})),f=0,d=r;f<d.length;f++){var p=d[f],v=Ka.key(i.userId,p.key.path,s);l=l.add(p.key.path.popLast()),h.push(a.put(c)),h.push(o.put(v,Ka.PLACEHOLDER))}return l.forEach((function(e){h.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Qt[s]=u.keys()})),as.waitFor(h).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return Ws(t).get(e).next((function(t){return t?(wr(t.userId===n.userId),Ns(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Qt[e]?as.resolve(this.Qt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Qt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Ws(t).Ot({index:Ga.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(wr(e.batchId>=r),o=Ns(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Ws(t).Ot({index:Ga.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ws(t).Nt(Ga.userMutationsIndex,n).next((function(t){return t.map((function(t){return Ns(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Ka.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Hs(t).Ot({range:i},(function(r,i,a){var s=r[0],u=r[1],c=r[2],h=qa(u);if(s===n.userId&&e.path.isEqual(h))return Ws(t).get(c).next((function(t){if(!t)throw _r();wr(t.userId===n.userId),o.push(Ns(n.R,t))}));a.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Mo(Sr),i=[];return e.forEach((function(e){var o=Ka.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=Hs(t).Ot({range:a},(function(t,i,o){var a=t[0],s=t[1],u=t[2],c=qa(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(s)})),as.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=Ka.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Mo(Sr);return Hs(t).Ot({range:a},(function(t,e,o){var a=t[0],u=t[1],c=t[2],h=qa(u);a===n.userId&&r.isPrefixOf(h)?h.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.Wt(t,s)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(Ws(t).get(e).next((function(t){if(null===t)throw _r();wr(t.userId===n.userId),r.push(Ns(n.R,t))})))})),as.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return Vs(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),as.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Qt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return as.resolve();var r=IDBKeyRange.lowerBound(Ka.prefixForUser(e.userId)),i=[];return Hs(t).Ot({range:r},(function(t,n,r){if(t[0]===e.userId){var o=qa(t[1]);i.push(o)}else r.done()})).next((function(){wr(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return Ks(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return zs(t).get(this.userId).next((function(t){return t||new Ba(e.userId,-1,"")}))},t}();function Ks(t,e,n){var r=Ka.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return Hs(t).Ot({range:o,kt:!0},(function(t,n,r){var o=t[0],s=t[1];t[2],o===e&&s===i&&(a=!0),r.done()})).next((function(){return a}))}function Ws(t){return ms(t,Ga.store)}function Hs(t){return ms(t,Ka.store)}function zs(t){return ms(t,Ba.store)}var Js=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),Qs=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new Js(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return Ar.fromTimestamp(new Nr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return Ys(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return wr(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return Ys(t).Ot((function(a,s){var u=As(s);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return as.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return Ys(t).Ot((function(t,n){var r=As(n);e(r)}))},t.prototype.Xt=function(t){return Xs(t).get(Xa.key).next((function(t){return wr(null!==t),t}))},t.prototype.Zt=function(t,e){return Xs(t).put(Xa.key,e)},t.prototype.te=function(t,e){return Ys(t).put(Ds(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=pi(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Ys(t).Ot({range:r,index:Qa.queryTargetsIndexName},(function(t,n,r){var o=As(n);vi(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=Zs(t);return e.forEach((function(e){var a=Ma(e.path);i.push(o.put(new Ya(n,a))),i.push(r.referenceDelegate.addReference(t,n,e))})),as.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=Zs(t);return as.forEach(e,(function(e){var o=Ma(e.path);return as.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=Zs(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=Zs(t),i=Wo();return r.Ot({range:n,kt:!0},(function(t,e,n){var r=qa(t[1]),o=new Qr(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=Ma(e.path),r=IDBKeyRange.bound([n],[kr(n)],!1,!0),i=0;return Zs(t).Ot({index:Ya.documentTargetsIndex,kt:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return Ys(t).get(e).next((function(t){return t?As(t):null}))},t}();function Ys(t){return ms(t,Qa.store)}function Xs(t){return ms(t,Xa.store)}function Zs(t){return ms(t,Ya.store)}function $s(t){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){if(t.code!==fr.FAILED_PRECONDITION||t.message!==rs)throw t;return gr("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}function tu(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=Sr(n,i);return 0===a?Sr(r,o):a}var eu=function(){function t(t){this.ne=t,this.buffer=new Mo(tu),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();tu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),nu=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;gr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return(0,hr.mG)(e,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return ls(e=n.sent())?(gr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,$s(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),ru=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return as.resolve(lr.o);var r=new eu(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(gr("LruGarbageCollector","Garbage collection skipped; disabled"),as.resolve(qs)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(gr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),qs):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,i,o,a,s,u,c,h=this,l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>h.params.maximumSequenceNumbersToCollect?(gr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.maximumSequenceNumbersToCollect+" from "+e),i=h.params.maximumSequenceNumbersToCollect):i=e,a=Date.now(),h.nthSequenceNumber(t,i)})).next((function(r){return n=r,s=Date.now(),h.removeTargets(t,n,e)})).next((function(e){return o=e,u=Date.now(),h.removeOrphanedDocuments(t,n)})).next((function(t){return c=Date.now(),vr()<=r.in.DEBUG&&gr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(a-l)+"ms\n\tDetermined least recently used "+i+" in "+(s-a)+"ms\n\tRemoved "+o+" targets in "+(u-s)+"ms\n\tRemoved "+t+" documents in "+(c-u)+"ms\nTotal Duration: "+(c-l)+"ms"),as.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:t})}))},t}(),iu=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new ru(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return ou(t,n)},t.prototype.removeReference=function(t,e,n){return ou(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return ou(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return zs(t).$t((function(r){return Ks(t,r,e).next((function(t){return t&&(n=!0),as.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(a,s){if(s<=e){var u=n._e(t,a).next((function(e){if(!e)return o++,r.getEntry(t,a).next((function(){return r.removeEntry(a),Zs(t).delete([0,Ma(a.path)])}))}));i.push(u)}})).next((function(){return as.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return ou(t,e)},t.prototype.we=function(t,e){var n,r=Zs(t),i=lr.o;return r.Ot({index:Ya.documentTargetsIndex},(function(t,r){var o=t[0],a=(t[1],r.path),s=r.sequenceNumber;0===o?(i!==lr.o&&e(new Qr(qa(n)),i),i=s,n=a):i=lr.o})).next((function(){i!==lr.o&&e(new Qr(qa(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function ou(t,e){return Zs(t).put(function(t,e){return new Ya(0,Ma(t.path),e)}(e,t.currentSequenceNumber))}var au=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(this.equalsFn(a,t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){Pr(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}}))},t.prototype.isEmpty=function(){return Rr(this.inner)},t}(),su=function(){function t(){this.changes=new au((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:Ar.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:li.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?as.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),uu=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return lu(t).put(fu(e),n)},t.prototype.removeEntry=function(t,e){var n=lu(t),r=fu(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return lu(t).get(fu(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return lu(t).get(fu(e)).next((function(t){return{document:n.ye(e,t),size:Bs(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=qo();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=qo(),i=new Oo(Qr.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,Bs(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return as.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return lu(t).Ot({range:r},(function(t,e,r){for(var a=Qr.fromSegments(t);o&&Qr.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=qo(),o=e.path.length+1,a={};if(n.isEqual(Ar.min())){var s=e.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=e.path.toArray(),c=Es(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=za.collectionReadTimeIndex}return lu(t).Ot(a,(function(t,n,a){if(t.length===o){var s=Is(r.R,n);e.path.isPrefixOf(s.key.path)?Hi(e,s)&&(i=i.insert(s.key,s)):a.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new cu(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return hu(t).get(Ja.key).next((function(t){return wr(!!t),t}))},t.prototype.me=function(t,e){return hu(t).put(Ja.key,e)},t.prototype.ye=function(t,e){if(e){var n=Is(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(Ar.min()))return n}return li.newInvalidDocument(t)},t}(),cu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new au((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return(0,hr.ZT)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Mo((function(t,e){return Sr(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,a){var s=e.Ae.get(o);if(a.document.isValidDocument()){var u=Ts(e.Ie.R,a.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=Bs(u);r+=c-s,n.push(e.Ie.addEntry(t,o,u))}else if(r-=s,e.trackRemovals){var h=Ts(e.Ie.R,li.newNoDocument(o,Ar.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,h))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),as.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(su);function hu(t){return ms(t,Ja.store)}function lu(t){return ms(t,za.store)}function fu(t){return t.path.toArray()}var du=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;wr(n<r&&n>=0&&r<=11);var o=new ss("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(Va.store)}(t),function(t){t.createObjectStore(Ba.store,{keyPath:Ba.keyPath}),t.createObjectStore(Ga.store,{keyPath:Ga.keyPath,autoIncrement:!0}).createIndex(Ga.userMutationsIndex,Ga.userMutationsKeyPath,{unique:!0}),t.createObjectStore(Ka.store)}(t),pu(t),function(t){t.createObjectStore(za.store)}(t));var a=as.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(Ya.store),t.deleteObjectStore(Qa.store),t.deleteObjectStore(Xa.store)}(t),pu(t)),a=a.next((function(){return function(t){var e=t.store(Xa.store),n=new Xa(0,0,Ar.min().toTimestamp(),0);return e.put(Xa.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return function(t,e){return e.store(Ga.store).Nt().next((function(n){t.deleteObjectStore(Ga.store),t.createObjectStore(Ga.store,{keyPath:Ga.keyPath,autoIncrement:!0}).createIndex(Ga.userMutationsIndex,Ga.userMutationsKeyPath,{unique:!0});var r=e.store(Ga.store),i=n.map((function(t){return r.put(t)}));return as.waitFor(i)}))}(t,o)}))),a=a.next((function(){!function(t){t.createObjectStore($a.store,{keyPath:$a.keyPath})}(t)}))),n<5&&r>=5&&(a=a.next((function(){return i.Re(o)}))),n<6&&r>=6&&(a=a.next((function(){return function(t){t.createObjectStore(Ja.store)}(t),i.be(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ve(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(a=a.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(za.store);e.createIndex(za.readTimeIndex,za.readTimeIndexPath,{unique:!1}),e.createIndex(za.collectionReadTimeIndex,za.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(a=a.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(a=a.next((function(){!function(t){t.createObjectStore(ts.store,{keyPath:ts.keyPath})}(t),function(t){t.createObjectStore(es.store,{keyPath:es.keyPath})}(t)}))),a},t.prototype.be=function(t){var e=0;return t.store(za.store).Ot((function(t,n){e+=Bs(n)})).next((function(){var n=new Ja(e);return t.store(Ja.store).put(Ja.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(Ba.store),r=t.store(Ga.store);return n.Nt().next((function(n){return as.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(Ga.userMutationsIndex,i).next((function(r){return as.forEach(r,(function(r){wr(r.userId===n.userId);var i=Ns(e.R,r);return Vs(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(Ya.store),n=t.store(za.store);return t.store(Xa.store).get(Xa.key).next((function(t){var r=[];return n.Ot((function(n,i){var o=new xr(n),a=function(t){return[0,Ma(t)]}(o);r.push(e.get(a).next((function(n){return n?as.resolve():function(n){return e.put(new Ya(0,Ma(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return as.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(Za.store,{keyPath:Za.keyPath});var n=e.store(Za.store),r=new Ms,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:Ma(i)})}};return e.store(za.store).Ot({kt:!0},(function(t,e){var n=new xr(t);return i(n.popLast())})).next((function(){return e.store(Ka.store).Ot({kt:!0},(function(t,e){t[0];var n=t[1],r=(t[2],qa(n));return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(Qa.store);return n.Ot((function(t,r){var i=As(r),o=Ds(e.R,i);return n.put(o)}))},t}();function pu(t){t.createObjectStore(Ya.store,{keyPath:Ya.keyPath}).createIndex(Ya.documentTargetsIndex,Ya.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Qa.store,{keyPath:Qa.keyPath}).createIndex(Qa.queryTargetsIndexName,Qa.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Xa.store)}var vu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",gu=function(){function t(e,n,r,i,o,a,s,u,c,h){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=a,this.document=s,this.De=c,this.Ce=h,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.Oe=null,this.$e=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new dr(fr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new iu(this,i),this.Le=n+"main",this.R=new ws(u),this.Be=new us(this.Le,11,new du(this.R)),this.qe=new Qs(this.referenceDelegate,this.R),this.Ut=new Fs,this.Ue=function(t,e){return new uu(t,e)}(this.R,this.Ut),this.Qe=new Rs,this.window&&this.window.localStorage?this.Ke=this.window.localStorage:(this.Ke=null,!1===h&&mr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new dr(fr.FAILED_PRECONDITION,vu);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new lr(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return(0,hr.mG)(e,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return(0,hr.mG)(e,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return(0,hr.mG)(e,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return yu(e).put(new $a(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(ls(e))return gr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return gr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return mu(t).get(Va.key).next((function(t){return as.resolve(e.tn(t))}))},t.prototype.en=function(t){return yu(t).delete(this.clientId)},t.prototype.nn=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t,e,n,r,i=this;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.$e,18e5)?[3,2]:(this.$e=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=ms(t,$a.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return as.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Ke)for(e=0,n=t;e<n.length;e++)r=n[e],this.Ke.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.Oe=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?as.resolve(!0):mu(t).get(Va.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new dr(fr.FAILED_PRECONDITION,vu);return!1}}return!(!e.networkEnabled||!e.inForeground)||yu(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&gr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t=this;return(0,hr.Jh)(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.Oe&&(this.Oe.cancel(),this.Oe=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Va.store,$a.store],(function(e){var n=new gs(e,lr.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return yu(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return Gs.Kt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;gr("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,ns,(function(o){return i=new gs(o,r.Ne?r.Ne.next():lr.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw mr("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new dr(fr.FAILED_PRECONDITION,rs);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return mu(t).get(Va.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new dr(fr.FAILED_PRECONDITION,vu)}))},t.prototype.Ze=function(t){var e=new Va(this.clientId,this.allowTabSynchronization,Date.now());return mu(t).put(Va.key,e)},t.yt=function(){return us.yt()},t.prototype.Xe=function(t){var e=this,n=mu(t);return n.get(Va.key).next((function(t){return e.tn(t)?(gr("IndexedDbPersistence","Releasing primary lease."),n.delete(Va.key)):as.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(mr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.Fe=function(){e.un(),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("unload",this.Fe))},t.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("unload",this.Fe),this.Fe=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Ke)||void 0===e?void 0:e.getItem(this.on(t)));return gr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return mr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Ke)try{this.Ke.setItem(this.on(this.clientId),String(Date.now()))}catch(t){mr("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Ke)try{this.Ke.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function mu(t){return ms(t,Va.store)}function yu(t){return ms(t,$a.store)}function bu(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var _u=function(t,e){this.progress=t,this.wn=e},wu=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return Qr.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):qi(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new Qr(e)).next((function(t){var e=Vo();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=Vo();return this.Ut.getCollectionParents(t,i).next((function(a){return as.forEach(a,(function(a){var s=function(t,e){return new Ri(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,a.child(i));return r.An(t,s,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,h=r.get(c);null==h&&(h=li.newInvalidDocument(c),r=r.insert(c,h)),mo(u,h,o.localWriteTime),h.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){Hi(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=Wo(),i=0,o=e;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof Io&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),Iu=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=Wo(),i=Wo(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),Tu=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,i){var o=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(Ar.min())?this.Dn(t,e):this.Sn.pn(t,i).next((function(a){var s=o.Cn(e,a);return(Li(e)||Mi(e))&&o.Nn(e.limitType,s,i,n)?o.Dn(t,e):(vr()<=r.in.DEBUG&&gr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Wi(e)),o.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return s.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new Mo(zi(t));return e.forEach((function(e,r){Hi(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return vr()<=r.in.DEBUG&&gr("QueryEngine","Using full collection scan to execute query:",Wi(e)),this.Sn.getDocumentsMatchingQuery(t,e,Ar.min())},t}(),Eu=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.Fn=new Oo(Sr),this.kn=new au((function(t){return pi(t)}),vi),this.On=Ar.min(),this._n=t.getMutationQueue(n),this.$n=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new wu(this.$n,this._n,this.persistence.getIndexManager()),this.Qe=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.Fn)}))},t}();function Su(t,e,n,r){return new Eu(t,e,n,r)}function Cu(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o;return(0,hr.Jh)(this,(function(a){switch(a.label){case 0:return n=Ir(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(a){return o=a,r=n.persistence.getMutationQueue(e),i=new wu(n.$n,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],a=Wo(),s=0,u=o;s<u.length;s++){var c=u[s];n.push(c.batchId);for(var h=0,l=c.mutations;h<l.length;h++){var f=l[h];a=a.add(f.key)}}for(var d=0,p=e;d<p.length;d++){var v=p[d];r.push(v.batchId);for(var g=0,m=v.mutations;g<m.length;g++){var y=m[g];a=a.add(y.key)}}return i.pn(t,a).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=a.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function ku(t,e){var n=Ir(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.$n.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),a=as.resolve();return o.forEach((function(t){a=a.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);wr(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),a.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function Nu(t){var e=Ir(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function Au(t,e){var n=Ir(t),r=e.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.$n.newChangeBuffer({trackRemovals:!0});i=n.Fn;var a=[];e.targetChanges.forEach((function(e,o){var s=i.get(o);if(s){a.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=s.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return wr(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(s,c,e)&&a.push(n.qe.updateTargetData(t,c))}}}));var s=qo();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),a.push(Du(t,o,e.documentUpdates,r,void 0).next((function(t){s=t}))),!r.isEqual(Ar.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));a.push(u)}return as.waitFor(a).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,s)})).next((function(){return s}))})).then((function(t){return n.Fn=i,t}))}function Du(t,e,n,r,i){var o=Wo();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=qo();return n.forEach((function(n,a){var s=t.get(n),u=(null==i?void 0:i.get(n))||r;a.isNoDocument()&&a.version.isEqual(Ar.min())?(e.removeEntry(n,u),o=o.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(e.addEntry(a,u),o=o.insert(n,a)):gr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)})),o}))}function Pu(t,e){var n=Ir(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function Ru(t,e){var n=Ir(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,as.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new _s(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.Fn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(t.targetId,t),n.kn.set(e,t.targetId)),t}))}function Ou(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r,i,o,a;return(0,hr.Jh)(this,(function(s){switch(s.label){case 0:r=Ir(t),i=r.Fn.get(e),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!ls(a=s.sent()))throw a;return gr("LocalStore","Failed to update sequence numbers for target "+e+": "+a),[3,5];case 5:return r.Fn=r.Fn.remove(e),r.kn.delete(i.target),[2]}}))}))}function xu(t,e,n){var r=Ir(t),i=Ar.min(),o=Wo();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=Ir(t),i=r.kn.get(n);return void 0!==i?as.resolve(r.Fn.get(i)):r.qe.getTargetData(e,n)}(r,t,Vi(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:Ar.min(),n?o:Wo())})).next((function(t){return{documents:t,Bn:o}}))}))}function Lu(t,e){var n=Ir(t),r=Ir(n.qe),i=n.Fn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function Mu(t){var e=Ir(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=Ir(t),i=qo(),o=Es(n),a=lu(e),s=IDBKeyRange.lowerBound(o,!0);return a.Ot({index:za.readTimeIndex,range:s},(function(t,e){var n=Is(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:Ss(o)}}))}(e.$n,t,e.On)})).then((function(t){var n=t.wn,r=t.readTime;return e.On=r,n}))}function Fu(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(n){return[2,(e=Ir(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=lu(t),n=Ar.min();return e.Ot({index:za.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Ss(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.On=t}))]}))}))}function Uu(t,e,n,r){return(0,hr.mG)(this,void 0,void 0,(function(){var i,o,a,s,u,c,h,l,f,d;return(0,hr.Jh)(this,(function(p){switch(p.label){case 0:for(i=Ir(t),o=Wo(),a=qo(),s=Go(),u=0,c=n;u<c.length;u++)h=c[u],l=e.qn(h.metadata.name),h.document&&(o=o.add(l)),a=a.insert(l,e.Un(h)),s=s.insert(l,e.Qn(h.metadata.readTime));return f=i.$n.newChangeBuffer({trackRemovals:!0}),[4,Ru(i,function(t){return Vi(xi(xr.fromString("__bundle__/docs/"+t)))}(r))];case 1:return d=p.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return Du(t,f,a,Ar.min(),s).next((function(e){return f.apply(t),e})).next((function(e){return i.qe.removeMatchingKeysForTargetId(t,d.targetId).next((function(){return i.qe.addMatchingKeys(t,o,d.targetId)})).next((function(){return i.Mn.En(t,e)})).next((function(){return e}))}))}))]}}))}))}function qu(t,e,n){return void 0===n&&(n=Wo()),(0,hr.mG)(this,void 0,void 0,(function(){var r,i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return[4,Ru(t,Vi(Ps(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=Ir(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=ca(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Qe.saveNamedQuery(t,e);var a=r.withResumeToken(Ur.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(a.targetId,a),i.qe.updateTargetData(t,a).next((function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)})).next((function(){return i.qe.addMatchingKeys(t,n,r.targetId)})).next((function(){return i.Qe.saveNamedQuery(t,e)}))}))]}}))}))}var ju=function(){function t(t){this.R=t,this.Kn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return as.resolve(this.Kn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Kn.set(e.id,{id:(n=e).id,version:n.version,createTime:ca(n.createTime)}),as.resolve()},t.prototype.getNamedQuery=function(t,e){return as.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:Ps(t.bundledQuery),readTime:ca(t.readTime)}}(e)),as.resolve()},t}(),Vu=function(){function t(){this.Wn=new Mo(Bu.Gn),this.zn=new Mo(Bu.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new Bu(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new Bu(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new Qr(new xr([])),r=new Bu(n,t),i=new Bu(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new Qr(new xr([])),n=new Bu(e,t),r=new Bu(e,t+1),i=Wo();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new Bu(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),Bu=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return Qr.comparator(t.key,e.key)||Sr(t.ns,e.ns)},t.Hn=function(t,e){return Sr(t.ns,e.ns)||Qr.comparator(t.key,e.key)},t}(),Gu=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new Mo(Bu.Gn)}return t.prototype.checkEmpty=function(t){return as.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new ys(i,e,n,r);this._n.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.rs=this.rs.add(new Bu(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return as.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return as.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return as.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return as.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return as.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new Bu(e,0),i=new Bu(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),as.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Mo(Sr);return e.forEach((function(t){var e=new Bu(t,0),i=new Bu(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),as.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;Qr.isDocumentKey(i)||(i=i.child(""));var o=new Bu(new Qr(i),0),a=new Mo(Sr);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.ns)),!0)}),o),as.resolve(this.us(a))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;wr(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return as.forEach(e.mutations,(function(i){var o=new Bu(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new Bu(e,0),r=this.rs.firstAfterOrEqual(n);return as.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,as.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),Ku=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new Oo(Qr.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,a=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:a,readTime:n}),this.size+=a-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return as.resolve(n?n.document.clone():li.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=qo();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():li.newInvalidDocument(t))})),as.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=qo(),i=new Qr(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.key,u=a.value,c=u.document,h=u.readTime;if(!e.path.isPrefixOf(s.path))break;h.compareTo(n)<=0||Hi(e,c)&&(r=r.insert(c.key,c.clone()))}return as.resolve(r)},t.prototype.fs=function(t,e){return as.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new Wu(this)},t.prototype.getSize=function(t){return as.resolve(this.size)},t}(),Wu=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return(0,hr.ZT)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),as.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(su),Hu=function(){function t(t){this.persistence=t,this.ds=new au((function(t){return pi(t)}),vi),this.lastRemoteSnapshotVersion=Ar.min(),this.highestTargetId=0,this.ws=0,this._s=new Vu,this.targetCount=0,this.ys=Js.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),as.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return as.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return as.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),as.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),as.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new Js(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,as.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),as.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,as.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(a,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.ds.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)})),as.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return as.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return as.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),as.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),as.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),as.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return as.resolve(n)},t.prototype.containsKey=function(t,e){return as.resolve(this._s.containsKey(e))},t}(),zu=function(){function t(t,e){var n=this;this.gs={},this.Ne=new lr(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new Hu(this),this.Ut=new Ls,this.Ue=function(t,e){return new Ku(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new ws(e),this.Qe=new ju(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new Gu(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Qe},t.prototype.runTransaction=function(t,e,n){var r=this;gr("MemoryPersistence","Starting transaction:",t);var i=new Ju(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return as.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),Ju=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return(0,hr.ZT)(e,t),e}(is),Qu=function(){function t(t){this.persistence=t,this.As=new Vu,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw _r()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),as.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),as.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),as.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return as.forEach(this.vs,(function(r){var i=Qr.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return as.or([function(){return as.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),Yu=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function Xu(t,e){return"firestore_clients_"+t+"_"+e}function Zu(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function $u(t,e){return"firestore_targets_"+t+"_"+e}Yu.UNAUTHENTICATED=new Yu(null),Yu.GOOGLE_CREDENTIALS=new Yu("google-credentials-uid"),Yu.FIRST_PARTY=new Yu("first-party-uid");var tc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),a="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return a&&o.error&&(a="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new dr(o.error.code,o.error.message)),a?new t(e,n,o.state,i):(mr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),ec=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new dr(i.error.code,i.error.message)),o?new t(e,i.state,r):(mr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),nc=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=zo(),a=0;i&&a<r.activeTargetIds.length;++a)i=Jr(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(mr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),rc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(mr("SharedClientState","Failed to parse online state: "+e),null)},t}(),ic=function(){function t(){this.activeTargetIds=zo()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),oc=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new Oo(Sr),this.started=!1,this.Os=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.$s=Xu(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new ic),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Qs=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,s,u,c,h,l=this;return(0,hr.Jh)(this,(function(f){switch(f.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=f.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(Xu(this.persistenceKey,r)))&&(o=nc.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Ks(),(a=this.storage.getItem(this.Us))&&(s=this.js(a))&&this.Ws(s),u=0,c=this.Os;u<c.length;u++)h=c[u],this.Fs(h);return this.Os=[],this.window.addEventListener("unload",(function(){return l.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem($u(this.persistenceKey,t));if(n){var r=ec.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Ks(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Ks()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem($u(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.$s),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return gr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){gr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){gr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.Fs=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(gr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.$s)return void mr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return(0,hr.mG)(e,void 0,void 0,(function(){var t,e,r,i,o,a;return(0,hr.Jh)(this,(function(s){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(a=function(t){var e=lr.o;if(null!=t)try{var n=JSON.parse(t);wr("number"==typeof n),e=n}catch(t){mr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==lr.o&&this.sequenceNumberHandler(a);else if(n.key===this.Qs)return[2,this.syncEngine.ci()]}else this.Os.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Ks=function(){this.setItem(this.$s,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new tc(this.currentUser,t,e,n),i=Zu(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=Zu(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=$u(this.persistenceKey,t),i=new ec(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Qs,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return nc.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return tc.Vs(new Yu(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return ec.Vs(r,e)},t.prototype.js=function(t){return rc.Vs(t)},t.prototype.ii=function(t){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(gr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.ks.insert(t,e):this.ks.remove(t),i=this.Gs(this.ks),o=this.Gs(r),a=[],s=[];return o.forEach((function(t){i.has(t)||a.push(t)})),i.forEach((function(t){o.has(t)||s.push(t)})),this.syncEngine.hi(a,s).then((function(){n.ks=r}))},t.prototype.Ws=function(t){this.ks.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=zo();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),ac=function(){function t(){this.li=new ic,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new ic,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),sc=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),uc=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){gr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){gr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),cc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},hc=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),lc=function(t){function n(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n}return(0,hr.ZT)(n,t),n.prototype.ki=function(t,e,n,r){return new Promise((function(i,o){var a=new cr;a.listenOnce(ir.COMPLETE,(function(){try{switch(a.getLastErrorCode()){case rr.NO_ERROR:var e=a.getResponseJson();gr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case rr.TIMEOUT:gr("Connection",'RPC "'+t+'" timed out'),o(new dr(fr.DEADLINE_EXCEEDED,"Request time out"));break;case rr.HTTP_ERROR:var n=a.getStatus();if(gr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",a.getResponseText()),n>0){var r=a.getResponseJson().error;if(r&&r.status&&r.message){var s=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(fr).indexOf(e)>=0?e:fr.UNKNOWN}(r.status);o(new dr(s,r.message))}else o(new dr(fr.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new dr(fr.UNAVAILABLE,"Connection failed."));break;default:_r()}}finally{gr("Connection",'RPC "'+t+'" completed.')}}));var s=JSON.stringify(r);a.send(e,"POST",s,n,15)}))},n.prototype.$i=function(t,n){var r=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new Zn,o=$t(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.Fi(a.initMessageHeaders,n),(0,e.uI)()||(0,e.b$)()||(0,e.d)()||(0,e.w1)()||(0,e.Mn)()||(0,e.ru)()||(a.httpHeadersOverwriteParam="$httpHeaders");var s=r.join("");gr("Connection","Creating WebChannel: "+s,a);var u=i.createWebChannel(s,a),c=!1,h=!1,l=new hc({Ei:function(t){h?gr("Connection","Not sending because WebChannel is closed:",t):(c||(gr("Connection","Opening WebChannel transport."),u.open(),c=!0),gr("Connection","WebChannel sending:",t),u.send(t))},Ti:function(){return u.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(u,ur.EventType.OPEN,(function(){h||gr("Connection","WebChannel transport opened.")})),f(u,ur.EventType.CLOSE,(function(){h||(h=!0,gr("Connection","WebChannel transport closed"),l.Vi())})),f(u,ur.EventType.ERROR,(function(t){h||(h=!0,yr("Connection","WebChannel transport errored:",t),l.Vi(new dr(fr.UNAVAILABLE,"The operation could not be completed")))})),f(u,ur.EventType.MESSAGE,(function(t){var e;if(!h){var n=t.data[0];wr(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){gr("Connection","WebChannel received error:",i);var o=i.status,a=function(t){var e=Co[t];if(void 0!==e)return Ro(e)}(o),s=i.message;void 0===a&&(a=fr.INTERNAL,s="Unknown error status: "+o+" with message "+i.message),h=!0,l.Vi(new dr(a,s)),u.close()}else gr("Connection","WebChannel received:",n),l.Si(n)}})),f(o,or.STAT_EVENT,(function(t){t.stat===ar?gr("Connection","Detected buffering proxy"):t.stat===sr&&gr("Connection","Detected no buffering proxy")})),setTimeout((function(){l.Pi()}),0),l},n}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);gr("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(t,i,o,n).then((function(t){return gr("RestConnection","Received: ",t),t}),(function(e){throw yr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.Oi=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.Fi=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.4.2",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=cc[t];return this.Di+"/v1/"+e+":"+n},t}());function fc(){return"undefined"!=typeof window?window:null}function dc(){return"undefined"!=typeof document?document:null}function pc(t){return new oa(t,!0)}var vc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Qi=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Ki=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Qi),i=Math.max(0,n-r);i>0&&gr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Qi=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),gc=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new vc(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===fr.RESOURCE_EXHAUSTED?(mr(e.toString()),mr("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Ki()):e&&e.code===fr.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new dr(fr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return(0,hr.mG)(t,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return gr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(gr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),mc=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,a}return(0,hr.ZT)(e,t),e.prototype.wr=function(t){return this.Hi.$i("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:_r()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(wr(void 0===e||"string"==typeof e),Ur.fromBase64String(e||"")):(wr(void 0===e||e instanceof Uint8Array),Ur.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),a=(s=e.targetChange.cause)&&function(t){var e=void 0===t.code?fr.UNKNOWN:Ro(t.code);return new dr(e,t.message||"")}(s);n=new Zo(r,i,o,a||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=da(t,r.document.name),o=ca(r.document.updateTime);var s=new ci({mapValue:{fields:r.document.fields}}),u=(a=li.newFoundDocument(i,o,s),r.targetIds||[]),c=r.removedTargetIds||[];n=new Yo(u,c,a.key,a)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=da(t,r.document),o=r.readTime?ca(r.readTime):Ar.min(),s=li.newNoDocument(i,o),a=r.removedTargetIds||[],n=new Yo([],a,s.key,s);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=da(t,r.document),o=r.removedTargetIds||[],n=new Yo([],o,i,null);else{if(!("filter"in e))return _r();e.filter;var h=e.filter;h.targetId,r=h.count||0,i=new Do(r),o=h.targetId,n=new Xo(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return Ar.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Ar.min():e.readTime?ca(e.readTime):Ar.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=ga(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=gi(r)?{documents:Ia(t,r)}:{query:Ta(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=sa(t,e.resumeToken):e.snapshotVersion.compareTo(Ar.min())>0&&(n.readTime=aa(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return _r()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=ga(this.R),e.removeTarget=t,this.cr(e)},e}(gc),yc=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,a.gr=!1,a}return(0,hr.ZT)(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.$i("Write",t)},e.prototype.onMessage=function(t){if(wr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(wr(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?ca(t.updateTime):ca(e);return n.isEqual(Ar.min())&&(n=ca(e)),new lo(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=ca(t.commitTime);return this.listener.Tr(n,e)}return wr(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=ga(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return _a(e.R,t)}))};this.cr(n)},e}(gc),bc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return(0,hr.ZT)(e,t),e.prototype.br=function(){if(this.Rr)throw new dr(fr.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===fr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new dr(fr.UNKNOWN,t.toString())}))},e.prototype.Oi=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Oi(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===fr.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new dr(fr.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),_c=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.Fr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(mr(e),this.Vr=!1):gr("OnlineStateTracker",e)},t.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),wc=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.Or=new Map,this.$r=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return(0,hr.mG)(o,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(t){switch(t.label){case 0:return Dc(this)?(gr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return(e=Ir(t)).$r.add(4),[4,Tc(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.$r.delete(4),[4,Ic(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new _c(n,r)};function Ic(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:if(!Dc(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Tc(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Ec(t,e){var n=Ir(t);n.Or.has(e.targetId)||(n.Or.set(e.targetId,e),Ac(n)?Nc(n):Wc(n).er()&&Cc(n,e))}function Sc(t,e){var n=Ir(t),r=Wc(n);n.Or.delete(e),r.er()&&kc(n,e),0===n.Or.size&&(r.er()?r.ir():Dc(n)&&n.Br.set("Unknown"))}function Cc(t,e){t.qr.U(e.targetId),Wc(t).mr(e)}function kc(t,e){t.qr.U(e),Wc(t).yr(e)}function Nc(t){t.qr=new ta({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.Or.get(e)||null}}),Wc(t).start(),t.Br.Sr()}function Ac(t){return Dc(t)&&!Wc(t).tr()&&t.Or.size>0}function Dc(t){return 0===Ir(t).$r.size}function Pc(t){t.qr=void 0}function Rc(t){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){return t.Or.forEach((function(e,n){Cc(t,e)})),[2]}))}))}function Oc(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(n){return Pc(t),Ac(t)?(t.Br.Nr(e),Nc(t)):t.Br.set("Unknown"),[2]}))}))}function xc(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r,i,o;return(0,hr.Jh)(this,(function(a){switch(a.label){case 0:if(t.Br.set("Online"),!(e instanceof Zo&&2===e.state&&e.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o;return(0,hr.Jh)(this,(function(a){switch(a.label){case 0:n=e.cause,r=0,i=e.targetIds,a.label=1;case 1:return r<i.length?(o=i[r],t.Or.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:a.sent(),t.Or.delete(o),t.qr.removeTarget(o),a.label=3;case 3:a.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return a.sent(),[3,5];case 3:return r=a.sent(),gr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Lc(t,r)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof Yo?t.qr.X(e):e instanceof Xo?t.qr.rt(e):t.qr.et(e),n.isEqual(Ar.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,Nu(t.localStore)];case 8:return i=a.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.Or.get(r);i&&t.Or.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.Or.get(e);if(n){t.Or.set(e,n.withResumeToken(Ur.EMPTY_BYTE_STRING,n.snapshotVersion)),kc(t,e);var r=new _s(n.target,e,1,n.sequenceNumber);Cc(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return gr("RemoteStore","Failed to raise snapshot:",o=a.sent()),[4,Lc(t,o)];case 12:return a.sent(),[3,13];case 13:return[2]}}))}))}function Lc(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r=this;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:if(!ls(e))throw e;return t.$r.add(1),[4,Tc(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return Nu(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return(0,hr.mG)(r,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){switch(e.label){case 0:return gr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.$r.delete(1),[4,Ic(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Mc(t,e){return e().catch((function(n){return Lc(t,n,e)}))}function Fc(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n,r,i,o;return(0,hr.Jh)(this,(function(a){switch(a.label){case 0:e=Ir(t),n=Hc(e),r=e.kr.length>0?e.kr[e.kr.length-1].batchId:-1,a.label=1;case 1:if(!function(t){return Dc(t)&&t.kr.length<10}(e))return[3,7];a.label=2;case 2:return a.trys.push([2,4,,6]),[4,Pu(e.localStore,r)];case 3:return null===(i=a.sent())?(0===e.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.kr.push(e);var n=Hc(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=a.sent(),[4,Lc(e,o)];case 5:return a.sent(),[3,6];case 6:return[3,1];case 7:return Uc(e)&&qc(e),[2]}}))}))}function Uc(t){return Dc(t)&&!Hc(t).tr()&&t.kr.length>0}function qc(t){Hc(t).start()}function jc(t){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){return Hc(t).Ar(),[2]}))}))}function Vc(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n,r,i;return(0,hr.Jh)(this,(function(o){for(e=Hc(t),n=0,r=t.kr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function Bc(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r,i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return r=t.kr.shift(),i=bs.from(r,e,n),[4,Mc(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,Fc(t)];case 2:return o.sent(),[2]}}))}))}function Gc(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return e&&Hc(t).pr?[4,function(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return Po(r=e.code)&&r!==fr.ABORTED?(n=t.kr.shift(),Hc(t).sr(),[4,Mc(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,Fc(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Uc(t)&&qc(t),[2]}}))}))}function Kc(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return n=Ir(t),e?(n.$r.delete(2),[4,Ic(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.$r.add(2),[4,Tc(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function Wc(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=Ir(t);return r.br(),new mc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Rc.bind(null,t),Ri:Oc.bind(null,t),_r:xc.bind(null,t)}),t.Mr.push((function(n){return(0,hr.mG)(e,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),Ac(t)?Nc(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),Pc(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function Hc(t){var e=this;return t.Qr||(t.Qr=function(t,e,n){var r=Ir(t);return r.br(),new yc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:jc.bind(null,t),Ri:Gc.bind(null,t),Ir:Vc.bind(null,t),Tr:Bc.bind(null,t)}),t.Mr.push((function(n){return(0,hr.mG)(e,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){switch(e.label){case 0:return n?(t.Qr.sr(),[4,Fc(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Qr.stop()];case 3:e.sent(),t.kr.length>0&&(gr("RemoteStore","Stopping write stream with "+t.kr.length+" pending writes"),t.kr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Qr}var zc=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new os,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new dr(fr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Jc(t,e){if(mr("AsyncQueue",e+": "+t),ls(t))return new dr(fr.UNAVAILABLE,e+": "+t);throw t}var Qc=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||Qr.comparator(e.key,n.key)}:function(t,e){return Qr.comparator(t.key,e.key)},this.keyedMap=Vo(),this.sortedSet=new Oo(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),Yc=function(){function t(){this.Kr=new Oo(Qr.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Kr.get(e);n?0!==t.type&&3===n.type?this.Kr=this.Kr.insert(e,t):3===t.type&&1!==n.type?this.Kr=this.Kr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Kr=this.Kr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Kr=this.Kr.remove(e):1===t.type&&2===n.type?this.Kr=this.Kr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Kr=this.Kr.insert(e,{type:2,doc:t.doc}):_r():this.Kr=this.Kr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Kr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),Xc=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,Qc.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Gi(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Zc=function(){this.Wr=void 0,this.listeners=[]},$c=function(){this.queries=new au((function(t){return Ki(t)}),Gi),this.onlineState="Unknown",this.Gr=new Set};function th(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return(0,hr.Jh)(this,(function(c){switch(c.label){case 0:if(n=Ir(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new Zc),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),a=o,[4,n.onListen(r)];case 2:return a.Wr=c.sent(),[3,4];case 3:return s=c.sent(),u=Jc(s,"Initialization of query '"+Wi(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&ih(n),[2]}}))}))}function eh(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o,a;return(0,hr.Jh)(this,(function(s){return n=Ir(t),r=e.query,i=!1,(o=n.queries.get(r))&&(a=o.listeners.indexOf(e))>=0&&(o.listeners.splice(a,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function nh(t,e){for(var n=Ir(t),r=!1,i=0,o=e;i<o.length;i++){var a=o[i],s=a.query,u=n.queries.get(s);if(u){for(var c=0,h=u.listeners;c<h.length;c++)h[c].Hr(a)&&(r=!0);u.Wr=a}}r&&ih(n)}function rh(t,e,n){var r=Ir(t),i=r.queries.get(e);if(i)for(var o=0,a=i.listeners;o<a.length;o++)a[o].onError(n);r.queries.delete(e)}function ih(t){t.Gr.forEach((function(t){t.next()}))}var oh=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new Xc(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=Xc.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),ah=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),sh=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return da(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?ba(this.R,t.document,!1):li.newNoDocument(this.qn(t.metadata.name),this.Qn(t.metadata.readTime))},t.prototype.Qn=function(t){return ca(t)},t}(),uh=function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=ch(t)}return t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new sh(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var a=n.qn(o.metadata.name),s=0,u=o.metadata.queries;s<u.length;s++){var c=u[s],h=(e.get(c)||Wo()).add(a);e.set(c,h)}}return e},t.prototype.complete=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t,e,n,r,i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return[4,Uu(this.localStore,new sh(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,qu(this.localStore,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new _u(Object.assign({},this.progress),t))]}}))}))},t}();function ch(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var hh=function(t){this.key=t},lh=function(t){this.key=t},fh=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=Wo(),this.mutatedKeys=Wo(),this.lo=zi(t),this.fo=new Qc(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new Yc,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=Li(this.query)&&i.size===this.query.limit?i.last():null,c=Mi(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var h=i.get(t),l=Hi(n.query,e)?e:null,f=!!h&&n.mutatedKeys.has(h.key),d=!!l&&(l.hasLocalMutations||n.mutatedKeys.has(l.key)&&l.hasCommittedMutations),p=!1;h&&l?h.data.isEqual(l.data)?f!==d&&(r.track({type:3,doc:l}),p=!0):n.yo(h,l)||(r.track({type:2,doc:l}),p=!0,(u&&n.lo(l,u)>0||c&&n.lo(l,c)<0)&&(s=!0)):!h&&l?(r.track({type:0,doc:l}),p=!0):h&&!l&&(r.track({type:1,doc:h}),p=!0,(u||c)&&(s=!0)),p&&(l?(a=a.add(l),o=d?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))})),Li(this.query)||Mi(this.query))for(;a.size>this.query.limit;){var h=Li(this.query)?a.last():a.first();a=a.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{fo:a,mo:r,Nn:s,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _r()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var a=e?this.Eo():[],s=0===this.ho.size&&this.current?1:0,u=s!==this.ao;return this.ao=s,0!==o.length||u?{snapshot:new Xc(this.query,t.fo,i,o,t.mutatedKeys,0===s,u,!1),To:a}:{To:a}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new Yc,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=Wo(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new lh(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new hh(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=Wo();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return Xc.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),dh=function(t,e,n){this.query=t,this.targetId=e,this.view=n},ph=function(t){this.key=t,this.bo=!1},vh=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new au((function(t){return Ki(t)}),Gi),this.Vo=new Map,this.So=new Set,this.Do=new Oo(Qr.comparator),this.Co=new Map,this.No=new Vu,this.xo={},this.Fo=new Map,this.ko=Js.Yt(),this.onlineState="Unknown",this.Oo=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.Oo},enumerable:!1,configurable:!0}),t}();function gh(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return(0,hr.Jh)(this,(function(u){switch(u.label){case 0:return n=Wh(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,Ru(n.localStore,Vi(e))];case 2:return a=u.sent(),s=n.sharedClientState.addLocalQueryTarget(a.targetId),r=a.targetId,[4,mh(n,e,r,"current"===s)];case 3:i=u.sent(),n.isPrimaryClient&&Ec(n.remoteStore,a),u.label=4;case 4:return[2,i]}}))}))}function mh(t,e,n,r){return(0,hr.mG)(this,void 0,void 0,(function(){var i,o,a,s,u,c;return(0,hr.Jh)(this,(function(h){switch(h.label){case 0:return t.$o=function(e,n,r){return function(t,e,n,r){return(0,hr.mG)(this,void 0,void 0,(function(){var i,o,a;return(0,hr.Jh)(this,(function(s){switch(s.label){case 0:return(i=e.view._o(n)).Nn?[4,xu(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),a=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(Dh(t,e.targetId,a.To),a.snapshot)]}}))}))}(t,e,n,r)},[4,xu(t.localStore,e,!0)];case 1:return i=h.sent(),o=new fh(e,i.Bn),a=o._o(i.documents),s=Qo.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(a,t.isPrimaryClient,s),Dh(t,n,u.To),c=new dh(e,n,o),[2,(t.Po.set(e,c),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}}))}))}function yh(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return n=Ir(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!Gi(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,Ou(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),Sc(n.remoteStore,r.targetId),Nh(n,r.targetId)})).catch($s)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Nh(n,r.targetId),[4,Ou(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function bh(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r,i,o,a;return(0,hr.Jh)(this,(function(s){switch(s.label){case 0:r=Hh(t),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,function(t,e){var n,r=Ir(t),i=Nr.now(),o=e.reduce((function(t,e){return t.add(e.key)}),Wo());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var a=[],s=0,u=e;s<u.length;s++){var c=u[s],h=yo(c,n.get(c.key));null!=h&&a.push(new Io(c.key,h,hi(h.toProto().mapValue),fo.exists(!0)))}return r._n.addMutationBatch(t,i,a,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=s.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new Oo(Sr)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,Oh(r,i.changes)];case 3:return s.sent(),[4,Fc(r.remoteStore)];case 4:return s.sent(),[3,6];case 5:return o=s.sent(),a=Jc(o,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}}))}))}function _h(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:n=Ir(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Au(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(wr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?wr(r.bo):t.removedDocuments.size>0&&(wr(r.bo),r.bo=!1))})),[4,Oh(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,$s(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function wh(t,e,n){var r=Ir(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Ir(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&ih(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Ih(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r,i,o,a,s,u;return(0,hr.Jh)(this,(function(c){switch(c.label){case 0:return(r=Ir(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(a=(a=new Oo(Qr.comparator)).insert(o,li.newNoDocument(o,Ar.min())),s=Wo().add(o),u=new Jo(Ar.min(),new Map,new Mo(Sr),a,s),[4,_h(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),Rh(r),[3,4];case 2:return[4,Ou(r.localStore,e,!1).then((function(){return Nh(r,e,n)})).catch($s)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function Th(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:n=Ir(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,ku(n.localStore,e)];case 2:return i=o.sent(),kh(n,r,null),Ch(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,Oh(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,$s(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Eh(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r,i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:r=Ir(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Ir(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return wr(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),kh(r,e,n),Ch(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,Oh(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,$s(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Sh(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o,a;return(0,hr.Jh)(this,(function(s){switch(s.label){case 0:Dc((n=Ir(t)).remoteStore)||gr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,function(t){var e=Ir(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=s.sent())?[2,void e.resolve()]:((i=n.Fo.get(r)||[]).push(e),n.Fo.set(r,i),[3,4]);case 3:return o=s.sent(),a=Jc(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(a),[3,4];case 4:return[2]}}))}))}function Ch(t,e){(t.Fo.get(e)||[]).forEach((function(t){t.resolve()})),t.Fo.delete(e)}function kh(t,e,n){var r=Ir(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Nh(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||Ah(t,e)}))}function Ah(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Sc(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Rh(t))}function Dh(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof hh?(t.No.addReference(o.key,e),Ph(t,o)):o instanceof lh?(gr("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||Ah(t,o.key)):_r()}}function Ph(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(gr("SyncEngine","New document in limbo: "+n),t.So.add(r),Rh(t))}function Rh(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new Qr(xr.fromString(e)),r=t.ko.next();t.Co.set(r,new ph(n)),t.Do=t.Do.insert(n,r),Ec(t.remoteStore,new _s(Vi(xi(n.path)),r,2,lr.o))}}function Oh(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r,i,o,a;return(0,hr.Jh)(this,(function(s){switch(s.label){case 0:return r=Ir(t),i=[],o=[],a=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,s){a.push(r.$o(s,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(s.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=Iu.Pn(s.targetId,t);o.push(e)}})))})),[4,Promise.all(a)]);case 1:return s.sent(),r.vo._r(i),[4,function(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,h;return(0,hr.Jh)(this,(function(l){switch(l.label){case 0:n=Ir(t),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return as.forEach(e,(function(e){return as.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return as.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return l.sent(),[3,4];case 3:if(!ls(r=l.sent()))throw r;return gr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=o[i],s=a.targetId,a.fromCache||(u=n.Fn.get(s),c=u.snapshotVersion,h=u.withLastLimboFreeSnapshotVersion(c),n.Fn=n.Fn.insert(s,h));return[2]}}))}))}(r.localStore,o)];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))}function xh(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return(n=Ir(t)).currentUser.isEqual(e)?[3,3]:(gr("SyncEngine","User change. New user:",e.toKey()),[4,Cu(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.Fo.forEach((function(t){t.forEach((function(t){t.reject(new dr(fr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.Fo.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,Oh(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Lh(t,e){var n=Ir(t),r=n.Co.get(e);if(r&&r.bo)return Wo().add(r.key);var i=Wo(),o=n.Vo.get(e);if(!o)return i;for(var a=0,s=o;a<s.length;a++){var u=s[a],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function Mh(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return[4,xu((n=Ir(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&Dh(n,e.targetId,i.To),i)]}}))}))}function Fh(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(n){return[2,Mu((e=Ir(t)).localStore).then((function(t){return Oh(e,t)}))]}))}))}function Uh(t,e,n,r){return(0,hr.mG)(this,void 0,void 0,(function(){var i,o;return(0,hr.Jh)(this,(function(a){switch(a.label){case 0:return[4,function(t,e){var n=Ir(t),r=Ir(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):as.resolve(null)}))}))}((i=Ir(t)).localStore,e)];case 1:return null===(o=a.sent())?[3,6]:"pending"!==n?[3,3]:[4,Fc(i.remoteStore)];case 2:return a.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(kh(i,e,r||null),Ch(i,e),function(t,e){Ir(Ir(t)._n).Gt(e)}(i.localStore,e)):_r(),a.label=4;case 4:return[4,Oh(i,o)];case 5:return a.sent(),[3,7];case 6:gr("SyncEngine","Cannot apply mutation batch with id: "+e),a.label=7;case 7:return[2]}}))}))}function qh(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c;return(0,hr.Jh)(this,(function(h){switch(h.label){case 0:return Wh(n=Ir(t)),Hh(n),!0!==e||!0===n.Oo?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,jh(n,r.toArray())]);case 1:return i=h.sent(),n.Oo=!0,[4,Kc(n.remoteStore,!0)];case 2:for(h.sent(),o=0,a=i;o<a.length;o++)s=a[o],Ec(n.remoteStore,s);return[3,7];case 3:return!1!==e||!1===n.Oo?[3,7]:(u=[],c=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):c=c.then((function(){return Nh(n,e),Ou(n.localStore,e,!0)})),Sc(n.remoteStore,e)})),[4,c]);case 4:return h.sent(),[4,jh(n,u)];case 5:return h.sent(),function(t){var e=Ir(t);e.Co.forEach((function(t,n){Sc(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new Oo(Qr.comparator)}(n),n.Oo=!1,[4,Kc(n.remoteStore,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}}))}))}function jh(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,h,l,f,d,p,v;return(0,hr.Jh)(this,(function(g){switch(g.label){case 0:n=Ir(t),r=[],i=[],o=0,a=e,g.label=1;case 1:return o<a.length?(s=a[o],u=void 0,(c=n.Vo.get(s))&&0!==c.length?[4,Ru(n.localStore,Vi(c[0]))]:[3,7]):[3,13];case 2:u=g.sent(),h=0,l=c,g.label=3;case 3:return h<l.length?(f=l[h],d=n.Po.get(f),[4,Mh(n,d)]):[3,6];case 4:(p=g.sent()).snapshot&&i.push(p.snapshot),g.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Lu(n.localStore,s)];case 8:return v=g.sent(),[4,Ru(n.localStore,v)];case 9:return u=g.sent(),[4,mh(n,Vh(v),s,!1)];case 10:g.sent(),g.label=11;case 11:r.push(u),g.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function Vh(t){return Oi(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Bh(t){var e=Ir(t);return Ir(Ir(e.localStore).persistence).fn()}function Gh(t,e,n,r){return(0,hr.mG)(this,void 0,void 0,(function(){var i,o,a;return(0,hr.Jh)(this,(function(s){switch(s.label){case 0:return(i=Ir(t)).Oo?(gr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Mu(i.localStore)];case 3:return o=s.sent(),a=Jo.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,Oh(i,o,a)];case 4:return s.sent(),[3,8];case 5:return[4,Ou(i.localStore,e,!0)];case 6:return s.sent(),Nh(i,e,r),[3,8];case 7:_r(),s.label=8;case 8:return[2]}}))}))}function Kh(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,h,l,f;return(0,hr.Jh)(this,(function(d){switch(d.label){case 0:if(!(r=Wh(t)).Oo)return[3,10];i=0,o=e,d.label=1;case 1:return i<o.length?(a=o[i],r.Vo.has(a)?(gr("SyncEngine","Adding an already active target "+a),[3,5]):[4,Lu(r.localStore,a)]):[3,6];case 2:return s=d.sent(),[4,Ru(r.localStore,s)];case 3:return u=d.sent(),[4,mh(r,Vh(s),u.targetId,!1)];case 4:d.sent(),Ec(r.remoteStore,u),d.label=5;case 5:return i++,[3,1];case 6:c=function(t){return(0,hr.Jh)(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,Ou(r.localStore,t,!1).then((function(){Sc(r.remoteStore,t),Nh(r,t)})).catch($s)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,l=n,d.label=7;case 7:return h<l.length?(f=l[h],[5,c(f)]):[3,10];case 8:d.sent(),d.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function Wh(t){var e=Ir(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=_h.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Lh.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Ih.bind(null,e),e.vo._r=nh.bind(null,e.eventManager),e.vo.Mo=rh.bind(null,e.eventManager),e}function Hh(t){var e=Ir(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Th.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Eh.bind(null,e),e}function zh(t,e,n){var r=Ir(t);(function(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r,i,o,a,s,u;return(0,hr.Jh)(this,(function(c){switch(c.label){case 0:return c.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return r=c.sent(),[4,function(t,e){var n=Ir(t),r=ca(e.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(t){return n.Qe.getBundleMetadata(t,e.id)})).then((function(t){return!!t&&t.createTime.compareTo(r)>=0}))}(t.localStore,r)];case 2:return c.sent()?[4,e.close()]:[3,4];case 3:return[2,(c.sent(),void n._completeWith(function(t){return{taskState:"Success",documentsLoaded:t.totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(r)))];case 4:return n._updateProgress(ch(r)),i=new uh(r,t.localStore,e.R),[4,e.Lo()];case 5:o=c.sent(),c.label=6;case 6:return o?[4,i.oo(o)]:[3,10];case 7:return(a=c.sent())&&n._updateProgress(a),[4,e.Lo()];case 8:o=c.sent(),c.label=9;case 9:return[3,6];case 10:return[4,i.complete()];case 11:return s=c.sent(),[4,Oh(t,s.wn,void 0)];case 12:return c.sent(),[4,function(t,e){var n=Ir(t);return n.persistence.runTransaction("Save bundle","readwrite",(function(t){return n.Qe.saveBundleMetadata(t,e)}))}(t.localStore,r)];case 13:return c.sent(),n._completeWith(s.progress),[3,15];case 14:return yr("SyncEngine","Loading bundle failed with "+(u=c.sent())),n._failWith(u),[3,15];case 15:return[2]}}))}))})(r,e,n).then((function(){r.sharedClientState.notifyBundleLoaded()}))}var Jh=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){switch(e.label){case 0:return this.R=pc(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Qo(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Qo=function(t){return Su(this.persistence,new Tu,t.initialUser,this.R)},t.prototype.qo=function(t){return new zu(Qu.bs,this.R)},t.prototype.Bo=function(t){return new ac},t.prototype.terminate=function(){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),Qh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Ko=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return(0,hr.ZT)(e,t),e.prototype.initialize=function(e){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return n.sent(),[4,Fu(this.localStore)];case 2:return n.sent(),[4,this.Ko.initialize(this,e)];case 3:return n.sent(),[4,Hh(this.Ko.syncEngine)];case 4:return n.sent(),[4,Fc(this.Ko.remoteStore)];case 5:return n.sent(),[2]}}))}))},e.prototype.Qo=function(t){return Su(this.persistence,new Tu,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new nu(e,t.asyncQueue)},e.prototype.qo=function(t){var e=bu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?js.withCacheSize(this.cacheSizeBytes):js.DEFAULT;return new gu(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,fc(),dc(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new ac},e}(Jh),Yh=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Ko=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return(0,hr.ZT)(e,t),e.prototype.initialize=function(e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r=this;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Ko.syncEngine,this.sharedClientState instanceof oc?(this.sharedClientState.syncEngine={ui:Uh.bind(null,n),ai:Gh.bind(null,n),hi:Kh.bind(null,n),fn:Bh.bind(null,n),ci:Fh.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return(0,hr.mG)(r,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){switch(e.label){case 0:return[4,qh(this.Ko.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=fc();if(!oc.yt(e))throw new dr(fr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=bu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new oc(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(Qh),Xh=function(){function t(){}return t.prototype.initialize=function(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n=this;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return wh(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=xh.bind(null,this.syncEngine),[4,Kc(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new $c},t.prototype.createDatastore=function(t){var e,n=pc(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new lc(e));return function(t,e,n){return new bc(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,a=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return wh(a.syncEngine,t,0)},o=uc.yt()?new uc:new sc,new wc(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,a){var s=new vh(t,e,n,r,i,o);return a&&(s.Oo=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return e=Ir(t),gr("RemoteStore","RemoteStore shutting down."),e.$r.add(5),[4,Tc(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}();function Zh(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return(0,hr.mG)(this,void 0,void 0,(function(){var r;return(0,hr.Jh)(this,(function(i){return n<t.byteLength?(r={value:t.slice(n,n+e),done:!1},[2,(n+=e,r)]):[2,{done:!0}]}))}))},cancel:function(){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(t){return[2]}))}))},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var $h=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),tl=function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new os,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then((function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}return t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Lo=function(){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}}))}))},t.prototype.Ho=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t,e,n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new ah(JSON.parse(r),t.length+n)]}}))}))},t.prototype.Zo=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.Jo=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t,e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.Xo=function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t,e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))},t}(),el=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n=this;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new dr(fr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return(0,hr.Jh)(this,(function(u){switch(u.label){case 0:return n=Ir(t),r=ga(n.R)+"/documents",i={documents:e.map((function(t){return fa(n.R,t)}))},[4,n.Oi("BatchGetDocuments",r,i)];case 1:return o=u.sent(),a=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){wr(!!e.found),e.found.name,e.found.updateTime;var n=da(t,e.found.name),r=ca(e.found.updateTime),i=new ci({mapValue:{fields:e.found.fields}});return li.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){wr(!!e.missing),wr(!!e.readTime);var n=da(t,e.missing),r=ca(e.readTime);return li.newNoDocument(n,r)}(t,e):_r()}(n.R,t);a.set(e.key.toString(),e)})),s=[],[2,(e.forEach((function(t){var e=a.get(t.toString());wr(!!e),s.push(e)})),s)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new No(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t,e=this;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=Qr.fromPath(n);e.mutations.push(new Ao(r,e.precondition(r)))})),[4,function(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return n=Ir(t),r=ga(n.R)+"/documents",i={writes:e.map((function(t){return _a(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw _r();e=Ar.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new dr(fr.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?fo.updateTime(e):fo.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(Ar.min()))throw new dr(fr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return fo.updateTime(e)}return fo.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),nl=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new vc(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return(0,hr.mG)(t,void 0,void 0,(function(){var t,e,n=this;return(0,hr.Jh)(this,(function(r){return t=new el(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!Hr(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Po(e)}return!1},t}(),rl=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=Yu.UNAUTHENTICATED,this.clientId=Er.u(),this.credentialListener=function(){},this.receivedInitialUser=new os,this.credentials.setChangeListener((function(t){gr("FirestoreClient","Received user=",t.uid),r.user=t,r.credentialListener(t),r.receivedInitialUser.resolve()}))}return t.prototype.getConfiguration=function(){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(t){switch(t.label){case 0:return[4,this.receivedInitialUser.promise];case 1:return[2,(t.sent(),{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100})]}}))}))},t.prototype.setCredentialChangeListener=function(t){var e=this;this.credentialListener=t,this.receivedInitialUser.promise.then((function(){return e.credentialListener(e.user)}))},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new dr(fr.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new os;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return(0,hr.mG)(t,void 0,void 0,(function(){var t,n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=Jc(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function il(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i=this;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),gr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(n){r.isEqual(n)||(r=n,t.asyncQueue.enqueueRetryable((function(){return(0,hr.mG)(i,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(t){switch(t.label){case 0:return[4,Cu(e.localStore,n)];case 1:return t.sent(),[2]}}))}))})))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function ol(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,al(t)];case 1:return n=i.sent(),gr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(n){return t.asyncQueue.enqueueRetryable((function(){return function(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return(n=Ir(t)).asyncQueue.verifyOperationInProgress(),gr("RemoteStore","RemoteStore received new credentials"),r=Dc(n),n.$r.add(3),[4,Tc(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.$r.delete(3),[4,Ic(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,n)}))})),t.onlineComponents=e,[2]}}))}))}function al(t){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(gr("FirestoreClient","Using default OfflineComponentProvider"),[4,il(t,new Jh)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function sl(t){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(gr("FirestoreClient","Using default OnlineComponentProvider"),[4,ol(t,new Xh)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function ul(t){return al(t).then((function(t){return t.persistence}))}function cl(t){return al(t).then((function(t){return t.localStore}))}function hl(t){return sl(t).then((function(t){return t.remoteStore}))}function ll(t){return sl(t).then((function(t){return t.syncEngine}))}function fl(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return[4,sl(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=gh.bind(null,e.syncEngine),n.onUnlisten=yh.bind(null,e.syncEngine),n)]}}))}))}function dl(t,e,n){var r=this;void 0===n&&(n={});var i=new os;return t.asyncQueue.enqueueAndForget((function(){return(0,hr.mG)(r,void 0,void 0,(function(){var r;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new $h({next:function(o){e.enqueueAndForget((function(){return eh(t,a)}));var s=o.docs.has(n);!s&&o.fromCache?i.reject(new dr(fr.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new dr(fr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),a=new oh(xi(n.path),o,{includeMetadataChanges:!0,so:!0});return th(t,a)},[4,fl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function pl(t,e,n){var r=this;void 0===n&&(n={});var i=new os;return t.asyncQueue.enqueueAndForget((function(){return(0,hr.mG)(r,void 0,void 0,(function(){var r;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new $h({next:function(n){e.enqueueAndForget((function(){return eh(t,a)})),n.fromCache&&"server"===r.source?i.reject(new dr(fr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),a=new oh(n,o,{includeMetadataChanges:!0,so:!0});return th(t,a)},[4,fl(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var vl=function(t,e,n,r,i,o,a){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a},gl=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),ml=new Map,yl=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},bl=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t){this.changeListener=t,t(Yu.UNAUTHENTICATED)},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),_l=function(){function t(t){var e=this;this.oc=null,this.currentUser=Yu.UNAUTHENTICATED,this.receivedInitialUser=!1,this.cc=0,this.changeListener=null,this.forceRefresh=!1,this.oc=function(){e.cc++,e.currentUser=e.uc(),e.receivedInitialUser=!0,e.changeListener&&e.changeListener(e.currentUser)},this.cc=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.oc):(this.oc(null),t.get().then((function(t){e.auth=t,e.oc&&e.auth.addAuthTokenListener(e.oc)}),(function(){})))}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(gr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(wr("string"==typeof n.accessToken),new yl(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t){this.changeListener=t,this.receivedInitialUser&&t(this.currentUser)},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.oc),this.oc=null,this.changeListener=null},t.prototype.uc=function(){var t=this.auth&&this.auth.getUid();return wr(null===t||"string"==typeof t),new Yu(t)},t}(),wl=function(){function t(t,e,n){this.ac=t,this.hc=e,this.lc=n,this.type="FirstParty",this.user=Yu.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.hc},e=this.ac.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.lc&&(t["X-Goog-Iam-Authorization-Token"]=this.lc),t},enumerable:!1,configurable:!0}),t}(),Il=function(){function t(t,e,n){this.ac=t,this.hc=e,this.lc=n}return t.prototype.getToken=function(){return Promise.resolve(new wl(this.ac,this.hc,this.lc))},t.prototype.setChangeListener=function(t){t(Yu.FIRST_PARTY)},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function Tl(t,e,n){if(!n)throw new dr(fr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function El(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new dr(fr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Sl(t,e,n,r){if(!0===e&&!0===r)throw new dr(fr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Cl(t){if(!Qr.isDocumentKey(t))throw new dr(fr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function kl(t){if(Qr.isDocumentKey(t))throw new dr(fr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Nl(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":_r()}function Al(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new dr(fr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Nl(t);throw new dr(fr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Dl(t,e){if(e<=0)throw new dr(fr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Pl=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new dr(fr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new dr(fr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,Sl("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},t}(),Rl=function(){function t(t,e){this._persistenceKey="(lite)",this._settings=new Pl({}),this._settingsFrozen=!1,t instanceof gl?(this._databaseId=t,this._credentials=new bl):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new dr(fr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new gl(t.options.projectId)}(t),this._credentials=new _l(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new dr(fr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new dr(fr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Pl(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new bl;switch(t.type){case"gapi":var e=t.client;return wr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Il(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new dr(fr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return(t=ml.get(this))&&(gr("ComponentProvider","Removing Datastore"),ml.delete(this),t.terminate()),Promise.resolve();var t},t}(),Ol=function(){function t(t,e,n){this._converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Ll(this.firestore,this._converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),xl=function(){function t(t,e,n){this._converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Ll=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,xi(r))||this)._path=r,i.type="collection",i}return(0,hr.ZT)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new Ol(this.firestore,null,new Qr(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(xl);function Ml(t,n){for(var r,i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];if(t=(0,e.m9)(t),Tl("collection","path",n),t instanceof Rl)return kl(r=xr.fromString.apply(xr,(0,hr.ev)([n],i))),new Ll(t,null,r);if(!(t instanceof Ol||t instanceof Ll))throw new dr(fr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return kl(r=xr.fromString.apply(xr,(0,hr.ev)([t.path],i)).child(xr.fromString(n))),new Ll(t.firestore,null,r)}function Fl(t,n){for(var r,i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];if(t=(0,e.m9)(t),1===arguments.length&&(n=Er.u()),Tl("doc","path",n),t instanceof Rl)return Cl(r=xr.fromString.apply(xr,(0,hr.ev)([n],i))),new Ol(t,null,new Qr(r));if(!(t instanceof Ol||t instanceof Ll))throw new dr(fr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Cl(r=t._path.child(xr.fromString.apply(xr,(0,hr.ev)([n],i)))),new Ol(t.firestore,t instanceof Ll?t._converter:null,new Qr(r))}function Ul(t,n){return t=(0,e.m9)(t),n=(0,e.m9)(n),(t instanceof Ol||t instanceof Ll)&&(n instanceof Ol||n instanceof Ll)&&t.firestore===n.firestore&&t.path===n.path&&t._converter===n._converter}function ql(t,n){return t=(0,e.m9)(t),n=(0,e.m9)(n),t instanceof xl&&n instanceof xl&&t.firestore===n.firestore&&Gi(t._query,n._query)&&t._converter===n._converter}var jl=function(){function t(){var t=this;this.fc=Promise.resolve(),this.dc=[],this.wc=!1,this._c=[],this.mc=null,this.yc=!1,this.gc=[],this.Zi=new vc(this,"async_queue_retry"),this.Ec=function(){var e=dc();e&&gr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=dc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ec)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this.wc},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Tc(),this.Ic(t)},t.prototype.enterRestrictedMode=function(){if(!this.wc){this.wc=!0;var t=dc();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ec)}},t.prototype.enqueue=function(t){return this.Tc(),this.wc?new Promise((function(t){})):this.Ic(t)},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.dc.push(t),e.Ac()}))},t.prototype.Ac=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t,e=this;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:if(0===this.dc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.dc[0]()];case 2:return n.sent(),this.dc.shift(),this.Zi.reset(),[3,4];case 3:if(!ls(t=n.sent()))throw t;return gr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.dc.length>0&&this.Zi.ji((function(){return e.Ac()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Ic=function(t){var e=this,n=this.fc.then((function(){return e.yc=!0,t().catch((function(t){throw e.mc=t,e.yc=!1,mr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.yc=!1,t}))}));return this.fc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Tc(),this.gc.indexOf(t)>-1&&(e=0);var i=zc.createAndSchedule(this,t,e,n,(function(t){return r.Rc(t)}));return this._c.push(i),i},t.prototype.Tc=function(){this.mc&&_r()},t.prototype.verifyOperationInProgress=function(){},t.prototype.bc=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t;return(0,hr.Jh)(this,(function(e){switch(e.label){case 0:return[4,t=this.fc];case 1:e.sent(),e.label=2;case 2:if(t!==this.fc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.vc=function(t){for(var e=0,n=this._c;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Pc=function(t){var e=this;return this.bc().then((function(){e._c.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e._c;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.bc()}))},t.prototype.Vc=function(t){this.gc.push(t)},t.prototype.Rc=function(t){var e=this._c.indexOf(t);this._c.splice(e,1)},t}();function Vl(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var Bl=function(){function t(){this._progressObserver={},this._taskCompletionResolver=new os,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)},t}(),Gl=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._queue=new jl,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return(0,hr.ZT)(e,t),e.prototype._terminate=function(){return this._firestoreClient||Wl(this),this._firestoreClient.terminate()},e}(Rl);function Kl(t){return t._firestoreClient||Wl(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Wl(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new vl(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new rl(t._credentials,t._queue,r)}function Hl(t,e,n){var r=this,i=new os;return t.asyncQueue.enqueue((function(){return(0,hr.mG)(r,void 0,void 0,(function(){var r;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,il(t,n)];case 1:return o.sent(),[4,ol(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===fr.FAILED_PRECONDITION||t.code===fr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function zl(t){if(t._initialized||t._terminated)throw new dr(fr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Jl=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new dr(fr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Mr(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),Ql=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(Ur.fromBase64String(e))}catch(e){throw new dr(fr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(Ur.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),Yl=function(t){this._methodName=t},Xl=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new dr(fr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new dr(fr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return Sr(this._lat,t._lat)||Sr(this._long,t._long)},t}(),Zl=/^__.*__$/,$l=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new Io(t,this.data,this.fieldMask,e,this.fieldTransforms):new wo(t,this.data,e,this.fieldTransforms)},t}(),tf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new Io(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function ef(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _r()}}var nf=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Sc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dc",{get:function(){return this.settings.Dc},enumerable:!1,configurable:!0}),t.prototype.Cc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.Nc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Cc({path:n,xc:!1});return r.Fc(t),r},t.prototype.kc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.Cc({path:n,xc:!1});return r.Sc(),r},t.prototype.Oc=function(t){return this.Cc({path:void 0,xc:!0})},t.prototype.$c=function(t){return Tf(t,this.settings.methodName,this.settings.Mc||!1,this.path,this.settings.Lc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Sc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.Fc(this.path.get(t))},t.prototype.Fc=function(t){if(0===t.length)throw this.$c("Document fields must not be empty");if(ef(this.Dc)&&Zl.test(t))throw this.$c('Document fields cannot begin and end with "__"')},t}(),rf=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||pc(t)}return t.prototype.Bc=function(t,e,n,r){return void 0===r&&(r=!1),new nf({Dc:t,methodName:e,Lc:n,path:Mr.emptyPath(),xc:!1,Mc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function of(t){var e=t._freezeSettings(),n=pc(t._databaseId);return new rf(t._databaseId,!!e.ignoreUndefinedProperties,n)}function af(t,e,n,r,i,o){void 0===o&&(o={});var a=t.Bc(o.merge||o.mergeFields?2:0,e,n,i);bf("Data must be an object, but it was:",a,r);var s,u,c=mf(r,a);if(o.merge)s=new Fr(a.fieldMask),u=a.fieldTransforms;else if(o.mergeFields){for(var h=[],l=0,f=o.mergeFields;l<f.length;l++){var d=_f(e,f[l],n);if(!a.contains(d))throw new dr(fr.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Ef(h,d)||h.push(d)}s=new Fr(h),u=a.fieldTransforms.filter((function(t){return s.covers(t.field)}))}else s=null,u=a.fieldTransforms;return new $l(new ci(c),s,u)}var sf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,hr.ZT)(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Dc)throw 1===t.Dc?t.$c(this._methodName+"() can only appear at the top level of your update data"):t.$c(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(Yl);function uf(t,e,n){return new nf({Dc:3,Lc:e.settings.Lc,methodName:t._methodName,xc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var cf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,hr.ZT)(e,t),e.prototype._toFieldTransform=function(t){return new ho(t.path,new no)},e.prototype.isEqual=function(t){return t instanceof e},e}(Yl),hf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).qc=n,r}return(0,hr.ZT)(e,t),e.prototype._toFieldTransform=function(t){var e=uf(this,t,!0),n=this.qc.map((function(t){return gf(t,e)})),r=new ro(n);return new ho(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Yl),lf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).qc=n,r}return(0,hr.ZT)(e,t),e.prototype._toFieldTransform=function(t){var e=uf(this,t,!0),n=this.qc.map((function(t){return gf(t,e)})),r=new oo(n);return new ho(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(Yl),ff=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Uc=n,r}return(0,hr.ZT)(e,t),e.prototype._toFieldTransform=function(t){var e=new so(t.R,Xi(t.R,this.Uc));return new ho(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(Yl);function df(t,n,r,i){var o=t.Bc(1,n,r);bf("Data must be an object, but it was:",o,i);var a=[],s=ci.empty();Pr(i,(function(t,i){var u=If(n,t,r);i=(0,e.m9)(i);var c=o.kc(u);if(i instanceof sf)a.push(u);else{var h=gf(i,c);null!=h&&(a.push(u),s.set(u,h))}}));var u=new Fr(a);return new tf(s,u,o.fieldTransforms)}function pf(t,n,r,i,o,a){var s=t.Bc(1,n,r),u=[_f(n,i,r)],c=[o];if(a.length%2!=0)throw new dr(fr.INVALID_ARGUMENT,"Function "+n+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var h=0;h<a.length;h+=2)u.push(_f(n,a[h])),c.push(a[h+1]);for(var l=[],f=ci.empty(),d=u.length-1;d>=0;--d)if(!Ef(l,u[d])){var p=u[d],v=c[d];v=(0,e.m9)(v);var g=s.kc(p);if(v instanceof sf)l.push(p);else{var m=gf(v,g);null!=m&&(l.push(p),f.set(p,m))}}var y=new Fr(l);return new tf(f,y,s.fieldTransforms)}function vf(t,e,n,r){return void 0===r&&(r=!1),gf(n,t.Bc(r?4:3,e))}function gf(t,n){if(yf(t=(0,e.m9)(t)))return bf("Unsupported field value:",n,t),mf(t,n);if(t instanceof Yl)return function(t,e){if(!ef(e.Dc))throw e.$c(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.$c(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,n),null;if(void 0===t&&n.ignoreUndefinedProperties)return null;if(n.path&&n.fieldMask.push(n.path),t instanceof Array){if(n.settings.xc&&4!==n.Dc)throw n.$c("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=gf(o[i],e.Oc(r));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),r++}return{arrayValue:{values:n}}}(t,n)}return function(t,n){if(null===(t=(0,e.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Xi(n.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var r=Nr.fromDate(t);return{timestampValue:aa(n.R,r)}}if(t instanceof Nr)return r=new Nr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:aa(n.R,r)};if(t instanceof Xl)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ql)return{bytesValue:sa(n.R,t._byteString)};if(t instanceof Ol){r=n.databaseId;var i=t.firestore._databaseId;if(!i.isEqual(r))throw n.$c("Document reference is for database "+i.projectId+"/"+i.database+" but should be for database "+r.projectId+"/"+r.database);return{referenceValue:ha(t.firestore._databaseId||n.databaseId,t._key.path)}}throw n.$c("Unsupported field value: "+Nl(t))}(t,n)}function mf(t,e){var n={};return Rr(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Pr(t,(function(t,r){var i=gf(r,e.Nc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function yf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Nr||t instanceof Xl||t instanceof Ql||t instanceof Ol||t instanceof Yl)}function bf(t,e,n){if(!yf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Nl(n);throw"an object"===r?e.$c(t+" a custom object"):e.$c(t+" "+r)}}function _f(t,n,r){if((n=(0,e.m9)(n))instanceof Jl)return n._internalPath;if("string"==typeof n)return If(t,n);throw Tf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,r)}var wf=new RegExp("[~\\*/\\[\\]]");function If(t,e,n){if(e.search(wf)>=0)throw Tf("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(Jl.bind.apply(Jl,(0,hr.ev)([void 0],e.split(".")))))._internalPath}catch(r){throw Tf("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Tf(t,e,n,r,i){var o=r&&!r.isEmpty(),a=void 0!==i,s="Function "+e+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var u="";return(o||a)&&(u+=" (found",o&&(u+=" in field "+r),a&&(u+=" in document "+i),u+=")"),new dr(fr.INVALID_ARGUMENT,(s+=". ")+t+u)}function Ef(t,e){return t.some((function(t){return t.isEqual(e)}))}var Sf=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Ol(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new Cf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.toProto())}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(kf("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),Cf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,hr.ZT)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Sf);function kf(t,e){return"string"==typeof e?If(t,e):e instanceof Jl?e._internalPath:e._delegate._internalPath}var Nf=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),Af=function(t){function e(e,n,r,i,o,a){var s=this;return(s=t.call(this,e,n,r,i,a)||this)._firestore=e,s._firestoreImpl=e,s.metadata=o,s}return(0,hr.ZT)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Df(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.toProto(),t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(kf("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Sf),Df=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,hr.ZT)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(Af),Pf=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Nf(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new Df(n._firestore,n._userDataWriter,r.key,r,new Nf(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query._converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new dr(fr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){var r=new Df(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Nf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query._converter);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Df(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Nf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query._converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Rf(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function Rf(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _r()}}function Of(t,e){return t instanceof Af&&e instanceof Af?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Pf&&e instanceof Pf&&t._firestore===e._firestore&&ql(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function xf(t){if(Mi(t)&&0===t.explicitOrderBy.length)throw new dr(fr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Lf=function(){};function Mf(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var Ff=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qc=e,i.Kc=n,i.jc=r,i.type="where",i}return(0,hr.ZT)(e,t),e.prototype._apply=function(t){var e=of(t.firestore),n=function(t,e,n,r,i,o,a){var s;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new dr(fr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Kf(a,o);for(var u=[],c=0,h=a;c<h.length;c++){var l=h[c];u.push(Gf(r,t,l))}s={arrayValue:{values:u}}}else s=Gf(r,t,a)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Kf(a,o),s=vf(n,"where",a,"in"===o||"not-in"===o);var f=mi.create(i,o,s);return function(t,e){if(e.g()){var n=Ui(t);if(null!==n&&!n.isEqual(e.field))throw new dr(fr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=Fi(t);null!==r&&Wf(0,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new dr(fr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new dr(fr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.Qc,this.Kc,this.jc);return new xl(t.firestore,t._converter,function(t,e){var n=t.filters.concat([e]);return new Ri(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Lf),Uf=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Qc=e,r.Wc=n,r.type="orderBy",r}return(0,hr.ZT)(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new dr(fr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new dr(fr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Ni(e,n);return function(t,e){if(null===Fi(t)){var n=Ui(t);null!==n&&Wf(0,n,e.field)}}(t,r),r}(t._query,this.Qc,this.Wc);return new xl(t.firestore,t._converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new Ri(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Lf),qf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Gc=n,i.zc=r,i}return(0,hr.ZT)(e,t),e.prototype._apply=function(t){return new xl(t.firestore,t._converter,Bi(t._query,this.Gc,this.zc))},e}(Lf),jf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Hc=n,i.Jc=r,i}return(0,hr.ZT)(e,t),e.prototype._apply=function(t){var e=Bf(t,this.type,this.Hc,this.Jc);return new xl(t.firestore,t._converter,function(t,e){return new Ri(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Lf),Vf=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Hc=n,i.Jc=r,i}return(0,hr.ZT)(e,t),e.prototype._apply=function(t){var e=Bf(t,this.type,this.Hc,this.Jc);return new xl(t.firestore,t._converter,function(t,e){return new Ri(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Lf);function Bf(t,n,r,i){if(r[0]=(0,e.m9)(r[0]),r[0]instanceof Sf)return function(t,e,n,r,i){if(!r)throw new dr(fr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],a=0,s=ji(t);a<s.length;a++){var u=s[a];if(u.field.isKeyField())o.push(ri(e,r.key));else{var c=r.data.field(u.field);if(Gr(c))throw new dr(fr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var h=u.field.canonicalString();throw new dr(fr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+h+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Ci(o,i)}(t._query,t.firestore._databaseId,n,r[0]._document,i);var o=of(t.firestore);return function(t,e,n,r,i,o){var a=t.explicitOrderBy;if(i.length>a.length)throw new dr(fr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],u=0;u<i.length;u++){var c=i[u];if(a[u].field.isKeyField()){if("string"!=typeof c)throw new dr(fr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!qi(t)&&-1!==c.indexOf("/"))throw new dr(fr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(xr.fromString(c));if(!Qr.isDocumentKey(h))throw new dr(fr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");var l=new Qr(h);s.push(ri(e,l))}else{var f=vf(n,r,c);s.push(f)}}return new Ci(s,o)}(t._query,t.firestore._databaseId,o,n,r,i)}function Gf(t,n,r){if("string"==typeof(r=(0,e.m9)(r))){if(""===r)throw new dr(fr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!qi(n)&&-1!==r.indexOf("/"))throw new dr(fr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+r+"' contains a '/' character.");var i=n.path.child(xr.fromString(r));if(!Qr.isDocumentKey(i))throw new dr(fr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+i+"' is not because it has an odd number of segments ("+i.length+").");return ri(t,new Qr(i))}if(r instanceof Ol)return ri(t,r._key);throw new dr(fr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Nl(r)+".")}function Kf(t,e){if(!Array.isArray(t)||0===t.length)throw new dr(fr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new dr(fr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Wf(t,e,n){if(!n.isEqual(e))throw new dr(fr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var Hf=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),Yr(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Vr(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(Br(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw _r()}},t.prototype.convertObject=function(t,e){var n=this,r={};return Pr(t.fields||{},(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new Xl(Vr(t.latitude),Vr(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=Kr(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(Wr(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=jr(t);return new Nr(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=xr.fromString(t);wr(La(n));var r=new gl(n.get(1),n.get(3)),i=new Qr(n.popFirst(5));return r.isEqual(e)||mr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function zf(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Jf=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,hr.ZT)(e,t),e.prototype.convertBytes=function(t){return new Ql(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Ol(this.firestore,null,e)},e}(Hf),Qf=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=of(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=Yf(t,this._firestore),i=zf(r._converter,e,n),o=af(this._dataReader,"WriteBatch.set",r._key,i,null!==r._converter,n);return this._mutations.push(o.toMutation(r._key,fo.none())),this},t.prototype.update=function(t,n,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];this._verifyNotCommitted();var a,s=Yf(t,this._firestore);return a="string"==typeof(n=(0,e.m9)(n))||n instanceof Jl?pf(this._dataReader,"WriteBatch.update",s._key,n,r,i):df(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(a.toMutation(s._key,fo.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=Yf(t,this._firestore);return this._mutations=this._mutations.concat(new No(e._key,fo.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new dr(fr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function Yf(t,n){if((t=(0,e.m9)(t)).firestore!==n)throw new dr(fr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Xf=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,hr.ZT)(e,t),e.prototype.convertBytes=function(t){return new Ql(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new Ol(this.firestore,null,e)},e}(Hf);function Zf(t,n,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];t=Al(t,Ol);var a=Al(t.firestore,Gl),s=of(a);return td(a,[("string"==typeof(n=(0,e.m9)(n))||n instanceof Jl?pf(s,"updateDoc",t._key,n,r,i):df(s,"updateDoc",t._key,n)).toMutation(t._key,fo.exists(!0))])}function $f(t){for(var n,r,i,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];t=(0,e.m9)(t);var s={includeMetadataChanges:!1},u=0;"object"!=typeof o[u]||Vl(o[u])||(s=o[u],u++);var c,h,l,f={includeMetadataChanges:s.includeMetadataChanges};if(Vl(o[u])){var d=o[u];o[u]=null===(n=d.next)||void 0===n?void 0:n.bind(d),o[u+1]=null===(r=d.error)||void 0===r?void 0:r.bind(d),o[u+2]=null===(i=d.complete)||void 0===i?void 0:i.bind(d)}if(t instanceof Ol)h=Al(t.firestore,Gl),l=xi(t._key.path),c={next:function(e){o[u]&&o[u](ed(h,t,e))},error:o[u+1],complete:o[u+2]};else{var p=Al(t,xl);h=Al(p.firestore,Gl),l=p._query;var v=new Xf(h);c={next:function(t){o[u]&&o[u](new Pf(h,v,p,t))},error:o[u+1],complete:o[u+2]},xf(t._query)}return function(t,e,n,r){var i=this,o=new $h(r),a=new oh(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return(0,hr.mG)(i,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return e=th,[4,fl(t)];case 1:return[2,e.apply(void 0,[n.sent(),a])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return(0,hr.mG)(i,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return e=eh,[4,fl(t)];case 1:return[2,e.apply(void 0,[n.sent(),a])]}}))}))}))}}(Kl(h),l,f,c)}function td(t,e){return function(t,e){var n=this,r=new os;return t.asyncQueue.enqueueAndForget((function(){return(0,hr.mG)(n,void 0,void 0,(function(){var n;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return n=bh,[4,ll(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(Kl(t),e)}function ed(t,e,n){var r=n.docs.get(e._key),i=new Xf(t);return new Af(t,i,e._key,r,new Nf(n.hasPendingWrites,n.fromCache),e._converter)}var nd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return(0,hr.ZT)(e,t),e.prototype.get=function(e){var n=this,r=Yf(e,this._firestore),i=new Xf(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new Af(n._firestore,i,r._key,t._document,new Nf(!1,!1),r._converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=of(t)}return t.prototype.get=function(t){var e=this,n=Yf(t,this._firestore),r=new Jf(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return _r();var i=t[0];if(i.isFoundDocument())return new Sf(e._firestore,r,i.key,i,n._converter);if(i.isNoDocument())return new Sf(e._firestore,r,n._key,null,n._converter);throw _r()}))},t.prototype.set=function(t,e,n){var r=Yf(t,this._firestore),i=zf(r._converter,e,n),o=af(this._dataReader,"Transaction.set",r._key,i,null!==r._converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,n,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a,s=Yf(t,this._firestore);return a="string"==typeof(n=(0,e.m9)(n))||n instanceof Jl?pf(this._dataReader,"Transaction.update",s._key,n,r,i):df(this._dataReader,"Transaction.update",s._key,n),this._transaction.update(s._key,a),this},t.prototype.delete=function(t){var e=Yf(t,this._firestore);return this._transaction.delete(e._key),this},t}());function rd(){if("undefined"==typeof Uint8Array)throw new dr(fr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function id(){if("undefined"==typeof atob)throw new dr(fr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var od=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return id(),new t(Ql.fromBase64String(e))},t.fromUint8Array=function(e){return rd(),new t(Ql.fromUint8Array(e))},t.prototype.toBase64=function(){return id(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return rd(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),ad=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){zl(t=Al(t,Gl));var n=Kl(t),r=t._freezeSettings(),i=new Xh;return Hl(n,i,new Qh(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){zl(t=Al(t,Gl));var e=Kl(t),n=t._freezeSettings(),r=new Xh;return Hl(e,r,new Yh(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new dr(fr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new os;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return(0,hr.mG)(e,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return us.yt()?(e=t+"main",[4,us.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(bu(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),sd=function(){function t(t,e,n){var r=this;this._delegate=e,this.Yc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof gl||(this.Xc=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this._delegate._getSettings()),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e){!function(t,e,n){var r=(t=Al(t,Rl))._getSettings();"firestore.googleapis.com"!==r.host&&r.host!==e&&yr("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},r),{host:e+":"+n,ssl:!1}))}(this._delegate,t,e)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return(0,hr.mG)(e,void 0,void 0,(function(){var e,n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return[4,ul(t)];case 1:return e=r.sent(),[4,hl(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=Ir(t);return e.$r.delete(0),Ic(e)}(n))]}}))}))}))}(Kl(Al(this._delegate,Gl)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return(0,hr.mG)(e,void 0,void 0,(function(){var e,n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return[4,ul(t)];case 1:return e=r.sent(),[4,hl(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return(e=Ir(t)).$r.add(0),[4,Tc(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(Kl(Al(this._delegate,Gl)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Sl("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Yc.enableMultiTabIndexedDbPersistence(this):this.Yc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Yc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.Xc&&(this.Xc._removeServiceInstance("firestore"),this.Xc._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new os;return t.asyncQueue.enqueueAndForget((function(){return(0,hr.mG)(e,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return e=Sh,[4,ll(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(Kl(Al(this._delegate,Gl)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new $h(e);return t.asyncQueue.enqueueAndForget((function(){return(0,hr.mG)(n,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return e=function(t,e){Ir(t).Gr.add(e),e.next()},[4,fl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return(0,hr.mG)(n,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return e=function(t,e){Ir(t).Gr.delete(e)},[4,fl(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(Kl(t=Al(t,Gl)),Vl(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.Xc)throw new dr(fr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Xc},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new wd(this,Ml(this._delegate,t))}catch(t){throw dd(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new fd(this,Fl(this._delegate,t))}catch(t){throw dd(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new yd(this,function(t,e){if(t=Al(t,Rl),Tl("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new dr(fr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new xl(t,null,function(t){return new Ri(xr.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw dd(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new os;return t.asyncQueue.enqueueAndForget((function(){return(0,hr.mG)(n,void 0,void 0,(function(){var n;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return[4,function(t){return sl(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new nl(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(Kl(t),(function(n){return e(new nd(t,n))}))}(this._delegate,(function(n){return t(new cd(e,n))}))},t.prototype.batch=function(){var t=this;return Kl(this._delegate),new hd(new Qf(this._delegate,(function(e){return td(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new dr(fr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new dr(fr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),ud=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,hr.ZT)(e,t),e.prototype.convertBytes=function(t){return new od(new Ql(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return fd.Zc(e,this.firestore,null)},e}(Hf),cd=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new ud(t)}return t.prototype.get=function(t){var e=this,n=Id(t);return this._delegate.get(n).then((function(t){return new gd(e._firestore,new Af(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n._converter))}))},t.prototype.set=function(t,e,n){var r=Id(t);return n?(El("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=Id(t);return 2===arguments.length?this._delegate.update(a,e):(r=this._delegate).update.apply(r,(0,hr.ev)([a,e,n],i)),this},t.prototype.delete=function(t){var e=Id(t);return this._delegate.delete(e),this},t}(),hd=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=Id(t);return n?(El("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=Id(t);return 2===arguments.length?this._delegate.update(a,e):(r=this._delegate).update.apply(r,(0,hr.ev)([a,e,n],i)),this},t.prototype.delete=function(t){var e=Id(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),ld=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new Df(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new md(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.tu=function(e,n){var r=t.eu,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new ud(e),n),i.set(n,o)),o},t}();ld.eu=new WeakMap;var fd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new ud(t)}return t.nu=function(e,n,r){if(e.length%2!=0)throw new dr(fr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new Ol(n._delegate,r,new Qr(e)))},t.Zc=function(e,n,r){return new t(n,new Ol(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new wd(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new wd(this.firestore,Ml(this._delegate,t))}catch(t){throw dd(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=(0,e.m9)(t))instanceof Ol&&Ul(this._delegate,t)},t.prototype.set=function(t,e){e=El("DocumentReference.set",e);try{return function(t,e,n){t=Al(t,Ol);var r=Al(t.firestore,Gl),i=zf(t._converter,e,n);return td(r,[af(of(r),"setDoc",t._key,i,null!==t._converter,n).toMutation(t._key,fo.none())])}(this._delegate,t,e)}catch(t){throw dd(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Zf(this._delegate,t):Zf.apply(void 0,(0,hr.ev)([this._delegate,t,e],n))}catch(t){throw dd(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return td(Al((t=this._delegate).firestore,Gl),[new No(t._key,fo.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=pd(e),i=vd(e,(function(e){return new gd(t.firestore,new Af(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate._converter))}));return $f(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Al(t,Ol);var e=Al(t.firestore,Gl),n=Kl(e),r=new Xf(e);return function(t,e){var n=this,r=new os;return t.asyncQueue.enqueueAndForget((function(){return(0,hr.mG)(n,void 0,void 0,(function(){var n;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r,i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Ir(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new dr(fr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Jc(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,cl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new Af(e,r,t._key,n,new Nf(null!==n&&n.hasLocalMutations,!0),t._converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Al(t,Ol);var e=Al(t.firestore,Gl);return dl(Kl(e),t._key,{source:"server"}).then((function(n){return ed(e,t,n)}))}(this._delegate):function(t){t=Al(t,Ol);var e=Al(t.firestore,Gl);return dl(Kl(e),t._key).then((function(n){return ed(e,t,n)}))}(this._delegate)).then((function(t){return new gd(e.firestore,new Af(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate._converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(ld.tu(this.firestore,e)):this._delegate.withConverter(null))},t}();function dd(t,e,n){return t.message=t.message.replace(e,n),t}function pd(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Vl(r))return r}return{}}function vd(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=Vl(t[0])?t[0]:Vl(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var gd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new fd(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return Of(this._delegate,t._delegate)},t}(),md=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,hr.ZT)(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(gd),yd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new ud(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,Mf(this._delegate,function(t,e,n){var r=e,i=kf("where",t);return new Ff(i,r,n)}(e,n,r)))}catch(e){throw dd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,Mf(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=kf("orderBy",t);return new Uf(r,n)}(e,n)))}catch(e){throw dd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,Mf(this._delegate,function(t){return Dl("limit",t),new qf("limit",t,"F")}(e)))}catch(e){throw dd(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,Mf(this._delegate,function(t){return Dl("limitToLast",t),new qf("limitToLast",t,"L")}(e)))}catch(e){throw dd(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Mf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new jf("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw dd(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Mf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new jf("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw dd(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Mf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Vf("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw dd(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Mf(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Vf("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw dd(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return ql(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=Al(t,xl);var e=Al(t.firestore,Gl),n=Kl(e),r=new Xf(e);return function(t,e){var n=this,r=new os;return t.asyncQueue.enqueueAndForget((function(){return(0,hr.mG)(n,void 0,void 0,(function(){var n;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r,i,o,a,s;return(0,hr.Jh)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,xu(t,e,!0)];case 1:return s=u.sent(),r=new fh(e,s.Bn),i=r._o(s.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return a=u.sent(),s=Jc(a,"Failed to execute query '"+e+" against cache"),n.reject(s),[3,3];case 3:return[2]}}))}))},[4,cl(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new Pf(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=Al(t,xl);var e=Al(t.firestore,Gl),n=Kl(e),r=new Xf(e);return pl(n,t._query,{source:"server"}).then((function(n){return new Pf(e,r,t,n)}))}(this._delegate):function(t){t=Al(t,xl);var e=Al(t.firestore,Gl),n=Kl(e),r=new Xf(e);return xf(t._query),pl(n,t._query).then((function(n){return new Pf(e,r,t,n)}))}(this._delegate)).then((function(t){return new _d(e.firestore,new Pf(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=pd(e),i=vd(e,(function(e){return new _d(t.firestore,new Pf(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return $f(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(ld.tu(this.firestore,e)):this._delegate.withConverter(null))},t}(),bd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new md(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),_d=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new yd(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new md(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new bd(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new md(n._firestore,r))}))},t.prototype.isEqual=function(t){return Of(this._delegate,t._delegate)},t}(),wd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return(0,hr.ZT)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new fd(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new fd(this.firestore,void 0===t?Fl(this._delegate):Fl(this._delegate,t))}catch(t){throw dd(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=Al(t.firestore,Gl),r=Fl(t),i=zf(t._converter,e);return td(n,[af(of(t.firestore),"addDoc",r._key,i,null!==t._converter,{}).toMutation(r._key,fo.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new fd(e.firestore,t)}))},e.prototype.isEqual=function(t){return Ul(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(ld.tu(this.firestore,t)):this._delegate.withConverter(null))},e}(yd);function Id(t){return Al(t,Ol)}var Td=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(Jl.bind.apply(Jl,(0,hr.ev)([void 0],t)))}return t.documentId=function(){return new t(Mr.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=(0,e.m9)(t))instanceof Jl&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Ed=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new cf("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new sf("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new hf("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new lf("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new ff("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}();var Sd,Cd,kd=n(909),Nd={Firestore:sd,GeoPoint:Xl,Timestamp:Nr,Blob:od,Transaction:cd,WriteBatch:hd,DocumentReference:fd,DocumentSnapshot:gd,Query:yd,QueryDocumentSnapshot:md,QuerySnapshot:_d,CollectionReference:wd,FieldPath:Td,FieldValue:Ed,setLogLevel:function(t){var e;e=t,pr.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new kd.wA("firestore",(function(t){return function(t,e){return new sd(t,new Gl(t,e),new ad)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Nd)))})(Sd=t.Z),Sd.registerVersion("@firebase/firestore","2.2.5"),(Cd=sd).prototype.loadBundle=function(t){return function(t,e){var n=Kl(t=Al(t,Gl)),r=new Bl;return function(t,e,n,r){var i=this,o=function(t,e){return function(t,e){return new tl(t,e)}(function(t,e){if(t instanceof Uint8Array)return Zh(t,e);if(t instanceof ArrayBuffer)return Zh(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof t?(new TextEncoder).encode(t):t),e)}(n,pc(e));t.asyncQueue.enqueueAndForget((function(){return(0,hr.mG)(i,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return e=zh,[4,ll(t)];case 1:return e.apply(void 0,[n.sent(),o,r]),[2]}}))}))}))}(n,t._databaseId,e,r),r}(this._delegate,t)},Cd.prototype.namedQuery=function(t){var e,n,r=this;return(e=this._delegate,n=t,function(t,e){var n=this;return t.asyncQueue.enqueue((function(){return(0,hr.mG)(n,void 0,void 0,(function(){var n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return n=function(t,e){var n=Ir(t);return n.persistence.runTransaction("Get named query","readonly",(function(t){return n.Qe.getNamedQuery(t,e)}))},[4,cl(t)];case 1:return[2,n.apply(void 0,[r.sent(),e])]}}))}))}))}(Kl(e=Al(e,Gl)),n).then((function(t){return t?new xl(e,null,t.query):null}))).then((function(t){return t?new yd(r,t):null}))};var Ad={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Dd=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return(0,hr.ZT)(e,t),e}(Error),Pd=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t;return(0,hr.Jh)(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(t){if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];try{return[2,this.messaging.getToken()]}catch(t){return[2,void 0]}return[2]}))}))},t.prototype.getContext=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t,e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();function Rd(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var Od,xd,Ld,Md=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"==typeof t||"object"==typeof t)return Rd(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"==typeof t||"object"==typeof t?Rd(t,(function(t){return e.decode(t)})):t},t}(),Fd=function(){function t(t,e,n,r,i){var o=this;void 0===r&&(r="us-central1"),this.app_=t,this.fetchImpl=i,this.serializer=new Md,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(o.deleteService())}},this.contextProvider=new Pd(e,n),this.cancelAllRequests=new Promise((function(t){o.deleteService=function(){return t()}}));try{var a=new URL(r);this.customDomain=a.origin,this.region="us-central1"}catch(t){this.customDomain=null,this.region=r}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r,i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:n["Content-Type"]="application/json",o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 2:return r=o.sent(),[3,4];case 3:return o.sent(),[2,{status:0,json:null}];case 4:i=null,o.label=5;case 5:return o.trys.push([5,7,,8]),[4,r.json()];case 6:return i=o.sent(),[3,8];case 7:return o.sent(),[3,8];case 8:return[2,{status:r.status,json:i}]}}))}))},t.prototype.call=function(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,h,l,f,d;return(0,hr.Jh)(this,(function(p){switch(p.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o={},[4,this.contextProvider.getContext()];case 1:return(a=p.sent()).authToken&&(o.Authorization="Bearer "+a.authToken),a.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=a.instanceIdToken),s=n.timeout||7e4,u=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new Dd("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(s),c=u.timer,h=u.promise,[4,Promise.race([Ud(c,this.postJSON(r,i,o)),h,Ud(c,this.cancelAllRequests)])];case 2:if(!(l=p.sent()))throw new Dd("cancelled","Firebase Functions instance was deleted.");if(f=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var a=e&&e.error;if(a){var s=a.status;if("string"==typeof s){if(!Ad[s])return new Dd("internal","internal");r=Ad[s],i=s}var u=a.message;"string"==typeof u&&(i=u),void 0!==(o=a.details)&&(o=n.decode(o))}}catch(t){}return"ok"===r?null:new Dd(r,i,o)}(l.status,l.json,this.serializer))throw f;if(!l.json)throw new Dd("internal","Response is not valid JSON object.");if(void 0===(d=l.json.data)&&(d=l.json.result),void 0===d)throw new Dd("internal","Response is missing data field.");return[2,{data:this.serializer.decode(d)}]}}))}))},t}();function Ud(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}Od=t.Z,xd=fetch.bind(self),Ld={Functions:Fd},Od.INTERNAL.registerComponent(new kd.wA("functions",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("messaging");return new Fd(r,i,o,n,xd)}),"PUBLIC").setServiceProps(Ld).setMultipleInstances(!0)),t.Z.registerVersion("@firebase/functions","0.6.7");var qd,jd=n(676),Vd="w:0.4.25",Bd=((qd={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',qd["not-registered"]="Firebase Installation is not registered.",qd["installation-not-found"]="Firebase Installation not found.",qd["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',qd["app-offline"]="Could not process request. Application offline.",qd["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",qd),Gd=new e.LL("installations","Installations",Bd);function Kd(t){return t instanceof e.ZR&&t.code.includes("request-failed")}function Wd(t){return"https://firebaseinstallations.googleapis.com/v1/projects/"+t.projectId+"/installations"}function Hd(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function zd(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),r=n.error,[2,Gd.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function Jd(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function Qd(t,e){var n=e.refreshToken,r=Jd(t);return r.append("Authorization",function(t){return"FIS_v2 "+t}(n)),r}function Yd(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}}))}))}function Xd(t,e){var n=e.fid;return(0,hr.mG)(this,void 0,void 0,(function(){var e,r,i,o,a,s;return(0,hr.Jh)(this,(function(u){switch(u.label){case 0:return e=Wd(t),r=Jd(t),i={fid:n,authVersion:"FIS_v2",appId:t.appId,sdkVersion:Vd},o={method:"POST",headers:r,body:JSON.stringify(i)},[4,Yd((function(){return fetch(e,o)}))];case 1:return(a=u.sent()).ok?[4,a.json()]:[3,3];case 2:return[2,{fid:(s=u.sent()).fid||n,registrationStatus:2,refreshToken:s.refreshToken,authToken:Hd(s.authToken)}];case 3:return[4,zd("Create Installation",a)];case 4:throw u.sent()}}))}))}function Zd(t){return new Promise((function(e){setTimeout(e,t)}))}var $d=/^[cdef][\w-]{21}$/;function tp(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return(e=t,btoa(String.fromCharCode.apply(String,(0,hr.ev)([],(0,hr.CR)(e)))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return $d.test(e)?e:""}catch(t){return""}}function ep(t){return t.appName+"!"+t.appId}var np=new Map;function rp(t,e){var n=ep(t);ip(n,e),function(t,e){var n=ap();n&&n.postMessage({key:t,fid:e}),sp()}(n,e)}function ip(t,e){var n,r,i=np.get(t);if(i)try{for(var o=(0,hr.XA)(i),a=o.next();!a.done;a=o.next())(0,a.value)(e)}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var op=null;function ap(){return!op&&"BroadcastChannel"in self&&((op=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){ip(t.data.key,t.data.fid)}),op}function sp(){0===np.size&&op&&(op.close(),op=null)}var up,cp="firebase-installations-store",hp=null;function lp(){return hp||(hp=(0,jd.openDb)("firebase-installations-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(cp)}}))),hp}function fp(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o,a;return(0,hr.Jh)(this,(function(s){switch(s.label){case 0:return n=ep(t),[4,lp()];case 1:return r=s.sent(),i=r.transaction(cp,"readwrite"),[4,(o=i.objectStore(cp)).get(n)];case 2:return a=s.sent(),[4,o.put(e,n)];case 3:return s.sent(),[4,i.complete];case 4:return s.sent(),a&&a.fid===e.fid||rp(t,e.fid),[2,e]}}))}))}function dp(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return e=ep(t),[4,lp()];case 1:return n=i.sent(),[4,(r=n.transaction(cp,"readwrite")).objectStore(cp).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function pp(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return(0,hr.Jh)(this,(function(u){switch(u.label){case 0:return n=ep(t),[4,lp()];case 1:return r=u.sent(),i=r.transaction(cp,"readwrite"),[4,(o=i.objectStore(cp)).get(n)];case 2:return a=u.sent(),void 0!==(s=e(a))?[3,4]:[4,o.delete(n)];case 3:return u.sent(),[3,6];case 4:return[4,o.put(s,n)];case 5:u.sent(),u.label=6;case 6:return[4,i.complete];case 7:return u.sent(),!s||a&&a.fid===s.fid||rp(t,s.fid),[2,s]}}))}))}function vp(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return[4,pp(t,(function(n){var r=function(t){return yp(t||{fid:tp(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(Gd.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,Xd(t,e)];case 1:return n=i.sent(),[2,fp(t,n)];case 2:return Kd(r=i.sent())&&409===r.customData.serverCode?[4,dp(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,fp(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}}))}))}(t,n)}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:gp(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry}))];case 1:return""!==(n=i.sent()).fid?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}}))}))}function gp(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n,r,i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return[4,mp(t)];case 1:e=o.sent(),o.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,Zd(100)];case 3:return o.sent(),[4,mp(t)];case 4:return e=o.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,vp(t)];case 6:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,e]}}))}))}function mp(t){return pp(t,(function(t){if(!t)throw Gd.create("installation-not-found");return yp(t)}))}function yp(t){return 1===(e=t).registrationStatus&&e.registrationTime+1e4<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}function bp(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return(0,hr.mG)(this,void 0,void 0,(function(){var t,i,o,a,s,u;return(0,hr.Jh)(this,(function(c){switch(c.label){case 0:return t=function(t,e){var n=e.fid;return Wd(t)+"/"+n+"/authTokens:generate"}(n,e),i=Qd(n,e),(o=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",o.getPlatformInfoString()),a={installation:{sdkVersion:Vd}},s={method:"POST",headers:i,body:JSON.stringify(a)},[4,Yd((function(){return fetch(t,s)}))];case 1:return(u=c.sent()).ok?[4,u.json()]:[3,3];case 2:return[2,Hd(c.sent())];case 3:return[4,zd("Generate Auth Token",u)];case 4:throw c.sent()}}))}))}function _p(t,e){return void 0===e&&(e=!1),(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return[4,pp(t.appConfig,(function(r){if(!Ip(r))throw Gd.create("not-registered");var i,o=r.authToken;if(!e&&(2===(i=o).requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+36e5}(i)))return r;if(1===o.requestStatus)return n=function(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return[4,wp(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,Zd(100)];case 3:return i.sent(),[4,wp(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,_p(t,e)]:[2,r]}}))}))}(t,e),r;if(!navigator.onLine)throw Gd.create("app-offline");var a=function(t){var e={requestStatus:1,requestTime:Date.now()};return(0,hr.pi)((0,hr.pi)({},t),{authToken:e})}(r);return n=function(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,bp(t,e)];case 1:return n=o.sent(),i=(0,hr.pi)((0,hr.pi)({},e),{authToken:n}),[4,fp(t.appConfig,i)];case 2:return o.sent(),[2,n];case 3:return!Kd(r=o.sent())||401!==r.customData.serverCode&&404!==r.customData.serverCode?[3,5]:[4,dp(t.appConfig)];case 4:return o.sent(),[3,7];case 5:return i=(0,hr.pi)((0,hr.pi)({},e),{authToken:{requestStatus:0}}),[4,fp(t.appConfig,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}}))}))}(t,a),a}))];case 1:return r=o.sent(),n?[4,n]:[3,3];case 2:return i=o.sent(),[3,4];case 3:i=r.authToken,o.label=4;case 4:return[2,i]}}))}))}function wp(t){return pp(t,(function(t){if(!Ip(t))throw Gd.create("not-registered");var e;return 1===(e=t.authToken).requestStatus&&e.requestTime+1e4<Date.now()?(0,hr.pi)((0,hr.pi)({},t),{authToken:{requestStatus:0}}):t}))}function Ip(t){return void 0!==t&&2===t.registrationStatus}function Tp(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return[4,vp(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}function Ep(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o;return(0,hr.Jh)(this,(function(a){switch(a.label){case 0:return n=function(t,e){var n=e.fid;return Wd(t)+"/"+n}(t,e),r=Qd(t,e),i={method:"DELETE",headers:r},[4,Yd((function(){return fetch(n,i)}))];case 1:return(o=a.sent()).ok?[3,3]:[4,zd("Delete Installation",o)];case 2:throw a.sent();case 3:return[2]}}))}))}function Sp(t){return Gd.create("missing-app-config-values",{valueName:t})}!function(t){t.INTERNAL.registerComponent(new kd.wA("installations",(function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw Sp("App Configuration");if(!t.name)throw Sp("App Name");try{for(var r=(0,hr.XA)(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!t.options[o])throw Sp(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){return function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return[4,vp(t.appConfig)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):_p(t).catch(console.error),[2,n.fid]}}))}))}(n)},getToken:function(t){return function(t,e){return void 0===e&&(e=!1),(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return[4,Tp(t.appConfig)];case 1:return n.sent(),[4,_p(t,e)];case 2:return[2,n.sent().token]}}))}))}(n,t)},delete:function(){return function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return[4,pp(e=t.appConfig,(function(t){if(!t||0!==t.registrationStatus)return t}))];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw Gd.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw Gd.create("app-offline");case 3:return[4,Ep(e,n)];case 4:return r.sent(),[4,dp(e)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}(n)},onIdChange:function(t){return function(t,e){var n=t.appConfig;return function(t,e){ap();var n=ep(t),r=np.get(n);r||(r=new Set,np.set(n,r)),r.add(e)}(n,e),function(){!function(t,e){var n=ep(t),r=np.get(n);r&&(r.delete(e),0===r.size&&np.delete(n),sp())}(n,e)}}(n,t)}}}),"PUBLIC")),t.registerVersion("@firebase/installations","0.4.25")}(t.Z);var Cp,kp=((up={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',up["only-available-in-window"]="This method is available in a Window context.",up["only-available-in-sw"]="This method is available in a service worker context.",up["permission-default"]="The notification permission was not granted and dismissed instead.",up["permission-blocked"]="The notification permission was not granted and blocked instead.",up["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",up["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",up["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",up["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",up["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",up["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",up["token-update-no-token"]="FCM returned no token when updating the user to push.",up["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",up["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",up["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",up["invalid-vapid-key"]="The public VAPID key must be a string.",up["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",up),Np=new e.LL("messaging","Messaging",kp),Ap="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4";function Dp(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,(0,hr.ev)([],(0,hr.CR)(e)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Pp(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}!function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"}(Cp||(Cp={}));var Rp="fcm_token_details_db",Op="fcm_token_object_Store";function xp(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n=this;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(!r.sent().map((function(t){return t.name})).includes(Rp))return[2,null];r.label=2;case 2:return e=null,[4,(0,jd.openDb)(Rp,5,(function(r){return(0,hr.mG)(n,void 0,void 0,(function(){var n,i,o,a;return(0,hr.Jh)(this,(function(s){switch(s.label){case 0:return r.oldVersion<2?[2]:r.objectStoreNames.contains(Op)?[4,(n=r.transaction.objectStore(Op)).index("fcmSenderId").get(t)]:[2];case 1:return i=s.sent(),[4,n.clear()];case 2:if(s.sent(),!i)return[2];if(2===r.oldVersion){if(!(o=i).auth||!o.p256dh||!o.endpoint)return[2];e={token:o.fcmToken,createTime:null!==(a=o.createTime)&&void 0!==a?a:Date.now(),subscriptionOptions:{auth:o.auth,p256dh:o.p256dh,endpoint:o.endpoint,swScope:o.swScope,vapidKey:"string"==typeof o.vapidKey?o.vapidKey:Dp(o.vapidKey)}}}else(3===r.oldVersion||4===r.oldVersion)&&(e={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:Dp(o.auth),p256dh:Dp(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:Dp(o.vapidKey)}});return[2]}}))}))}))];case 3:return r.sent().close(),[4,(0,jd.deleteDb)(Rp)];case 4:return r.sent(),[4,(0,jd.deleteDb)("fcm_vapid_details_db")];case 5:return r.sent(),[4,(0,jd.deleteDb)("undefined")];case 6:return r.sent(),[2,Lp(e)?e:null]}}))}))}function Lp(t){if(!t||!t.subscriptionOptions)return!1;var e=t.subscriptionOptions;return"number"==typeof t.createTime&&t.createTime>0&&"string"==typeof t.token&&t.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}var Mp="firebase-messaging-store",Fp=null;function Up(){return Fp||(Fp=(0,jd.openDb)("firebase-messaging-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(Mp)}}))),Fp}function qp(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return e=Bp(t),[4,Up()];case 1:return[4,i.sent().transaction(Mp).objectStore(Mp).get(e)];case 2:return(n=i.sent())?[2,n]:[3,3];case 3:return[4,xp(t.appConfig.senderId)];case 4:return(r=i.sent())?[4,jp(t,r)]:[3,6];case 5:return i.sent(),[2,r];case 6:return[2]}}))}))}function jp(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return n=Bp(t),[4,Up()];case 1:return r=o.sent(),[4,(i=r.transaction(Mp,"readwrite")).objectStore(Mp).put(e,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,e]}}))}))}function Vp(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return e=Bp(t),[4,Up()];case 1:return n=i.sent(),[4,(r=n.transaction(Mp,"readwrite")).objectStore(Mp).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function Bp(t){return t.appConfig.appId}function Gp(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return(0,hr.Jh)(this,(function(u){switch(u.label){case 0:return[4,zp(t)];case 1:n=u.sent(),r=Jp(e),i={method:"POST",headers:n,body:JSON.stringify(r)},u.label=2;case 2:return u.trys.push([2,5,,6]),[4,fetch(Hp(t.appConfig),i)];case 3:return[4,u.sent().json()];case 4:return o=u.sent(),[3,6];case 5:throw a=u.sent(),Np.create("token-subscribe-failed",{errorInfo:a});case 6:if(o.error)throw s=o.error.message,Np.create("token-subscribe-failed",{errorInfo:s});if(!o.token)throw Np.create("token-subscribe-no-token");return[2,o.token]}}))}))}function Kp(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return(0,hr.Jh)(this,(function(u){switch(u.label){case 0:return[4,zp(t)];case 1:n=u.sent(),r=Jp(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)},u.label=2;case 2:return u.trys.push([2,5,,6]),[4,fetch(Hp(t.appConfig)+"/"+e.token,i)];case 3:return[4,u.sent().json()];case 4:return o=u.sent(),[3,6];case 5:throw a=u.sent(),Np.create("token-update-failed",{errorInfo:a});case 6:if(o.error)throw s=o.error.message,Np.create("token-update-failed",{errorInfo:s});if(!o.token)throw Np.create("token-update-no-token");return[2,o.token]}}))}))}function Wp(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o,a;return(0,hr.Jh)(this,(function(s){switch(s.label){case 0:return[4,zp(t)];case 1:n=s.sent(),r={method:"DELETE",headers:n},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(Hp(t.appConfig)+"/"+e,r)];case 3:return[4,s.sent().json()];case 4:if((i=s.sent()).error)throw o=i.error.message,Np.create("token-unsubscribe-failed",{errorInfo:o});return[3,6];case 5:throw a=s.sent(),Np.create("token-unsubscribe-failed",{errorInfo:a});case 6:return[2]}}))}))}function Hp(t){return"https://fcmregistrations.googleapis.com/v1/projects/"+t.projectId+"/registrations"}function zp(t){var e=t.appConfig,n=t.installations;return(0,hr.mG)(this,void 0,void 0,(function(){var t;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return t=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}}))}))}function Jp(t){var e=t.p256dh,n=t.auth,r=t.endpoint,i=t.vapidKey,o={web:{endpoint:r,auth:n,p256dh:e}};return i!==Ap&&(o.web.applicationPubKey=i),o}function Qp(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r,i,o,a;return(0,hr.Jh)(this,(function(s){switch(s.label){case 0:if("granted"!==Notification.permission)throw Np.create("permission-blocked");return[4,$p(e,n)];case 1:return r=s.sent(),[4,qp(t)];case 2:return i=s.sent(),o={vapidKey:n,swScope:e.scope,endpoint:r.endpoint,auth:Dp(r.getKey("auth")),p256dh:Dp(r.getKey("p256dh"))},i?[3,3]:[2,Zp(t,o)];case 3:if(u=i.subscriptionOptions,h=(c=o).vapidKey===u.vapidKey,l=c.endpoint===u.endpoint,f=c.auth===u.auth,d=c.p256dh===u.p256dh,h&&l&&f&&d)return[3,8];s.label=4;case 4:return s.trys.push([4,6,,7]),[4,Wp(t,i.token)];case 5:return s.sent(),[3,7];case 6:return a=s.sent(),console.warn(a),[3,7];case 7:return[2,Zp(t,o)];case 8:return Date.now()>=i.createTime+6048e5?[2,Xp({token:i.token,createTime:Date.now(),subscriptionOptions:o},t,e)]:[2,i.token];case 9:return[2]}var u,c,h,l,f,d}))}))}function Yp(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return[4,qp(t)];case 1:return(n=i.sent())?[4,Wp(t,n.token)]:[3,4];case 2:return i.sent(),[4,Vp(t)];case 3:i.sent(),i.label=4;case 4:return[4,e.pushManager.getSubscription()];case 5:return(r=i.sent())?[2,r.unsubscribe()]:[2,!0]}}))}))}function Xp(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r,i,o;return(0,hr.Jh)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,5]),[4,Kp(e,t)];case 1:return r=a.sent(),i=(0,hr.pi)((0,hr.pi)({},t),{token:r,createTime:Date.now()}),[4,jp(e,i)];case 2:return a.sent(),[2,r];case 3:return o=a.sent(),[4,Yp(e,n)];case 4:throw a.sent(),o;case 5:return[2]}}))}))}function Zp(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return[4,Gp(t,e)];case 1:return n=i.sent(),r={token:n,createTime:Date.now(),subscriptionOptions:e},[4,jp(t,r)];case 2:return i.sent(),[2,r.token]}}))}))}function $p(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Pp(e)})]}}))}))}function tv(t){return"object"==typeof t&&!!t&&"google.c.a.c_id"in t}function ev(t){return new Promise((function(e){setTimeout(e,t)}))}var nv=function(){function t(t){var e=this;this.firebaseDependencies=t,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",(function(t){t.waitUntil(e.onPush(t))})),self.addEventListener("pushsubscriptionchange",(function(t){t.waitUntil(e.onSubChange(t))})),self.addEventListener("notificationclick",(function(t){t.waitUntil(e.onNotificationClick(t))}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.setBackgroundMessageHandler=function(t){if(this.isOnBackgroundMessageUsed=!1,!t||"function"!=typeof t)throw Np.create("invalid-bg-handler");this.bgMessageHandler=t},t.prototype.onBackgroundMessage=function(t){var e=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=t,function(){e.bgMessageHandler=null}},t.prototype.getToken=function(){var t,e;return(0,hr.mG)(this,void 0,void 0,(function(){var n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return this.vapidKey?[3,2]:[4,qp(this.firebaseDependencies)];case 1:n=r.sent(),this.vapidKey=null!==(e=null===(t=null==n?void 0:n.subscriptionOptions)||void 0===t?void 0:t.vapidKey)&&void 0!==e?e:Ap,r.label=2;case 2:return[2,Qp(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))},t.prototype.deleteToken=function(){return Yp(this.firebaseDependencies,self.registration)},t.prototype.requestPermission=function(){throw Np.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw Np.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw Np.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(){throw Np.create("only-available-in-window")},t.prototype.onMessage=function(){throw Np.create("only-available-in-window")},t.prototype.onTokenRefresh=function(){throw Np.create("only-available-in-window")},t.prototype.onPush=function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n,r,i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return(e=function(t){var e=t.data;if(!e)return null;try{return e.json()}catch(t){return null}}(t))?[4,av()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return function(t){return t.some((function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")}))}(n=o.sent())?[2,ov(n,e)]:(r=!1,e.notification?[4,sv(rv(e))]:[3,3]);case 2:o.sent(),r=!0,o.label=3;case 3:return!0===r&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(i=function(t){var e={from:t.from,collapseKey:t.collapse_key};return function(t,e){if(e.notification){t.notification={};var n=e.notification.title;n&&(t.notification.title=n);var r=e.notification.body;r&&(t.notification.body=r);var i=e.notification.image;i&&(t.notification.image=i)}}(e,t),function(t,e){e.data&&(t.data=e.data)}(e,t),function(t,e){if(e.fcmOptions){t.fcmOptions={};var n=e.fcmOptions.link;n&&(t.fcmOptions.link=n);var r=e.fcmOptions.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}}(e,t),e}(e),"function"==typeof this.bgMessageHandler?this.bgMessageHandler(i):this.bgMessageHandler.next(i)),[4,ev(1e3)]);case 4:return o.sent(),[2]}}))}))},t.prototype.onSubChange=function(t){var e,n;return(0,hr.mG)(this,void 0,void 0,(function(){var r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return t.newSubscription?[3,2]:[4,Yp(this.firebaseDependencies,self.registration)];case 1:return i.sent(),[2];case 2:return[4,qp(this.firebaseDependencies)];case 3:return r=i.sent(),[4,Yp(this.firebaseDependencies,self.registration)];case 4:return i.sent(),[4,Qp(this.firebaseDependencies,self.registration,null!==(n=null===(e=null==r?void 0:r.subscriptionOptions)||void 0===e?void 0:e.vapidKey)&&void 0!==n?n:Ap)];case 5:return i.sent(),[2]}}))}))},t.prototype.onNotificationClick=function(t){var e,n;return(0,hr.mG)(this,void 0,void 0,(function(){var r,i,o,a,s;return(0,hr.Jh)(this,(function(u){switch(u.label){case 0:return(r=null===(n=null===(e=t.notification)||void 0===e?void 0:e.data)||void 0===n?void 0:n.FCM_MSG)?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),(i=function(t){var e,n,r,i=null!==(n=null===(e=t.fcmOptions)||void 0===e?void 0:e.link)&&void 0!==n?n:null===(r=t.notification)||void 0===r?void 0:r.click_action;return i||(tv(t.data)?self.location.origin:null)}(r))?(o=new URL(i,self.location.href),a=new URL(self.location.origin),o.host!==a.host?[2]:[4,iv(o)]):[2]):[2];case 1:return(s=u.sent())?[3,4]:[4,self.clients.openWindow(i)];case 2:return s=u.sent(),[4,ev(3e3)];case 3:return u.sent(),[3,6];case 4:return[4,s.focus()];case 5:s=u.sent(),u.label=6;case 6:return s?(r.messageType=Cp.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,[2,s.postMessage(r)]):[2]}}))}))},t}();function rv(t){var e,n=(0,hr.pi)({},t.notification);return n.data=((e={}).FCM_MSG=t,e),n}function iv(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n,r,i,o,a,s;return(0,hr.Jh)(this,(function(u){switch(u.label){case 0:return[4,av()];case 1:e=u.sent();try{for(n=(0,hr.XA)(e),r=n.next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),t.host===o.host)return[2,i]}catch(t){a={error:t}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}return[2,null]}}))}))}function ov(t,e){var n,r;e.isFirebaseMessaging=!0,e.messageType=Cp.PUSH_RECEIVED;try{for(var i=(0,hr.XA)(t),o=i.next();!o.done;o=i.next())o.value.postMessage(e)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}function av(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function sv(t){var e,n=t.actions,r=Notification.maxActions;return n&&r&&n.length>r&&console.warn("This browser only supports "+r+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(e=t.title)&&void 0!==e?e:"",t)}var uv=function(){function t(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",(function(t){return e.messageEventListener(t)}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.messageEventListener=function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return(e=t.data).isFirebaseMessaging?(this.onMessageCallback&&e.messageType===Cp.PUSH_RECEIVED&&("function"==typeof this.onMessageCallback?this.onMessageCallback(function(t){return delete t.messageType,delete t.isFirebaseMessaging,t}(Object.assign({},e))):this.onMessageCallback.next(Object.assign({},e))),tv(n=e.data)&&"1"===n["google.c.a.e"]?[4,this.logEvent(e.messageType,n)]:[3,2]):[2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.getVapidKey=function(){return this.vapidKey},t.prototype.getSwReg=function(){return this.swRegistration},t.prototype.getToken=function(t){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){switch(e.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw Np.create("permission-blocked");return[4,this.updateVapidKey(null==t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null==t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,Qp(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}}))}))},t.prototype.updateVapidKey=function(t){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=Ap),[2]}))}))},t.prototype.updateSwReg=function(t){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){switch(e.label){case 0:return t||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw Np.create("invalid-sw-registration");return this.swRegistration=t,[2]}}))}))},t.prototype.registerDefaultSw=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t,e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=n.sent(),this.swRegistration.update().catch((function(){})),[3,3];case 2:throw e=n.sent(),Np.create("failed-service-worker-registration",{browserErrorMessage:e.message});case 3:return[2]}}))}))},t.prototype.deleteToken=function(){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(t){switch(t.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:t.sent(),t.label=2;case 2:return[2,Yp(this.firebaseDependencies,this.swRegistration)]}}))}))},t.prototype.requestPermission=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t;return(0,hr.Jh)(this,(function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?Np.create("permission-blocked"):Np.create("permission-default")}}))}))},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw Np.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw Np.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw Np.create("invalid-sw-registration");if(this.swRegistration)throw Np.create("use-sw-after-get-token");this.swRegistration=t},t.prototype.onMessage=function(t){var e=this;return this.onMessageCallback=t,function(){e.onMessageCallback=null}},t.prototype.setBackgroundMessageHandler=function(){throw Np.create("only-available-in-sw")},t.prototype.onBackgroundMessage=function(){throw Np.create("only-available-in-sw")},t.prototype.onTokenRefresh=function(){return function(){}},t.prototype.logEvent=function(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return n=function(t){switch(t){case Cp.NOTIFICATION_CLICKED:return"notification_open";case Cp.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return r.sent().logEvent(n,{message_id:e["google.c.a.c_id"],message_name:e["google.c.a.c_l"],message_time:e["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}}))}))},t}();function cv(t){return Np.create("missing-app-config-values",{valueName:t})}var hv={isSupported:lv};function lv(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}t.Z.INTERNAL.registerComponent(new kd.wA("messaging",(function(t){var e=t.getProvider("app").getImmediate(),n={app:e,appConfig:function(t){var e,n;if(!t||!t.options)throw cv("App Configuration Object");if(!t.name)throw cv("App Name");var r=t.options;try{for(var i=(0,hr.XA)(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var a=o.value;if(!r[a])throw cv(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e),installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!lv())throw Np.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new nv(n):new uv(n)}),"PUBLIC").setServiceProps(hv));var fv="firebasestorage.googleapis.com",dv=function(t){function e(n,r){var i=t.call(this,pv(n),"Firebase Storage: "+r+" ("+pv(n)+")")||this;return i.customData={serverResponse:null},i._baseMessage=i.message,Object.setPrototypeOf(i,e.prototype),i}return(0,hr.ZT)(e,t),e.prototype._codeEquals=function(t){return pv(t)===this.code},Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=this._baseMessage+"\n"+this.customData.serverResponse:this.message=this._baseMessage},enumerable:!1,configurable:!0}),e}(e.ZR);function pv(t){return"storage/"+t}function vv(){return new dv("unknown","An unknown error occurred, please check the error payload for server response.")}function gv(){return new dv("canceled","User canceled the upload/download.")}function mv(){return new dv("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function yv(t){return new dv("invalid-argument",t)}function bv(){return new dv("app-deleted","The Firebase app was deleted.")}function _v(t){return new dv("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function wv(t,e){return new dv("invalid-format","String does not match format '"+t+"': "+e)}function Iv(t){throw new dv("internal-error","Internal error: "+t)}var Tv={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Ev=function(t,e){this.data=t,this.contentType=e||null};function Sv(t,e){switch(t){case Tv.RAW:return new Ev(Cv(e));case Tv.BASE64:case Tv.BASE64URL:return new Ev(kv(t,e));case Tv.DATA_URL:return new Ev((n=new Av(e)).base64?kv(Tv.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(t){throw wv(Tv.DATA_URL,"Malformed data URL.")}return Cv(e)}(n.rest),new Av(e).contentType)}var n;throw vv()}function Cv(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?n<t.length-1&&56320==(64512&t.charCodeAt(n+1))?(r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function kv(t,e){switch(t){case Tv.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw wv(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case Tv.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw wv(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(e)}catch(e){throw wv(t,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var Nv,Av=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw wv(Tv.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n,r,i=e[1]||null;null!=i&&(this.base64=(r=";base64",(n=i).length>=r.length&&n.substring(n.length-r.length)===r),this.contentType=this.base64?i.substring(0,i.length-";base64".length):i),this.rest=t.substring(t.indexOf(",")+1)},Dv={STATE_CHANGED:"state_changed"},Pv={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Rv(t){switch(t){case"running":case"pausing":case"canceling":return Pv.RUNNING;case"paused":return Pv.PAUSED;case"success":return Pv.SUCCESS;case"canceled":return Pv.CANCELED;case"error":default:return Pv.ERROR}}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(Nv||(Nv={}));var Ov=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=Nv.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=Nv.ABORT,e(t)})),t.xhr_.addEventListener("error",(function(){t.errorCode_=Nv.NETWORK_ERROR,e(t)})),t.xhr_.addEventListener("load",(function(){e(t)}))}))}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw Iv("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw Iv("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw Iv("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw Iv("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)},t}(),xv=function(){function t(){}return t.prototype.createXhrIo=function(){return new Ov},t}(),Lv=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e,n){var r;try{r=t.makeFromUrl(e,n)}catch(n){return new t(e,"")}if(""===r.path)return r;throw new dv("invalid-default-bucket","Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e,n){var r=null,i="([A-Za-z0-9.\\-_]+)",o=new RegExp("^gs://"+i+"(/(.*))?$","i");function a(t){t.path_=decodeURIComponent(t.path)}for(var s=n.replace(/[.]/g,"\\."),u=[{regex:o,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+s+"/v[A-Za-z0-9_]+/b/"+i+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:a},{regex:new RegExp("^https?://"+(n===fv?"(?:storage.googleapis.com|storage.cloud.google.com)":n)+"/"+i+"/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:a}],c=0;c<u.length;c++){var h=u[c],l=h.regex.exec(e);if(l){var f=l[h.indices.bucket],d=l[h.indices.path];d||(d=""),r=new t(f,d),h.postModify(r);break}}if(null==r)throw function(t){return new dv("invalid-url","Invalid URL '"+t+"'.")}(e);return r},t}(),Mv=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}();function Fv(t){return"string"==typeof t||t instanceof String}function Uv(t){return qv()&&t instanceof Blob}function qv(){return"undefined"!=typeof Blob}function jv(t,e,n,r){if(r<e)throw yv("Invalid value for '"+t+"'. Expected "+e+" or greater.");if(r>n)throw yv("Invalid value for '"+t+"'. Expected "+n+" or less.")}function Vv(t,e){var n=e.match(/^(\w+):\/\/.+/),r=e;return null==(null==n?void 0:n[1])&&(r="https://"+e),r+"/v0"+t}function Bv(t){var e=encodeURIComponent,n="?";for(var r in t)t.hasOwnProperty(r)&&(n=n+(e(r)+"=")+e(t[r])+"&");return n.slice(0,-1)}var Gv=function(){function t(t,e,n,r,i,o,a,s,u,c,h){var l=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=h,this.promise_=new Promise((function(t,e){l.resolve_=t,l.reject_=e,l.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,a=n.xhr;if(n.wasSuccessCode)try{var s=t.callback_(a,a.getResponseText());!function(t){return void 0!==t}(s)?i():i(s)}catch(t){o(t)}else null!==a?((r=vv()).serverResponse=a.getResponseText(),t.errorCallback_?o(t.errorCallback_(a,r)):o(r)):n.canceled?o(r=t.appDelete_?bv():gv()):o(r=new dv("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new Kv(!1,null,!0)):this.backoffId_=function(e,n,r){var i=1,o=null,a=!1,s=0;function u(){return 2===s}var c=!1;function h(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];c||(c=!0,n.apply(null,t))}function l(e){o=setTimeout((function(){o=null,function(e,n){if(n)e(!1,new Kv(!1,null,!0));else{var r=t.pool_.createXhrIo();t.pendingXhr_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then((function(n){null!==t.progressCallback_&&n.removeUploadProgressListener(i),t.pendingXhr_=null;var r=(n=n).getErrorCode()===Nv.NO_ERROR,o=n.getStatus();if(r&&!t.isRetryStatusCode_(o)){var a=-1!==t.successCodes_.indexOf(o);e(!0,new Kv(a,n))}else{var s=n.getErrorCode()===Nv.ABORT;e(!1,new Kv(!1,null,s))}}))}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}}(f,u())}),e)}function f(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!c)if(t)h.call.apply(h,(0,hr.ev)([null,t],e));else{var r;u()||a?h.call.apply(h,(0,hr.ev)([null,t],e)):(i<64&&(i*=2),1===s?(s=2,r=0):r=1e3*(i+Math.random()),l(r))}}var d=!1;function p(t){d||(d=!0,c||(null!==o?(t||(s=2),clearTimeout(o),l(0)):t||(s=1)))}return l(0),setTimeout((function(){a=!0,p(!0)}),r),p}(0,e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function(t){t(!1)}(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),Kv=function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n};function Wv(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function Hv(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Wv();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(qv())return new Blob(t);throw new dv("unsupported-environment","This browser doesn't seem to support creating Blobs")}var zv=function(){function t(t,e){var n=0,r="";Uv(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(Uv(this.data_)){var r=(i=this.data_,o=e,a=n,i.webkitSlice?i.webkitSlice(o,a):i.mozSlice?i.mozSlice(o,a):i.slice?i.slice(o,a):null);return null===r?null:new t(r)}var i,o,a;return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(qv()){var r=e.map((function(e){return e instanceof t?e.data_:e}));return new t(Hv.apply(null,r))}var i=e.map((function(t){return Fv(t)?Sv(Tv.RAW,t).data:t.data_})),o=0;i.forEach((function(t){o+=t.byteLength}));var a=new Uint8Array(o),s=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]})),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}();function Jv(t){var e;try{e=JSON.parse(t)}catch(t){return null}return function(t){return"object"==typeof t&&!Array.isArray(t)}(e)?e:null}function Qv(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function Yv(t,e){return e}var Xv=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||Yv},Zv=null;function $v(){if(Zv)return Zv;var t=[];t.push(new Xv("bucket")),t.push(new Xv("generation")),t.push(new Xv("metageneration")),t.push(new Xv("name","fullPath",!0));var e=new Xv("name");e.xform=function(t,e){return function(t){return!Fv(t)||t.length<2?t:Qv(t)}(e)},t.push(e);var n=new Xv("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new Xv("timeCreated")),t.push(new Xv("updated")),t.push(new Xv("md5Hash",null,!0)),t.push(new Xv("cacheControl",null,!0)),t.push(new Xv("contentDisposition",null,!0)),t.push(new Xv("contentEncoding",null,!0)),t.push(new Xv("contentLanguage",null,!0)),t.push(new Xv("contentType",null,!0)),t.push(new Xv("metadata","customMetadata",!0)),Zv=t}function tg(t,e,n){var r=Jv(e);return null===r?null:function(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,r=t.fullPath,i=new Lv(n,r);return e._makeStorageReference(i)}})}(r,t),r}(t,r,n)}function eg(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}var ng=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function rg(t){if(!t)throw vv()}function ig(t,e){return function(n,r){var i=tg(t,r,e);return rg(null!==i),i}}function og(t){return function(e,n){var r,i,o;return 401===e.getStatus()?r=new dv("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(o=t.bucket,r=new dv("quota-exceeded","Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(i=t.path,r=new dv("unauthorized","User does not have permission to access '"+i+"'.")):r=n,r.serverResponse=n.serverResponse,r}}function ag(t){var e=og(t);return function(n,r){var i,o=e(n,r);return 404===n.getStatus()&&(i=t.path,o=new dv("object-not-found","Object '"+i+"' does not exist.")),o.serverResponse=r.serverResponse,o}}function sg(t,e,n){var r=Vv(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new ng(r,"GET",ig(t,n),i);return o.errorHandler=ag(e),o}function ug(t,e,n,r,i){var o={};e.isRoot?o.prefix="":o.prefix=e.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);var a=Vv(e.bucketOnlyServerUrl(),t.host),s=t.maxOperationRetryTime,u=new ng(a,"GET",function(t,e){return function(n,r){var i=function(t,e,n){var r=Jv(n);return null===r?null:function(t,e,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(var i=0,o=n.prefixes;i<o.length;i++){var a=o[i].replace(/\/$/,""),s=t._makeStorageReference(new Lv(e,a));r.prefixes.push(s)}if(n.items)for(var u=0,c=n.items;u<c.length;u++){var h=c[u];s=t._makeStorageReference(new Lv(e,h.name)),r.items.push(s)}return r}(t,e,r)}(t,e,r);return rg(null!==i),i}}(t,e.bucket),s);return u.urlParams=o,u.errorHandler=og(e),u}function cg(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return e&&e.type()||"application/octet-stream"}(0,e)),r}var hg=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function lg(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){rg(!1)}return rg(!!n&&-1!==(e||["active"]).indexOf(n)),n}var fg=262144;var dg=function(t,e,n){if(function(t){return"function"==typeof t}(t)||null!=e||null!=n)this.next=t,this.error=e,this.complete=n;else{var r=t;this.next=r.next,this.error=r.error,this.complete=r.complete}};function pg(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}var vg=function(){function t(t,e,n){var r=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=e,this._metadata=n,this._mappings=$v(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(t){r._request=void 0,r._chunkMultiplier=1,t._codeEquals("canceled")?(r._needToFetchStatus=!0,r.completeTransitions_()):(r._error=t,r._transition("error"))},this._metadataErrorHandler=function(t){r._request=void 0,t._codeEquals("canceled")?r.completeTransitions_():(r._error=t,r._transition("error"))},this._promise=new Promise((function(t,e){r._resolve=t,r._reject=e,r._start()})),this._promise.then(null,(function(){}))}return t.prototype._makeProgressCallback=function(){var t=this,e=this._transferred;return function(n){return t._updateProgress(e+n)}},t.prototype._shouldDoResumable=function(t){return t.size()>262144},t.prototype._start=function(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},t.prototype._resolveToken=function(t){var e=this;this._ref.storage._getAuthToken().then((function(n){switch(e._state){case"running":t(n);break;case"canceling":e._transition("canceled");break;case"pausing":e._transition("paused")}}))},t.prototype._createResumable=function(){var t=this;this._resolveToken((function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=cg(e,r,i),s={name:a.fullPath},u=Vv(o,t.host),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},h=eg(a,n),l=t.maxUploadRetryTime,f=new ng(u,"POST",(function(t){var e;lg(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){rg(!1)}return rg(Fv(e)),e}),l);return f.urlParams=s,f.headers=c,f.body=h,f.errorHandler=og(e),f}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),r=t._ref.storage._makeRequest(n,e);t._request=r,r.getPromise().then((function(e){t._request=void 0,t._uploadUrl=e,t._needToFetchStatus=!1,t.completeTransitions_()}),t._errorHandler)}))},t.prototype._fetchStatus=function(){var t=this,e=this._uploadUrl;this._resolveToken((function(n){var r=function(t,e,n,r){var i=t.maxUploadRetryTime,o=new ng(n,"POST",(function(t){var e=lg(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){rg(!1)}n||rg(!1);var i=Number(n);return rg(!isNaN(i)),new hg(i,r.size(),"final"===e)}),i);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=og(e),o}(t._ref.storage,t._ref._location,e,t._blob),i=t._ref.storage._makeRequest(r,n);t._request=i,i.getPromise().then((function(e){e=e,t._request=void 0,t._updateProgress(e.current),t._needToFetchStatus=!1,e.finalized&&(t._needToFetchMetadata=!0),t.completeTransitions_()}),t._errorHandler)}))},t.prototype._continueUpload=function(){var t=this,e=fg*this._chunkMultiplier,n=new hg(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((function(i){var o;try{o=function(t,e,n,r,i,o,a,s){var u=new hg(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new dv("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,h=c;i>0&&(h=Math.min(h,i));var l=u.current,f=l+h,d={"X-Goog-Upload-Command":h===c?"upload, finalize":"upload","X-Goog-Upload-Offset":u.current},p=r.slice(l,f);if(null===p)throw mv();var v=e.maxUploadRetryTime,g=new ng(n,"POST",(function(t,n){var i,a=lg(t,["active","final"]),s=u.current+h,c=r.size();return i="final"===a?ig(e,o)(t,n):null,new hg(s,c,"final"===a,i)}),v);return g.headers=d,g.body=p.uploadData(),g.progressCallback=s||null,g.errorHandler=og(t),g}(t._ref._location,t._ref.storage,r,t._blob,e,t._mappings,n,t._makeProgressCallback())}catch(e){return t._error=e,void t._transition("error")}var a=t._ref.storage._makeRequest(o,i);t._request=a,a.getPromise().then((function(e){t._increaseMultiplier(),t._request=void 0,t._updateProgress(e.current),e.finalized?(t._metadata=e.metadata,t._transition("success")):t.completeTransitions_()}),t._errorHandler)}))},t.prototype._increaseMultiplier=function(){fg*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},t.prototype._fetchMetadata=function(){var t=this;this._resolveToken((function(e){var n=sg(t._ref.storage,t._ref._location,t._mappings),r=t._ref.storage._makeRequest(n,e);t._request=r,r.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._transition("success")}),t._metadataErrorHandler)}))},t.prototype._oneShotUpload=function(){var t=this;this._resolveToken((function(e){var n=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();a["Content-Type"]="multipart/related; boundary="+s;var u=cg(e,r,i),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+eg(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",h="\r\n--"+s+"--",l=zv.getBlob(c,r,h);if(null===l)throw mv();var f={name:u.fullPath},d=Vv(o,t.host),p=t.maxUploadRetryTime,v=new ng(d,"POST",ig(t,n),p);return v.urlParams=f,v.headers=a,v.body=l.uploadData(),v.errorHandler=og(e),v}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),r=t._ref.storage._makeRequest(n,e);t._request=r,r.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._updateProgress(t._blob.size()),t._transition("success")}),t._errorHandler)}))},t.prototype._updateProgress=function(t){var e=this._transferred;this._transferred=t,this._transferred!==e&&this._notifyObservers()},t.prototype._transition=function(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request&&this._request.cancel();break;case"running":var e="paused"===this._state;this._state=t,e&&(this._notifyObservers(),this._start());break;case"paused":this._state=t,this._notifyObservers();break;case"canceled":this._error=gv(),this._state=t,this._notifyObservers();break;case"error":case"success":this._state=t,this._notifyObservers()}},t.prototype.completeTransitions_=function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=Rv(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,r){var i=this,o=new dg(e,n,r);return this._addObserver(o),function(){i._removeObserver(o)}},t.prototype.then=function(t,e){return this._promise.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype._addObserver=function(t){this._observers.push(t),this._notifyObserver(t)},t.prototype._removeObserver=function(t){var e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,1)},t.prototype._notifyObservers=function(){var t=this;this._finishPromise(),this._observers.slice().forEach((function(e){t._notifyObserver(e)}))},t.prototype._finishPromise=function(){if(void 0!==this._resolve){var t=!0;switch(Rv(this._state)){case Pv.SUCCESS:pg(this._resolve.bind(null,this.snapshot))();break;case Pv.CANCELED:case Pv.ERROR:pg(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}},t.prototype._notifyObserver=function(t){switch(Rv(this._state)){case Pv.RUNNING:case Pv.PAUSED:t.next&&pg(t.next.bind(t,this.snapshot))();break;case Pv.SUCCESS:t.complete&&pg(t.complete.bind(t))();break;case Pv.CANCELED:case Pv.ERROR:t.error&&pg(t.error.bind(t,this._error))();break;default:t.error&&pg(t.error.bind(t,this._error))()}},t.prototype.resume=function(){var t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t},t.prototype.pause=function(){var t="running"===this._state;return t&&this._transition("pausing"),t},t.prototype.cancel=function(){var t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t},t}(),gg=function(){function t(t,e){this._service=t,this._location=e instanceof Lv?e:Lv.makeFromUrl(e,t.host)}return t.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},t.prototype._newRef=function(e,n){return new t(e,n)},Object.defineProperty(t.prototype,"root",{get:function(){var t=new Lv(this._location.bucket,"");return this._newRef(this._service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return Qv(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;var n=new Lv(this._location.bucket,e);return new t(this._service,n)},enumerable:!1,configurable:!0}),t.prototype._throwIfRoot=function(t){if(""===this._location.path)throw _v(t)},t}();function mg(t){var e={prefixes:[],items:[]};return yg(t,e).then((function(){return e}))}function yg(t,e,n){return(0,hr.mG)(this,void 0,void 0,(function(){var r,i,o;return(0,hr.Jh)(this,(function(a){switch(a.label){case 0:return[4,bg(t,{pageToken:n})];case 1:return r=a.sent(),(i=e.prefixes).push.apply(i,r.prefixes),(o=e.items).push.apply(o,r.items),null==r.nextPageToken?[3,3]:[4,yg(t,e,r.nextPageToken)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function bg(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return null!=e&&"number"==typeof e.maxResults&&jv("options.maxResults",1,1e3,e.maxResults),[4,t.storage._getAuthToken()];case 1:return n=o.sent(),r=e||{},i=ug(t.storage,t._location,"/",r.pageToken,r.maxResults),[2,t.storage._makeRequest(i,n).getPromise()]}}))}))}function _g(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("getDownloadURL"),[4,t.storage._getAuthToken()];case 1:return e=r.sent(),n=function(t,e,n){var r=Vv(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new ng(r,"GET",function(t,e){return function(n,r){var i=tg(t,r,e);return rg(null!==i),function(t,e,n){var r=Jv(e);if(null===r)return null;if(!Fv(r.downloadTokens))return null;var i=r.downloadTokens;if(0===i.length)return null;var o=encodeURIComponent;return i.split(",").map((function(e){var r=t.bucket,i=t.fullPath;return Vv("/b/"+o(r)+"/o/"+o(i),n)+Bv({alt:"media",token:e})}))[0]}(i,r,t.host)}}(t,n),i);return o.errorHandler=ag(e),o}(t.storage,t._location,$v()),[2,t.storage._makeRequest(n,e).getPromise().then((function(t){if(null===t)throw new dv("no-download-url","The given file does not have any download URLs.");return t}))]}}))}))}function wg(t,e){var n=function(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),r=new Lv(t._location.bucket,n);return new gg(t.storage,r)}function Ig(t){return/^[A-Za-z]+:\/\//.test(t)}function Tg(t,e){if(t instanceof Cg){var n=t;if(null==n._bucket)throw new dv("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");var r=new gg(n,n._bucket);return null!=e?Tg(r,e):r}if(void 0!==e){if(e.includes(".."))throw yv('`path` param cannot contain ".."');return wg(t,e)}return t}function Eg(t,e){if(e&&Ig(e)){if(t instanceof Cg)return new gg(t,e);throw yv("To use ref(service, url), the first argument must be a Storage instance.")}return Tg(t,e)}function Sg(t,e){var n=null==e?void 0:e.storageBucket;return null==n?null:Lv.makeFromBucketSpec(n,t)}var Cg=function(){function t(t,e,n,r,i){this.app=t,this._authProvider=e,this._pool=n,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=fv,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?Lv.makeFromBucketSpec(r,this._host):Sg(this._host,this.app.options)}return Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){this._host=t,null!=this._url?this._bucket=Lv.makeFromBucketSpec(this._url,t):this._bucket=Sg(t,this.app.options)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(t){jv("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(t){jv("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t},enumerable:!1,configurable:!0}),t.prototype._getAuthToken=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t,e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return(t=this._authProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}}))}))},t.prototype._delete=function(){return this._deleted=!0,this._requests.forEach((function(t){return t.cancel()})),this._requests.clear(),Promise.resolve()},t.prototype._makeStorageReference=function(t){return new gg(this,t)},t.prototype._makeRequest=function(t,e){var n=this;if(this._deleted)return new Mv(bv());var r=function(t,e,n,r,i){var o=Bv(t.urlParams),a=t.url+o,s=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(s,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(s,n),function(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(s,i),new Gv(a,t.method,s,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r)}(t,this._appId,e,this._pool,this._firebaseVersion);return this._requests.add(r),r.getPromise().then((function(){return n._requests.delete(r)}),(function(){return n._requests.delete(r)})),r},t}();function kg(t,n){return Eg(t=(0,e.m9)(t),n)}var Ng=function(){function t(t,e,n){this._delegate=t,this.task=e,this.ref=n}return Object.defineProperty(t.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),t}(),Ag=function(){function t(t,e){this._delegate=t,this._ref=e,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}return Object.defineProperty(t.prototype,"snapshot",{get:function(){return new Ng(this._delegate.snapshot,this,this._ref)},enumerable:!1,configurable:!0}),t.prototype.then=function(t,e){var n=this;return this._delegate.then((function(e){if(t)return t(new Ng(e,n,n._ref))}),e)},t.prototype.on=function(t,e,n,r){var i=this,o=void 0;return e&&(o="function"==typeof e?function(t){return e(new Ng(t,i,i._ref))}:{next:e.next?function(t){return e.next(new Ng(t,i,i._ref))}:void 0,complete:e.complete||void 0,error:e.error||void 0}),this._delegate.on(t,o,n||void 0,r||void 0)},t}(),Dg=function(){function t(t,e){this._delegate=t,this._service=e}return Object.defineProperty(t.prototype,"prefixes",{get:function(){var t=this;return this._delegate.prefixes.map((function(e){return new Pg(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this;return this._delegate.items.map((function(e){return new Pg(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),t}(),Pg=function(){function t(t,e){this._delegate=t,this.storage=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._delegate.toString()},t.prototype.child=function(e){return new t(function(t,e){return wg(t,e)}(this._delegate,e),this.storage)},Object.defineProperty(t.prototype,"root",{get:function(){return new t(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return null==e?null:new t(e,this.storage)},enumerable:!1,configurable:!0}),t.prototype.put=function(t,n){return this._throwIfRoot("put"),new Ag(function(t,n,r){return function(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new vg(t,new zv(e),n)}(t=(0,e.m9)(t),n,r)}(this._delegate,t,n),this)},t.prototype.putString=function(t,e,n){void 0===e&&(e=Tv.RAW),this._throwIfRoot("putString");var r=Sv(e,t),i=(0,hr.pi)({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new Ag(new vg(this._delegate,new zv(r.data,!0),i),this)},t.prototype.listAll=function(){var t=this;return function(t){return mg(t=(0,e.m9)(t))}(this._delegate).then((function(e){return new Dg(e,t.storage)}))},t.prototype.list=function(t){var n=this;return function(t,n){return bg(t=(0,e.m9)(t),n)}(this._delegate,t||void 0).then((function(t){return new Dg(t,n.storage)}))},t.prototype.getMetadata=function(){return function(t){return function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("getMetadata"),[4,t.storage._getAuthToken()];case 1:return e=r.sent(),n=sg(t.storage,t._location,$v()),[2,t.storage._makeRequest(n,e).getPromise()]}}))}))}(t=(0,e.m9)(t))}(this._delegate)},t.prototype.updateMetadata=function(t){return function(t,n){return function(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return t._throwIfRoot("updateMetadata"),[4,t.storage._getAuthToken()];case 1:return n=i.sent(),r=function(t,e,n,r){var i=Vv(e.fullServerUrl(),t.host),o=eg(n,r),a=t.maxOperationRetryTime,s=new ng(i,"PATCH",ig(t,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=ag(e),s}(t.storage,t._location,e,$v()),[2,t.storage._makeRequest(r,n).getPromise()]}}))}))}(t=(0,e.m9)(t),n)}(this._delegate,t)},t.prototype.getDownloadURL=function(){return function(t){return _g(t=(0,e.m9)(t))}(this._delegate)},t.prototype.delete=function(){return this._throwIfRoot("delete"),function(t){return function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("deleteObject"),[4,t.storage._getAuthToken()];case 1:return e=r.sent(),n=function(t,e){var n=Vv(e.fullServerUrl(),t.host),r=t.maxOperationRetryTime,i=new ng(n,"DELETE",(function(t,e){}),r);return i.successCodes=[200,204],i.errorHandler=ag(e),i}(t.storage,t._location),[2,t.storage._makeRequest(n,e).getPromise()]}}))}))}(t=(0,e.m9)(t))}(this._delegate)},t.prototype._throwIfRoot=function(t){if(""===this._delegate._location.path)throw _v(t)},t}(),Rg=function(){function t(t,e){var n=this;this.app=t,this._delegate=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),t.prototype.ref=function(t){if(Ig(t))throw yv("ref() expected a child path but got a URL, use refFromURL instead.");return new Pg(kg(this._delegate,t),this)},t.prototype.refFromURL=function(t){if(!Ig(t))throw yv("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Lv.makeFromUrl(t,this._delegate.host)}catch(t){throw yv("refFromUrl() expected a valid full URL but got an invalid one.")}return new Pg(kg(this._delegate,t),this)},t.prototype.setMaxUploadRetryTime=function(t){this._delegate.maxUploadRetryTime=t},t.prototype.setMaxOperationRetryTime=function(t){this._delegate.maxOperationRetryTime=t},t.prototype.useEmulator=function(t,e){!function(t,e,n){t.host="http://"+e+":"+n}(this._delegate,t,e)},t}();function Og(e,n){var r=n.instanceIdentifier,i=e.getProvider("app").getImmediate(),o=e.getProvider("auth-internal");return new Rg(i,new Cg(i,o,new xv,r,t.Z.SDK_VERSION))}!function(t){var e={TaskState:Pv,TaskEvent:Dv,StringFormat:Tv,Storage:Cg,Reference:Pg};t.INTERNAL.registerComponent(new kd.wA("storage",Og,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage","0.5.1")}(t.Z);var xg,Lg,Mg,Fg="0.4.11",Ug=Fg,qg="FB-PERF-TRACE-MEASURE",jg="_wt_",Vg="_fcp",Bg="_fid",Gg="@firebase/performance/config",Kg="@firebase/performance/configexpire",Wg="Performance",Hg=((xg={})["trace started"]="Trace {$traceName} was started before.",xg["trace stopped"]="Trace {$traceName} is not running.",xg["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",xg["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",xg["no window"]="Window is not available.",xg["no app id"]="App id is not available.",xg["no project id"]="Project id is not available.",xg["no api key"]="Api key is not available.",xg["invalid cc log"]="Attempted to queue invalid cc event",xg["FB not default"]="Performance can only start when Firebase app instance is the default one.",xg["RC response not ok"]="RC response is not ok",xg["invalid attribute name"]="Attribute name {$attributeName} is invalid.",xg["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",xg["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",xg["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",xg),zg=new e.LL("performance",Wg,Hg),Jg=new r.Yd(Wg);Jg.logLevel=r.in.INFO;var Qg,Yg=function(){function t(t){if(this.window=t,!t)throw zg.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!(0,e.hl)()||(Jg.info("IndexedDB is not supported by current browswer"),!1):(Jg.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver((function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];e(i)}})).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===Lg&&(Lg=new t(Mg)),Lg},t}();function Xg(t,e){var n=t.length-e.length;if(n<0||n>1)throw zg.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}var Zg,$g,tm=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Xg("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Xg("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw zg.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw zg.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw zg.create("no api key");return t},t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===Qg&&(Qg=new t),Qg},t}();function em(){return Zg}!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"}($g||($g={}));var nm=["firebase_","google_","ga_"],rm=new RegExp("^[a-zA-Z]\\w*$");function im(){var t=Yg.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function om(){switch(Yg.getInstance().document.visibilityState){case"visible":return $g.VISIBLE;case"hidden":return $g.HIDDEN;default:return $g.UNKNOWN}}function am(){var t=Yg.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}var sm="Could not fetch config, will use default configs";function um(t){if(!t)return t;var e=tm.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=true,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=cm(e.tracesSamplingRate),e.logNetworkAfterSampling=cm(e.networkRequestsSamplingRate),t}function cm(t){return Math.random()<=t}var hm,lm=1;function fm(){return lm=2,hm=hm||function(){var t=Yg.getInstance().document;return new Promise((function(e){if(t&&"complete"!==t.readyState){var n=function(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()}))}().then((function(){return(t=tm.getInstance().installationsService.getId()).then((function(t){Zg=t})),t;var t})).then((function(t){return function(t){var e=function(){var t=Yg.getInstance().localStorage;if(t){var e=t.getItem(Kg);if(e&&Number(e)>Date.now()){var n=t.getItem(Gg);if(n)try{return JSON.parse(n)}catch(t){return}}}}();return e?(um(e),Promise.resolve()):function(t){return(e=tm.getInstance().installationsService.getToken(),e.then((function(t){})),e).then((function(e){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+tm.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+tm.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:"FIREBASE_INSTALLATIONS_AUTH "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:tm.getInstance().getAppId(),app_version:Ug,sdk_version:"0.0.1"})});return fetch(r).then((function(t){if(t.ok)return t.json();throw zg.create("RC response not ok")}))})).catch((function(){Jg.info(sm)}));var e}(t).then(um).then((function(t){return function(t){var e=Yg.getInstance().localStorage;t&&e&&(e.setItem(Gg,JSON.stringify(t)),e.setItem(Kg,String(Date.now()+60*tm.getInstance().configTimeToLive*60*1e3)))}(t)}),(function(){}))}(t)})).then((function(){return dm()}),(function(){return dm()}))}function dm(){lm=3}var pm,vm=1e4,gm=3,mm=[],ym=!1;function bm(t){setTimeout((function(){var t,e;if(0!==gm)return mm.length?(e=(t=mm.splice(0,1e3)).map((function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}})),void function(t,e){return function(t){var e=tm.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then((function(t){return t.ok||Jg.info("Call to Firebase backend failed."),t.json()})).then((function(t){var n=Number(t.nextRequestWaitMillis),r=vm;isNaN(n)||(r=Math.max(n,r));var i=t.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(mm=(0,hr.ev)((0,hr.ev)([],e),mm),Jg.info("Retry transport request later.")),gm=3,bm(r)}))}({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:tm.getInstance().logSource,log_event:e},t).catch((function(){mm=(0,hr.ev)((0,hr.ev)([],t),mm),gm--,Jg.info("Tries left: "+gm+"."),bm(vm)}))):bm(vm)}),t)}function _m(t){if(!t.eventTime||!t.message)throw zg.create("invalid cc log");mm=(0,hr.ev)((0,hr.ev)([],mm),[t])}function wm(t,e){pm||(pm=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];_m({message:t.apply(void 0,e),eventTime:Date.now()})}}(Em)),pm(t,e)}function Im(t){var e=tm.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&Yg.getInstance().requiredApisAvailable()&&(t.isAuto&&om()!==$g.VISIBLE||(3===lm?Tm(t):fm().then((function(){return Tm(t)}),(function(){return Tm(t)}))))}function Tm(t){if(em()){var e=tm.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout((function(){return wm(t,1)}),0)}}function Em(t,e){return 0===e?(r={url:(n=t).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},i={application_info:Sm(),network_request_metric:r},JSON.stringify(i)):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:Sm(),trace_metric:e};return JSON.stringify(r)}(t);var n,r,i}function Sm(){return{google_app_id:tm.getInstance().getAppId(),app_instance_id:em(),web_app_info:{sdk_version:Ug,page_url:Yg.getInstance().getUrl(),service_worker_status:im(),visibility_state:om(),effective_connection_type:am()},application_process_state:0}}var Cm=["_fp",Vg,Bg],km=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=Yg.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||"FB-PERF-TRACE-MEASURE-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw zg.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw zg.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Im(this)},t.prototype.record=function(t,e,n){if(t<=0)throw zg.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw zg.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=(0,hr.pi)({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}Im(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(i=t,o=this.name,0===i.length||i.length>100||!(o&&o.startsWith(jg)&&Cm.indexOf(i)>-1)&&i.startsWith("_"))throw zg.create("invalid custom metric name",{customMetricName:t});var n,r,i,o;this.counters[t]=(n=e,(r=Math.floor(n))<n&&Jg.info("Metric value should be an Integer, setting the value as : "+r+"."),r)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n,r=!(0===(n=t).length||n.length>40||nm.some((function(t){return n.startsWith(t)}))||!n.match(rm)),i=function(t){return 0!==t.length&&t.length<=100}(e);if(r&&i)this.customAttributes[t]=e;else{if(!r)throw zg.create("invalid attribute name",{attributeName:t});if(!i)throw zg.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return(0,hr.pi)({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r){var i=Yg.getInstance().getUrl();if(i){var o=new t(jg+i,!0),a=Math.floor(1e3*Yg.getInstance().getTimeOrigin());if(o.setStartTime(a),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd))),n){var s=n.find((function(t){return"first-paint"===t.name}));s&&s.startTime&&o.putMetric("_fp",Math.floor(1e3*s.startTime));var u=n.find((function(t){return"first-contentful-paint"===t.name}));u&&u.startTime&&o.putMetric(Vg,Math.floor(1e3*u.startTime)),r&&o.putMetric(Bg,Math.floor(1e3*r))}Im(o)}},t.createUserTimingTrace=function(e){Im(new t(e,!1,e))},t}();function Nm(t){var e=t;if(e&&void 0!==e.responseStart){var n=Yg.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){var e=tm.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout((function(){return wm(t,0)}),0)}}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}}function Am(){em()&&(setTimeout((function(){return function(){var t=Yg.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout((function(){km.createOobTrace(e,n),r=void 0}),5e3);t.onFirstInputDelay((function(t){r&&(clearTimeout(r),km.createOobTrace(e,n,t))}))}else km.createOobTrace(e,n)}()}),0),setTimeout((function(){return function(){for(var t=Yg.getInstance(),e=0,n=t.getEntriesByType("resource");e<n.length;e++)Nm(n[e]);t.setupObserver("resource",Nm)}()}),0),setTimeout((function(){return function(){for(var t=Yg.getInstance(),e=0,n=t.getEntriesByType("measure");e<n.length;e++)Dm(n[e]);t.setupObserver("measure",Dm)}()}),0))}function Dm(t){var e=t.name;e.substring(0,qg.length)!==qg&&km.createUserTimingTrace(e)}var Pm=function(){function t(t){this.app=t,Yg.getInstance().requiredApisAvailable()&&(0,e.eu)().then((function(t){t&&(ym||(bm(5500),ym=!0),fm().then(Am,Am))})).catch((function(t){Jg.info("Environment doesn't support IndexedDB: "+t)}))}return t.prototype.trace=function(t){return new km(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return tm.getInstance().instrumentationEnabled},set:function(t){tm.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return tm.getInstance().dataCollectionEnabled},set:function(t){tm.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();!function(t){t.INTERNAL.registerComponent(new kd.wA("performance",(function(t){return function(t,e){if("[DEFAULT]"!==t.name)throw zg.create("FB not default");if("undefined"==typeof window)throw zg.create("no window");return function(t){Mg=t}(window),tm.getInstance().firebaseAppInstance=t,tm.getInstance().installationsService=e,new Pm(t)}(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC")),t.registerVersion("@firebase/performance",Fg)}(t.Z);var Rm,Om,xm="https://www.googletagmanager.com/gtag/js";!function(t){t.EVENT="event",t.SET="set",t.CONFIG="config"}(Rm||(Rm={})),function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"}(Om||(Om={}));var Lm,Mm=new r.Yd("@firebase/analytics");function Fm(t,e,n,r,i,o){return(0,hr.mG)(this,void 0,void 0,(function(){var a,s,u,c;return(0,hr.Jh)(this,(function(h){switch(h.label){case 0:a=r[i],h.label=1;case 1:return h.trys.push([1,7,,8]),a?[4,e[a]]:[3,3];case 2:return h.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return s=h.sent(),(u=s.find((function(t){return t.measurementId===i})))?[4,e[u.appId]]:[3,6];case 5:h.sent(),h.label=6;case 6:return[3,8];case 7:return c=h.sent(),Mm.error(c),[3,8];case 8:return t(Rm.CONFIG,i,o),[2]}}))}))}function Um(t,e,n,r,i){return(0,hr.mG)(this,void 0,void 0,(function(){var o,a,s,u,c,h,l,f;return(0,hr.Jh)(this,(function(d){switch(d.label){case 0:return d.trys.push([0,4,,5]),o=[],i&&i.send_to?(a=i.send_to,Array.isArray(a)||(a=[a]),[4,Promise.all(n)]):[3,2];case 1:for(s=d.sent(),u=function(t){var n=s.find((function(e){return e.measurementId===t})),r=n&&e[n.appId];if(!r)return o=[],"break";o.push(r)},c=0,h=a;c<h.length&&(l=h[c],"break"!==u(l));c++);d.label=2;case 2:return 0===o.length&&(o=Object.values(e)),[4,Promise.all(o)];case 3:return d.sent(),t(Rm.EVENT,r,i||{}),[3,5];case 4:return f=d.sent(),Mm.error(f),[3,5];case 5:return[2]}}))}))}var qm=((Lm={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",Lm["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",Lm["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",Lm["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",Lm["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",Lm["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",Lm["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",Lm["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',Lm["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',Lm),jm=new e.LL("analytics","Analytics",qm),Vm=new(function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=1e3),this.throttleMetadata=t,this.intervalMillis=e}return t.prototype.getThrottleMetadata=function(t){return this.throttleMetadata[t]},t.prototype.setThrottleMetadata=function(t,e){this.throttleMetadata[t]=e},t.prototype.deleteThrottleMetadata=function(t){delete this.throttleMetadata[t]},t}());function Bm(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}function Gm(t){var e;return(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return(0,hr.Jh)(this,(function(c){switch(c.label){case 0:return n=t.appId,r=t.apiKey,i={method:"GET",headers:Bm(r)},o="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),[4,fetch(o,i)];case 1:if(200===(a=c.sent()).status||304===a.status)return[3,6];s="",c.label=2;case 2:return c.trys.push([2,4,,5]),[4,a.json()];case 3:return u=c.sent(),(null===(e=u.error)||void 0===e?void 0:e.message)&&(s=u.error.message),[3,5];case 4:return c.sent(),[3,5];case 5:throw jm.create("config-fetch-failed",{httpStatus:a.status,responseMessage:s});case 6:return[2,a.json()]}}))}))}function Km(t,n,r,i){var o=n.throttleEndTimeMillis,a=n.backoffCount;return void 0===i&&(i=Vm),(0,hr.mG)(this,void 0,void 0,(function(){var n,s,u,c,h,l,f;return(0,hr.Jh)(this,(function(d){switch(d.label){case 0:n=t.appId,s=t.measurementId,d.label=1;case 1:return d.trys.push([1,3,,4]),[4,Wm(r,o)];case 2:return d.sent(),[3,4];case 3:if(u=d.sent(),s)return Mm.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+u.message+"]"),[2,{appId:n,measurementId:s}];throw u;case 4:return d.trys.push([4,6,,7]),[4,Gm(t)];case 5:return c=d.sent(),i.deleteThrottleMetadata(n),[2,c];case 6:if(!function(t){if(!(t instanceof e.ZR&&t.customData))return!1;var n=Number(t.customData.httpStatus);return 429===n||500===n||503===n||504===n}(h=d.sent())){if(i.deleteThrottleMetadata(n),s)return Mm.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+h.message+"]"),[2,{appId:n,measurementId:s}];throw h}return l=503===Number(h.customData.httpStatus)?(0,e.$s)(a,i.intervalMillis,30):(0,e.$s)(a,i.intervalMillis),f={throttleEndTimeMillis:Date.now()+l,backoffCount:a+1},i.setThrottleMetadata(n,f),Mm.debug("Calling attemptFetch again in "+l+" millis"),[2,Km(t,f,r,i)];case 7:return[2]}}))}))}function Wm(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(jm.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var Hm=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}();var zm,Jm,Qm={},Ym=[],Xm={},Zm="dataLayer",$m="gtag",ty=!1;function ey(t){if(ty)throw jm.create("already-initialized");t.dataLayerName&&(Zm=t.dataLayerName),t.gtagName&&($m=t.gtagName)}function ny(t,n){!function(){var t=[];if((0,e.ru)()&&t.push("This is a browser extension environment."),(0,e.zI)()||t.push("Cookies are not available."),t.length>0){var n=t.map((function(t,e){return"("+(e+1)+") "+t})).join(" "),r=jm.create("invalid-analytics-context",{errorInfo:n});Mm.warn(r.message)}}();var r=t.options.appId;if(!r)throw jm.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw jm.create("no-api-key");Mm.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+t.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=Qm[r])throw jm.create("already-exists",{id:r});if(!ty){!function(t){var e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(Zm);var i=function(t,e,n,r,i){var o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(o=window[i]),window[i]=function(t,e,n,r){return function(i,o,a){return(0,hr.mG)(this,void 0,void 0,(function(){var s;return(0,hr.Jh)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),i!==Rm.EVENT?[3,2]:[4,Um(t,e,n,o,a)];case 1:return u.sent(),[3,5];case 2:return i!==Rm.CONFIG?[3,4]:[4,Fm(t,e,n,r,o,a)];case 3:return u.sent(),[3,5];case 4:t(Rm.SET,o),u.label=5;case 5:return[3,7];case 6:return s=u.sent(),Mm.error(s),[3,7];case 7:return[2]}}))}))}}(o,t,e,n),{gtagCore:o,wrappedGtag:window[i]}}(Qm,Ym,Xm,Zm,$m),o=i.wrappedGtag,a=i.gtagCore;Jm=o,zm=a,ty=!0}return Qm[r]=function(t,n,r,i,o,a){return(0,hr.mG)(this,void 0,void 0,(function(){var s,u,c,h,l,f,d;return(0,hr.Jh)(this,(function(p){switch(p.label){case 0:return(s=function(t,e,n){return void 0===e&&(e=Vm),(0,hr.mG)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u=this;return(0,hr.Jh)(this,(function(c){if(n=t.options,r=n.appId,i=n.apiKey,o=n.measurementId,!r)throw jm.create("no-app-id");if(!i){if(o)return[2,{measurementId:o,appId:r}];throw jm.create("no-api-key")}return a=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},s=new Hm,setTimeout((function(){return(0,hr.mG)(u,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(t){return s.abort(),[2]}))}))}),6e4),[2,Km({appId:r,apiKey:i,measurementId:o},a,s,e)]}))}))}(t)).then((function(e){r[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&Mm.warn("The measurement ID in the local Firebase config ("+t.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(t){return Mm.error(t)})),n.push(s),u=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return(0,e.hl)()?[3,1]:(Mm.warn(jm.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return n.trys.push([1,3,,4]),[4,(0,e.eu)()];case 2:return n.sent(),[3,4];case 3:return t=n.sent(),Mm.warn(jm.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}}))}))}().then((function(t){return t?i.getId():void 0})),[4,Promise.all([s,u])];case 1:return c=p.sent(),h=c[0],l=c[1],function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(xm))return r}return null}()||function(t,e){var n=document.createElement("script");n.src=xm+"?l="+t+"&id="+e,n.async=!0,document.head.appendChild(n)}(a,h.measurementId),o("js",new Date),(d={}).origin="firebase",d.update=!0,f=d,null!=l&&(f.firebase_id=l),o(Rm.CONFIG,h.measurementId,f),[2,h.measurementId]}}))}))}(t,Ym,Xm,n,zm,Zm),{app:t,logEvent:function(t,e,n){(function(t,e,n,r,i){return(0,hr.mG)(this,void 0,void 0,(function(){var o,a;return(0,hr.Jh)(this,(function(s){switch(s.label){case 0:return i&&i.global?(t(Rm.EVENT,n,r),[2]):[3,1];case 1:return[4,e];case 2:o=s.sent(),a=(0,hr.pi)((0,hr.pi)({},r),{send_to:o}),t(Rm.EVENT,n,a),s.label=3;case 3:return[2]}}))}))})(Jm,Qm[r],t,e,n).catch((function(t){return Mm.error(t)}))},setCurrentScreen:function(t,e){(function(t,e,n,r){return(0,hr.mG)(this,void 0,void 0,(function(){var i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(Rm.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(Rm.CONFIG,i,{update:!0,screen_name:n}),o.label=3;case 3:return[2]}}))}))})(Jm,Qm[r],t,e).catch((function(t){return Mm.error(t)}))},setUserId:function(t,e){(function(t,e,n,r){return(0,hr.mG)(this,void 0,void 0,(function(){var i;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(Rm.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(Rm.CONFIG,i,{update:!0,user_id:n}),o.label=3;case 3:return[2]}}))}))})(Jm,Qm[r],t,e).catch((function(t){return Mm.error(t)}))},setUserProperties:function(t,e){(function(t,e,n,r){return(0,hr.mG)(this,void 0,void 0,(function(){var i,o,a,s,u;return(0,hr.Jh)(this,(function(c){switch(c.label){case 0:if(!r||!r.global)return[3,1];for(i={},o=0,a=Object.keys(n);o<a.length;o++)s=a[o],i["user_properties."+s]=n[s];return t(Rm.SET,i),[2,Promise.resolve()];case 1:return[4,e];case 2:u=c.sent(),t(Rm.CONFIG,u,{update:!0,user_properties:n}),c.label=3;case 3:return[2]}}))}))})(Jm,Qm[r],t,e).catch((function(t){return Mm.error(t)}))},setAnalyticsCollectionEnabled:function(t){(function(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),window["ga-disable-"+n]=!e,[2]}}))}))})(Qm[r],t).catch((function(t){return Mm.error(t)}))},INTERNAL:{delete:function(){return delete Qm[r],Promise.resolve()}}}}var ry="analytics";function iy(){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(t){switch(t.label){case 0:if((0,e.ru)())return[2,!1];if(!(0,e.zI)())return[2,!1];if(!(0,e.hl)())return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(0,e.eu)()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,!1];case 4:return[2]}}))}))}!function(t){t.INTERNAL.registerComponent(new kd.wA(ry,(function(t){return ny(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC").setServiceProps({settings:ey,EventName:Om,isSupported:iy})),t.INTERNAL.registerComponent(new kd.wA("analytics-internal",(function(t){try{return{logEvent:t.getProvider(ry).getImmediate().logEvent}}catch(t){throw jm.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),t.registerVersion("@firebase/analytics","0.6.9")}(t.Z);var oy,ay=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n,r,i,o;return(0,hr.Jh)(this,(function(a){switch(a.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=a.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return i=a.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return a.sent(),[2,i]}}))}))},t}(),sy=((oy={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",oy["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",oy["registration-api-key"]="Undefined API key. Check Firebase app initialization.",oy["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",oy["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",oy["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",oy["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",oy["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",oy["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",oy["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',oy["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',oy["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",oy["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",oy),uy=new e.LL("remoteconfig","Remote Config",sy),cy=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return t.prototype.fetch=function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c,h,l,f,d,p,v,g,m,y,b;return(0,hr.Jh)(this,(function(_){switch(_.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=_.sent(),n=e[0],r=e[1],i=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",o=i+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},s={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:(void 0===w&&(w=navigator),w.languages&&w.languages[0]||w.language)},u={method:"POST",headers:a,body:JSON.stringify(s)},c=fetch(o,u),h=new Promise((function(e,n){t.signal.addEventListener((function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)}))})),_.label=2;case 2:return _.trys.push([2,5,,6]),[4,Promise.race([c,h])];case 3:return _.sent(),[4,c];case 4:return l=_.sent(),[3,6];case 5:throw f=_.sent(),d="fetch-client-network","AbortError"===f.name&&(d="fetch-timeout"),uy.create(d,{originalErrorMessage:f.message});case 6:if(p=l.status,v=l.headers.get("ETag")||void 0,200!==l.status)return[3,11];y=void 0,_.label=7;case 7:return _.trys.push([7,9,,10]),[4,l.json()];case 8:return y=_.sent(),[3,10];case 9:throw b=_.sent(),uy.create("fetch-client-parse",{originalErrorMessage:b.message});case 10:g=y.entries,m=y.state,_.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===m?p=500:"NO_CHANGE"===m?p=304:"NO_TEMPLATE"!==m&&"EMPTY_CONFIG"!==m||(g={}),304!==p&&200!==p)throw uy.create("fetch-status",{httpStatus:p});return[2,{status:p,eTag:v,config:g}]}var w}))}))},t}(),hy=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),ly=["1","true","t","yes","y","on"],fy=function(){function t(t,e){void 0===e&&(e=""),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&ly.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}(),dy=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=r.in.DEBUG;break;case"silent":this._logger.logLevel=r.in.SILENT;break;default:this._logger.logLevel=r.in.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t.prototype.activate=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t,e,n;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return t=r.sent(),e=t[0],n=t[1],e&&e.config&&e.eTag&&e.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])]:[2,!1];case 2:return r.sent(),[2,!0]}}))}))},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=!0}))),this._initializePromise},t.prototype.fetch=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t,n,r,i=this;return(0,hr.Jh)(this,(function(o){switch(o.label){case 0:t=new hy,setTimeout((function(){return(0,hr.mG)(i,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(e){return t.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return o.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return o.sent(),[3,6];case 4:return n=o.sent(),r=function(t,n){return t instanceof e.ZR&&-1!==t.code.indexOf("fetch-throttle")}(n)?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(r)];case 5:throw o.sent(),n;case 6:return[2]}}))}))},t.prototype.fetchAndActivate=function(){return(0,hr.mG)(this,void 0,void 0,(function(){return(0,hr.Jh)(this,(function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}}))}))},t.prototype.getAll=function(){var t,e,n=this;return(t=this._storageCache.getActiveConfig(),e=this.defaultConfig,void 0===t&&(t={}),void 0===e&&(e={}),Object.keys((0,hr.pi)((0,hr.pi)({},t),e))).reduce((function(t,e){return t[e]=n.getValue(e),t}),{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new fy("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new fy("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new fy("static"))},t}();function py(t,e){var n=t.target.error||void 0;return uy.create(e,{originalErrorMessage:n&&n.message})}var vy="app_namespace_store",gy=function(){function t(t,e,n,r){void 0===r&&(r=new Promise((function(t,e){var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(t){e(py(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(vy,{keyPath:"compositeKey"})}}}))),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n=this;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([vy],"readonly").objectStore(vy),a=n.createCompositeKey(t);try{var s=o.get(a);s.onerror=function(t){i(py(t,"storage-get"))},s.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(t){i(uy.create("storage-get",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.set=function(t,e){return(0,hr.mG)(this,void 0,void 0,(function(){var n,r=this;return(0,hr.Jh)(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise((function(i,o){var a=n.transaction([vy],"readwrite").objectStore(vy),s=r.createCompositeKey(t);try{var u=a.put({compositeKey:s,value:e});u.onerror=function(t){o(py(t,"storage-set"))},u.onsuccess=function(){i()}}catch(t){o(uy.create("storage-set",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.delete=function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e,n=this;return(0,hr.Jh)(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([vy],"readwrite").objectStore(vy),a=n.createCompositeKey(t);try{var s=o.delete(a);s.onerror=function(t){i(py(t,"storage-delete"))},s.onsuccess=function(){r()}}catch(t){i(uy.create("storage-delete",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),my=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return(0,hr.mG)(this,void 0,void 0,(function(){var t,e,n,r,i,o;return(0,hr.Jh)(this,(function(a){switch(a.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=a.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(i=a.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=a.sent())&&(this.activeConfig=o),[2]}}))}))},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}();function yy(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(uy.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var by,_y=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return(0,hr.mG)(this,void 0,void 0,(function(){var e;return(0,hr.Jh)(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}}))}))},t.prototype.attemptFetch=function(t,n){var r=n.throttleEndTimeMillis,i=n.backoffCount;return(0,hr.mG)(this,void 0,void 0,(function(){var n,o,a;return(0,hr.Jh)(this,(function(s){switch(s.label){case 0:return[4,yy(t.signal,r)];case 1:s.sent(),s.label=2;case 2:return s.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return n=s.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return s.sent(),[2,n];case 5:if(!function(t){if(!(t instanceof e.ZR&&t.customData))return!1;var n=Number(t.customData.httpStatus);return 429===n||500===n||503===n||504===n}(o=s.sent()))throw o;return a={throttleEndTimeMillis:Date.now()+(0,e.$s)(i),backoffCount:i+1},[4,this.storage.setThrottleMetadata(a)];case 6:return s.sent(),[2,this.attemptFetch(t,a)];case 7:return[2]}}))}))},t}(),wy="@firebase/remote-config";(by=t.Z).INTERNAL.registerComponent(new kd.wA("remoteConfig",(function(t,e){var n=e.instanceIdentifier,i=t.getProvider("app").getImmediate(),o=t.getProvider("installations").getImmediate();if("undefined"==typeof window)throw uy.create("registration-window");var a=i.options,s=a.projectId,u=a.apiKey,c=a.appId;if(!s)throw uy.create("registration-project-id");if(!u)throw uy.create("registration-api-key");if(!c)throw uy.create("registration-app-id");n=n||"firebase";var h=new gy(c,i.name,n),l=new my(h),f=new r.Yd(wy);f.logLevel=r.in.ERROR;var d=new cy(o,by.SDK_VERSION,n,s,u,c),p=new _y(d,h),v=new ay(p,h,l,f),g=new dy(i,v,l,h,f);return g.ensureInitialized(),g}),"PUBLIC").setMultipleInstances(!0)),by.registerVersion(wy,"0.1.36"),t.Z.registerVersion("firebase","8.4.2","app"),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),t.Z.registerVersion("firebase","8.4.2"),t.Z.initializeApp({apiKey:"AIzaSyDqLiUCmgvWq5sLKPf7RPEEEYGk4W2_jnA",authDomain:"crud-js-poo.firebaseapp.com",projectId:"crud-js-poo",storageBucket:"crud-js-poo.appspot.com",messagingSenderId:"684798151089",appId:"1:684798151089:web:a00c38fbe66086c4225590"});const Iy=t.Z.firestore(),Ty={firebase:t.Z,db:Iy};class Ey{addProduct(t){const e=document.getElementById("product-list"),n=document.createElement("div");n.innerHTML+=`<div class="card text-center mb-4 bg-primary">                \n                    <div class="card-body">\n                        <strong>Producto</strong>: ${t.name}\n                        <strong>Precio</strong>: ${t.price}\n                        <strong>Cantidad</strong>: ${t.quantity}\n                        <button class="btn btn-danger ml-2 float-right btn-delete" data-id="${t.id}">Eliminar</button>\n                        <button class="btn btn-success float-right btn-edit" data-id="${t.id}">Editar</button>\n                    </div>                \n            </div>`,e.appendChild(n)}deleteProductList(){const t=document.getElementById("product-list");for(;t.firstChild;)t.removeChild(t.firstChild)}showMessage(t,e){const n=document.createElement("div");n.className=`alert alert-${e} mt-2`,n.appendChild(document.createTextNode(t));const r=document.querySelector(".container"),i=document.querySelector("#App");r.insertBefore(n,i),setTimeout((()=>{document.querySelector(".alert").remove()}),3e3)}}class Sy{constructor(t,e,n,r){this.id=t,this.name=e,this.price=n,this.quantity=r}}let Cy=!1,ky="";const Ny=document.getElementById("product-form");Ny.addEventListener("submit",(async t=>{const e=document.getElementById("name"),n=document.getElementById("price"),r=document.getElementById("quantity"),i=new Ey;if(t.preventDefault(),""===e.value|""===n.value|""===r.value)i.showMessage("Complete todos los campos por favor","info");else{const o=new Sy(ky,e.value,n.value,r.value);t.preventDefault(),Cy?(console.log(o),await((t,e)=>Ty.db.collection("products").doc(t).update(e))(ky,{name:e.value,price:n.value,quantity:r.value}),i.showMessage("Producto Actualizado Correctamente","info")):(await(t=>Ty.db.collection("products").doc().set({name:t.name,price:t.price,quantity:t.quantity}))(o),i.showMessage("Producto Agregado Correctamente","success")),Ny.reset(),e.focus()}})),window.addEventListener("DOMContentLoaded",(t=>{const e=new Ey;var n;n=t=>{e.deleteProductList(),t.forEach((t=>{const n=new Sy(t.id,t.data().name,t.data().price,t.data().quantity);e.addProduct(n)})),document.querySelectorAll(".btn-delete").forEach((t=>{t.addEventListener("click",(async t=>{await(t=>Ty.db.collection("products").doc(t).delete())(t.target.dataset.id),e.showMessage("Producto Eliminado Correctamente","danger")}))})),document.querySelectorAll(".btn-edit").forEach((t=>{t.addEventListener("click",(async t=>{const e=await(t=>Ty.db.collection("products").doc(t).get())(t.target.dataset.id),n=new Sy(e.id,e.data().name,e.data().price,e.data().quantity);console.log(n),Cy=!0,ky=n.id,Ny["btn-product-form"].value="Actualizar",Ny.name.value=n.name,Ny.price.value=n.price,Ny.quantity.value=n.quantity}))}))},Ty.db.collection("products").onSnapshot(n)}))})()})();